{"version":3,"sources":["Components/InheritanceCalculatorComponents/ChatbotComponent/Helper/Enums/ParentChildSelector.ts","Components/Generic/Header/HeaderTitle/HeaderTitle.tsx","Components/Generic/Header/HeaderMenu/MenuLink/MenuLink.tsx","Components/Generic/Header/HeaderMenu/NavLinks.ts","Components/Generic/Header/HeaderMenu/HeaderMenu.tsx","Components/Generic/Header/Header.tsx","Components/HomeComponents/HomeDetail/HomeDetail.tsx","Pages/HomePage.tsx","Pages/AboutPage.tsx","Components/InheritanceCalculatorComponents/ChatbotComponent/Helper/Classes/NodeEntity.ts","Components/InheritanceCalculatorComponents/ChatbotComponent/Helper/Enums/ChatStepTypes.ts","Components/InheritanceCalculatorComponents/ChatbotComponent/Generics.ts","Components/InheritanceCalculatorComponents/ChatbotComponent/services/ChatbotCommunicator.tsx","Components/InheritanceCalculatorComponents/ChatbotComponent/Helper/Enums/BinaryAnswerTypes.ts","Components/InheritanceCalculatorComponents/ChatbotComponent/Helper/Enums/ValidationType.ts","Components/InheritanceCalculatorComponents/ChatbotComponent/Helper/Methods/ChatbotValidation.tsx","Components/InheritanceCalculatorComponents/ChatbotComponent/Helper/Methods/NumberInput.tsx","Components/InheritanceCalculatorComponents/ChatbotComponent/Helper/Methods/OtherMethods.tsx","Components/InheritanceCalculatorComponents/ChatbotComponent/Helper/Methods/HandleCurrency.tsx","Components/InheritanceCalculatorComponents/ChatbotComponent/Custom/Widgets/ShowInfoWidget/ShowInfoWidget.tsx","Components/InheritanceCalculatorComponents/ChatbotComponent/Helper/Methods/QuestionConstants.tsx","Components/InheritanceCalculatorComponents/ChatbotComponent/Helper/Methods/InheritanceConstants.ts","Components/InheritanceCalculatorComponents/Reports/ReportUtils.ts","Components/InheritanceCalculatorComponents/Reports/ReportCalculationBase.ts","Components/InheritanceCalculatorComponents/Reports/InheritanceCalculation.ts","Components/InheritanceCalculatorComponents/Reports/PDF/styles.tsx","Components/InheritanceCalculatorComponents/Reports/PDF/Sections/common/text-styles/Bold.tsx","Components/InheritanceCalculatorComponents/Reports/PDF/Sections/common/text-styles/Italic.tsx","Components/InheritanceCalculatorComponents/Reports/pdf_utils.tsx","Components/InheritanceCalculatorComponents/Reports/PDF/Sections/common/genealogy/CommonMethods.tsx","Components/InheritanceCalculatorComponents/Reports/PDF/Sections/common/genealogy/Genealogy.utils.tsx","Components/InheritanceCalculatorComponents/Reports/PDF/Sections/common/genealogy/GenealogyPlikt.utils.tsx","Components/InheritanceCalculatorComponents/Reports/PDF/Sections/common/genealogy/Genealogy.tsx","Components/InheritanceCalculatorComponents/Reports/PDF/Sections/common/introSection/IntroductionPlikt.utils.tsx","Components/InheritanceCalculatorComponents/Reports/PDF/Sections/common/introSection/IntroductionPage.tsx","Components/InheritanceCalculatorComponents/Reports/PDF/Sections/common/introSection/Introduction.utils.ts","Components/InheritanceCalculatorComponents/Reports/PDF/Sections/common/react-pdf-table/Table.tsx","Components/InheritanceCalculatorComponents/Reports/PDF/Sections/common/summary/Summary.utils.tsx","Components/InheritanceCalculatorComponents/Reports/PDF/Sections/common/summary/Summary.tsx","Components/InheritanceCalculatorComponents/Reports/PDF/Sections/common/survivingPartner/SurvivingPartner.utils.tsx","Components/InheritanceCalculatorComponents/Reports/PDF/Sections/common/survivingPartner/SurvivingPartner.tsx","Components/InheritanceCalculatorComponents/Reports/PDF/Sections/firstSection/FirstSection.tsx","Components/InheritanceCalculatorComponents/Reports/PDF/Sections/secondSection/UndividedEstateCalculation/UndividedEstateCalculationUtils.tsx","Components/InheritanceCalculatorComponents/Reports/PDF/Sections/secondSection/UndividedEstateCalculation/UndividedEstateCalculation.tsx","Components/InheritanceCalculatorComponents/Reports/PDF/Sections/secondSection/SecondSection.tsx","Components/InheritanceCalculatorComponents/Reports/PDF/Sections/thirdSection/ThirdSection.tsx","Components/InheritanceCalculatorComponents/Reports/PDF/Sections/fourthSection/generalReservations/GeneralReservationsUtils.tsx","Components/InheritanceCalculatorComponents/Reports/PDF/Sections/fourthSection/generalReservations/GeneralReservations.tsx","Components/InheritanceCalculatorComponents/Reports/PDF/Sections/fourthSection/nationalInsurance/NationalInsurance.tsx","Components/InheritanceCalculatorComponents/Reports/PDF/Sections/fourthSection/FourthSection.tsx","Components/InheritanceCalculatorComponents/Reports/PDF/Sections/common/fixedSection/Footer.tsx","Components/InheritanceCalculatorComponents/Reports/PDF/Sections/common/fixedSection/Header.tsx","Components/InheritanceCalculatorComponents/Reports/PDF/Sections/fifthSection/fifthSection.tsx","Components/InheritanceCalculatorComponents/Reports/PDF/FinalDocument.tsx","Components/InheritanceCalculatorComponents/Reports/PliktdelsarvCalculation.ts","Components/InheritanceCalculatorComponents/Reports/UndividedCalculation.ts","Components/InheritanceCalculatorComponents/ChatbotComponent/Helper/Classes/Person.ts","Components/InheritanceCalculatorComponents/ChatbotComponent/ActionProviderMethods/RelativeMethods.tsx","Components/InheritanceCalculatorComponents/ChatbotComponent/ActionProviderMethods/UndividedEstateMethods.tsx","Components/InheritanceCalculatorComponents/ChatbotComponent/ActionProviderMethods/OtherChatbotMethods.tsx","Components/InheritanceCalculatorComponents/ChatbotComponent/ActionProviderMethods/TestatorInformationMethods.tsx","Components/InheritanceCalculatorComponents/ChatbotComponent/ActionProviderMethods/PartnerMethods.tsx","Components/InheritanceCalculatorComponents/ChatbotComponent/Helper/Methods/CommonMethods.tsx","Components/InheritanceCalculatorComponents/ChatbotComponent/Custom/Widgets/OptionSelector/OptionSelector.tsx","Components/InheritanceCalculatorComponents/ChatbotComponent/Custom/Widgets/InfoMessagesWidget/InfoMessagesWidget.tsx","Components/InheritanceCalculatorComponents/ChatbotComponent/Custom/Widgets/UndividedEstateWidget/UndividedEstateWidget.tsx","Components/InheritanceCalculatorComponents/OtherComponent/ChatHeader/ChatHeader.tsx","Components/InheritanceCalculatorComponents/ChatbotComponent/Custom/Messages/CustomFinalMessage.tsx","Components/InheritanceCalculatorComponents/ChatbotComponent/Config.js","Components/InheritanceCalculatorComponents/ChatbotComponent/MessageParser.tsx","Components/InheritanceCalculatorComponents/ChatbotComponent/ActionProvider.tsx","Components/InheritanceCalculatorComponents/OtherComponent/FamilyChart/ProcessDataForChart.tsx","store/chartSelector.js","Components/InheritanceCalculatorComponents/OtherComponent/FamilyChart/Classes/ChartNode.ts","Components/InheritanceCalculatorComponents/OtherComponent/FamilyChart/Classes/ChartConnector.ts","Components/InheritanceCalculatorComponents/OtherComponent/FamilyChart/Classes/Bubble.ts","Components/InheritanceCalculatorComponents/OtherComponent/FamilyChart/CustomNode.tsx","Components/InheritanceCalculatorComponents/ChatbotComponent/services/ComponentCommunicatorService.tsx","Components/InheritanceCalculatorComponents/OtherComponent/FamilyChart/ChartComponent.tsx","assets/images/chat_button_logo.svg","Pages/InheritanceCalculatorPage.js","Components/Generic/Footer/Footer.tsx","Pages/ResourcesPage.tsx","store/genericReducer.js","store/store.js","App.tsx","index.tsx"],"names":["ParentChildSelector","useStyles","makeStyles","root","fontFamily","color","HeaderTitle","classes","_jsx","Typography","variant","className","noWrap","children","fontSize","padding","textDecoration","textAlign","backgroundColor","fontWeight","rootActive","MenuLink","props","NavLink","to","href","exact","activeClassName","name","navLinks","id","title","path","HeaderMenu","Grid","container","direction","justifyContent","alignItems","NavLinks","map","_ref","item","FormattedMessage","concat","header","height","paddingLeft","drawerContainer","menuIconRoot","Header","_useState","useState","mobileView","drawerOpen","_useState2","_slicedToArray","state","setState","useEffect","setResponsiveness","window","innerWidth","prevState","_objectSpread","addEventListener","AppBar","_jsxs","Toolbar","MenuIcon","IconButton","edge","onClick","size","Drawer","anchor","open","onClose","Link","component","RouterLink","style","key","MenuItem","sm","highLightText","HomeDetail","Box","align","Typed","typeSpeed","strings","HomePage","AboutPage","ChatStepTypes","QuestionType","undividedOwnershipType","FormattedMessages","NodeEntity","level","_this","_classCallCheck","_id","_level","_path","_partnerPath","_parents","_children","_spouse","_cohabitant","_undividedEstateSpouse","_relationshipMap","_childCount","_processChildNodePos","_partnerNode","_getRelationshipMap","Map","add_child","child","add_for_both","arguments","length","undefined","isPartner","children_array","child_id","find","obj","push","_toConsumableArray","getLevel","add_parent","parent","_step","parent_id","isParentPresent","_iterator","_createForOfIteratorHelper","s","n","done","value","err","e","f","grandParent","getLatestPathKey","Error","x","setPathforPartner","partnerSelector","partner","has_surviving_spouse","has_surviving_cohabitant","this","_createClass","prevPath","nodeMap","currId","currNode","getNode","includes","parentCount","i","node","get","initChatbotState","stepID","initalStep","person","testator","netWealth","successor_flag","initialQuestion","parent_flag","temp_person","temp_child","temp_parent","personsMap","undividedSpouseId","deceasedParentsArray","grandParent_flag","rearChildrenResponse","undividedEstate","undividedEstateChoice","undivided_flag","totalEstateValue","undividedEstateSeparateWealth","temp_first","temp_last","ownershipType","tempMessages","successorProcessArray","isUndividedParent","yesNoClickedFlag","ChatbotState","InitialChatbotState","_","cloneDeep","messages","BinaryAnswerTypeYes","BinaryAnswerTypeNo","ValidationType","DefaultWarningMessage","inSubject","Subject","outSubject","internalSubscriptionList","Array","externalSubscriptionList","previousStates","revertCnt","isRevert","messageService","sendMessageToChatbot","message","next","sendMessageFromChatbot","getMessageInChatbot","asObservable","getMessageOutChatbot","addInternalSubscription","subscription","addExternalSubscription","addPreviousState","data","stateCopy","filter","previousState","Object","entries","printPreviousStates","console","log","removePreviousState","pop","removePreviousStates","cnt","finalState","getPreviousStates","getPreviousState","reverseCount","clearAllInternalSubscription","forEach","unsubscribe","clearAllExternalSubscription","addRevertCnt","getRevertCnt","resetRevertCnt","setRevert","resetRevert","getRevert","resetChatbotState","shift","ChatbotValidation","actionProvider","chatbotState","validate","validationTypes","warningMessage","addEmptyRuleAndSortInc","validationType","validationResult","emptyValue","validateEmpty","invalidAmount","validateAmount","onlyDigit","validateDigit","incorrectValueForBoolean","validateValueForBoolean","incorrectValueForUndividedOptions","validateValueForUndividedOptions","error","getWarningMessage","showWarning","messageCopy","handleValidation","stateRef","hideWarning","match","test","values","warningDiv","document","getElementById","innerHTML","display","newDiv","closeButton","createElement","cssText","remove","appendChild","valArray","sort","a","b","emptyValueMessage","errorForBooleanMessage","invalidAmountMessage","onlyDigitMessage","incorrectValueForUndividedMessage","numberInputTypesObject","getReturnValueFromBooleanWidget","getReturnValueFromUndividedWidget","_ownershipTypeWithFor","_ownershipTypeWithFor2","_defineProperty","felleseie","FELLESEIE","delvis","DELVIS","fullt","FULLT","ParseCurrencyStringForOutput","unformattedCurrency","Intl","NumberFormat","currency","currencyDisplay","minimumFractionDigits","maximumFractionDigits","format","Number","replace","CurrencyOutput","inputCurrency","initialCurrencyValue","beginningValue","endValue","matchesStart","matchStartResult","substring","matchesEnd","matchEndResult","removeTextFromCurrencyString","digitsBeforeSeparatorValue","separatorCount","checkSeparatorCount","_step2","digitsBeforeSymbol","_iterator2","checkDigitsBeforeSeparatorValue","popover","pointerEvents","paper","useTheme","spacing","ShowInfoWidget","anchorEl","setAnchorEl","containerRef","useRef","handlePopoverClose","Boolean","ref","LiveHelpIcon","onMouseEnter","event","currentTarget","onMouseLeave","Popover","anchorOrigin","vertical","horizontal","transformOrigin","disableRestoreFocus","current","text","QuestionConstants","TestatorQuestion","UndividedEstateQuestion","YesNoWidgetOptions","widget","withAvatar","loading","terminateLoading","UndividedEstateResultText","selectedOption","undividedEstateResultText","undvdSpouseOtherSuccessorQuestion","testatorOtherSuccessorQuestion","NetWealthQuestion","NetWealthWarning","UnderAgeQuestion","UnderAgeResultText","underAgeResultText","SpouseChoiceQuestion","SpouseQuestion","CohabitantChoiceQuestion","CohabitantQuestion","addSuccessorQuestion1","person_id","person_ID","addSuccessorQuestion2","child_id_string","children_IDs","AliveQuestion","child_ID","AliveResultText","aliveResultText","addParentsQuestion1","askSecondParentChoiceQuestion","addParentsQuestion2","parent_id_string","parents_IDs","MarriedParents1","first_parent_id","second_parent_id","parent1_ID","parent2_ID","MarriedParents2","addGrandParentsQuestion1","addGrandParentsQuestion2","grandparent_id_string","grandParents_IDs","FinalQuestion","EmptyQuestion","DefaultText","TotalEstateNetValueQuestion","TotalEstateNetValueWarning","OwnershipTypeQuestion","OwnershipQuestionWidgetOptions","OwnershipTypeWarning","DelvisFirstQuestion","DelvisSecondQuestion","FulltSaereieQuestion","UndividedEstateSpouseQuestion","TextBeforeSucsrUndvdSpouse","addSuccessorCount","undividedChildrenTogetherCount","addSuccessorOfParentCount","existing_child_id","existing_child_ID","InheritanceConstants","DESC_COHABITANT_WITHOUT_COMMON_CHILD","DESC_NO_SPOUSE_OR_COHABITANT","DESC_COHABITANT_NO_CLOSE_RELATIVES_2","DESC_COHABITANT_NO_CLOSE_RELATIVES","DESC_SPOUSE_NO_CLOSE_RELATIVES_2","DESC_SPOUSE_NO_CLOSE_RELATIVES","G","MINIMUM_INHERITANCE_SPOUSE_VS_CHILDREN","FRACTION_INHERITANCE_SPOUSE_VS_CHILDREN","MINIMUM_INHERITANCE_SPOUSE_VS_PARENTS","FRACTION_INHERITANCE_SPOUSE_VS_PARENTS","MINIMUM_INHERITANCE_COHABITANT_VS_CHILDREN","FRACTION_INHERITANCE_COHABITANT_VS_CHILDREN","MINIMUM_INHERITANCE_COHABITANT_VS_PARENTS","FRACTION_INHERITANCE_COHABITANT_VS_PARENTS","FRACTION_PLIKTDEL","LINE_MAXIMUM_PLIKTDEL","LAW_LINKS","CODE_PARAGRAPHS","combine_duplicates","inheritance_fraction_list","duplicateArrayPersonMap","combinedArray","inheritance_fraction","has","tempInheritanceFractionList","set","duplicatedMapArray","keys","currentValue","frac","reduce","accumulator","chains","arr","curr","split_evenly_between_lines","person_list","maximum_distance","allow_parents","split_fraction_list","_step3","split_frac","_iterator3","_loop","personDetail","getPerson","personNode","_deceased","get_class_and_distance_closest_surviving_relative","v","_step6","temp_list","level_sum","_iterator6","interm_temp_list","_step7","_iterator7","_step8","temp_split_fraction_list","_iterator8","_personName","_step9","temp_fraction_list","_iterator9","temp_list_item","_ret","_step4","_iterator4","_step5","_iterator5","isEqual","cache","createIntlCache","intl","createIntl","locale","Norsk","ReportCalculationBase","inheritanceType","will","survivor","survivor_type","class_closest","distance_closest","old_surviving_reference_paragraphs","surviving_reference_paragraphs","minimum_surviving_inheritance","surviving_fraction","descriptive_text","survivor_inheritance_sum","genealogy_inheritance_sum","splits_with_chains","genealogy_inheritance","genealogy_splits","initializeInheritance","initializeInheritanceVariablesCommon","initializePliktInheritance","_get_class_and_distan","_get_class_and_distan2","formatMessage","initializeUndividedInheritance","computeMethod","inheritanceOption","_get_class_and_distan3","_get_class_and_distan4","computeGenealogyInheritance","Math","min","max","compute_default_genealogy_splits_with_chains","genealogy_split","computeGenealogyPliktInheritance","personObject","firstParentSpouse","_underAge","grandParent_splits","num","resultGrandParentSplit","grandParent_split","InheritanceCalculation","_ReportCalculationBas","_inherits","_super","_createSuper","call","styles","StyleSheet","create","page","flexDirection","paddingRight","paddingBottom","section","margin","marginBottom","heading","subheading","paragraphHeading","paragraph","pageNumber","position","bottom","left","right","boldValue","italicValue","fontStyle","urlStyle","tableHeaderRow","borderWidth","tableDataRow","marginTop","redText","imageView","image","Bold","Text","Italic","currencyFormatNO","currencyValue","useGrouping","add_legal_reference","code_paragraph","lovdataLink","addLovdataLink","code_paragraph_code","hyperlinkText","add_hyperlink","url_text","src","unravel_chain_to_string","chain","splice","link","unravel_chains_to_string","chains_unraveled","unravelOutput","ind","unraveled_chain","getGenealogyInheritanceText","finalGenealogyInheritanceText","random","toString","getGenealogyText","legalReference1","legalReference2","View","getParagraph","helpText","legalReferenceText","GenealogyUtils","genealogyText","genealogyInheritanceSum","legal_reference_text","genealogyInheritanceText","GenealogyPliktUtils","Genealogy","inheritanceMode","useContext","UserContext","inheritanceCalculation","genealogyParagraph","wrap","pliktdelsarvCalculation","genealogyPliktParagraph","getPliktIntroString","person_name","net_wealth_NOK","available_for_will","IntroductionPage","calculatedValues","currencyFormatted","testatorName","IntroductionUtils","pliktIntroText","IntroductionPliktUtils","TableElement","summaryVal","summaryValue","Table","TableHeader","TableCell","TableBody","DataTableCell","getContent","r","survivorName","survivorType","belopAmount","SummaryUtils","summaryValues","getSummaryValues","table","emptyTableCase","survivor_name","gen_inherit","summaryCell","Summary","summaryTable","summaryPliktTable","getInheritanceDescriptiveText","valueType","inheritanceSpecificTextIf","pliktSpecificTextIf","inheritanceSpecificTextElse","pliktSpecificTextElse","SurvivingPartnerUtils","inheritanceDescriptiveText","legalReferenceTextArray","code_paragraphs","add_legal_references","pliktSpecificText","indexOf","SurvivingPartner","survivingPartnerParagraph","FirstSection","belop_amount","UndividedEstateCalculation","undividedResult","undividedCalculation","addUndividedEstateRelatives","add_undivided_estate_relatives","addUndividedEstateSummary","add_undivided_estate_summary","break","UndividedRelativeText","returnValue","endSentence","unraveledText","genealogy_inheritance_unit","getUndividedRelativeText","UndividedSummaryTable","getUndividedSummaryTable","SecondSection","undividedStateElement","ThirdSection","getUskifteText","getTestamentText","getavkortingText","lovdata_link","getBarnText","generalReservationsUtils","uskifteText","testamentText","avkortingText","barnText","GeneralReservations","generalReservationsText","NationalInsurance","NationalInsuranceText","getNationalInsuranceString","FourthSection","Footer","render","totalPages","fixed","FifthSection","url","setUrl","querySelector","domtoimage","toPng","_classList","_classList2","classList","contains","then","dataUrl","catch","Image","createContext","FinalDocument","Document","Page","Provider","inputData","PliktdelsarvCalculation","UndividedCalculation","Person","personid","_childrenRearing","set_spouse","spouse","hasSurvivingSpouse","set_cohabitant","cohabitant","personMap","handleSuccessorCnt","res","successorCount","parseInt","parentID","getParentId","handleNoSuccessorCase","handleClosingStep","questionType","itr_id","createEmptyNode","currentPartnerNode","updateProcessChildNodePos","t","part1","personName","newSuccessorQuestion","createChatBotMessage","addMessageToBotState","allChildrenID","getParentChildrenIDStrings","handleSuccessorInput","childID","getChildUnprocessedNode","_Person$getPerson","part2","personId","aliveQuestion","childItrPos","currentParentID","currentParent","isCurrentParentID","currentId","currentParentDetail","handleChildAliveOption","childDetail","grandParentStep","getGenerationCount","part3","handleSecondParentExists","allParentsID","temp_person_detail","newParentQuestion","handleParentsInput","predecessor","createNewPerson","handleParentAliveOption","temp_parent_detail","handleMarriedParents","askFinalQuestion","undividedEstateChoiceResponse","undividedEstateStep","totalEstateNetValueQuestion","netWealthStep","netWealthQuestion","handleUndividedStep","isTwoParent","testatorDetail","part6","part7","newSuccessorUndvdSpouseQuestion","part8","askTestatorOtherChildrenQuestion","secondParentChoiceQuestion","testatorOtherChildStep","computeInheritances","isSecondParent","successorStep","handleClosestSurvivingRelativeChildren","parentsStep","handleClosestSurvivingRelativeParents","handleClosestSurvivingRelativeGrandParens","handleAskUnderAgeQuestion","temp_class_testator","rearChildrenStep","temp_class","eitherParentsDeceased","p_id","parent1Detail","parent2Detail","marriedParentsStep","marriedParentsQn","testatorNode","handleGrandParentFirst","grandparentName","handleAskForNextGrandParent","surviving_successor_distance","possible_distances","temp","apply","distance","alternatives","_alternatives$","closest_alternative_class","closest_alternative_distance","personID","newPerson","generateNextID","newNode","createTestator","pdfDownloadLink","PDFDownloadLink","fileName","blob","createCustomMessage","payload","blockInputAtFinalStep","handleFinalQuestion","finalStep","collection","join","clearBooleanOptions","_lastButtonDiv$nextEl","_lastButtonDiv$nextEl2","buttonElementArray","getElementsByClassName","querySelectorAll","lastButtonDiv","nextElementSibling","btn","removeAttribute","setAttribute","step","inputField","sendInputBtn","undoButton","clearDisabledInput","prevStep","handleUnderAge","cohabitantChoiceQuestion","cohabitantChoice","spouseChoiceQuestion","spouseChoice","underAgeStep","underAgeQuestion","handleSpouseOption","spouseStep","spouseQuestion","handleCohabitantChoice","cohabitantStep","cohabitantQuestion","commonMethods","curState","chatbotValidator","undividedEstateQuestion","testatorStep","handleTestator","toLowerCase","evaluateBooleanMessage","totalEstateValueResponse","totalEstateValueQuestion","currencyIntResponse","currencyStringResponse","currencyJSX","ownershipTypeQuestion","currencyCustom","createClientMessage","totalEstateWarning","ownershipResponse","undividedEstateSpouseQuestion","delvisFirstQuestion","part5","fulltSaereieQuestion","ownershipTypeWarning","undividedOwnershipResponse","response","part4","delvisSecondQuestion","netWealthWarning","delvisFirstResponse","delvisSecondResponse","delvisFulltResponse","handleSuccessor","handleNetWealth","newSpouse","assign","handleSpouseInput","newCohabitant","handleCohabitantInput","convertedMessage","chosenValue","returnKeyFromEnteredNumberText","slice","newUndividedSpouse","undividedSpouse","textBeforeSucsrUndvdSpouse","newSuccessorTogetherQuestion","undividedEstateSpouse","handleWidgetFunctions","isClicked","isClickedUndiv","func","clientMessage","focusWritingArea","inputBoxElement","focus","handleMessage","trim","returnState","buttonElements","currentElement","disabled","disableButtons","alert","onClickHandler","thisButton","target","nextButton","prevButton","previousElementSibling","otherButton","background","handleOptions","option","OptionSelector","_objectWithoutProperties","_excluded","InfoMessagesWidget","label","sx","parentElement","hasChildNodes","_i","_allCurrentButtons","childNodes","childEl","UndividedEstateWidget","ChatHeader","setOpen","handleCloseNo","restartBot","resetChatbot","flexGrow","Tooltip","Button","revertLastState","UndoIcon","width","RestartAlt","Dialog","DialogTitle","DialogContent","DialogContentText","DialogActions","autoFocus","CustomFinalMessage","FileDownloadOutlinedIcon","config","botName","lang","customStyles","botMessageBox","chatButton","initialMessages","customComponents","customMessages","custom","widgets","widgetName","widgetFunc","InfoMessageWidget","MessageParser","xDiff","yDiff","partnerBubbleLevelMap","ActionProvider","setStateFunc","checkstate","isStarted","glb_state","GRANDCHILDREN_PATH_LIMIT","isArray","firstSpouse_id","secondSpouse_id","check","delay","self","setInterval","detail","clearInterval","setTimeout","chartSelector","Promise","resolve","_this2","subscribe","lastState","revertCount","localStorage","getItem","setItem","revertState","ChartNode","type","xLevel","draggable","connectable","NodeData","showDialog","pos","ChartConnector","source","sourceHandle","targetHandle","animated","Bubble","elements","maxLevel","minLevel","xLevelArray","chartNodeMap","connectorArray","nodeSize","setxLevel","levelMap","processedNodes","currentLevelChartNodes","currentNode","avgXlevel","parentsCurrentNode","partnerNodeId","partnerChartNode","getChartNode","partnerBubbleArray","connector","newConnector","createNodesInPath","getLevelMap","_levelMap$get","nodeDetails","nodeLabel","y","setNodePosition","ypos","sortedLevelChartNode","bubbles","createLevelBubble","processBubbles","xleft","xgap","previousXRight","bubble","parentChartNode","relativeXleft","relativeXRight","eleID","chartNodes","partnerBubble","isPartnerProcessed","_loop2","chartNode","partnerParent","isExistingBubble","_loop3","partnerNode","existingBubbles","existingBubble","getChartNodeConnectorArray","finalArray","setxLevelForMaxLevel","nodeArray","xlevelDefault","currentNodePath","_loop4","j","sourceNode","targetNode","top","HandleType","customHandleData","Position","Right","Bottom","Left","Top","partnerNodeStyles","OuterDiv","borderRadius","borderColor","borderStyle","letterSpacing","innerDiv1","innerDiv2","borderTop","textFitStyle","subtitle","whiteSpace","deceasedFormatter","personString","CustomNode","totalData","isConnectable","handles","k","Handle","labelString","Textfit","mode","forceSingleModeWidth","chatBotDataSubject","chatbotMessageSubscriptionList","componentCommunicatorService","flowStyles","isHandleChange","OrgChartTree","result","setResult","_useState3","_useState4","chartContent","setChartContent","componentWillUnmount","updateNodeInternals","useUpdateNodeInternals","chartData","maxLevelData","processData","fitView","useZoomPanHelper","nodeTypes","specialNode","paddingTop","ReactFlow","nodesConnectable","paneMoveable","selectNodesOnDrag","elementsSelectable","nodesDraggable","Background","BackgroundVariant","Lines","gap","Controls","setWarningDiv","prepend","lastChild","addListenerToChatInputField","InheritanceCalculatorPage","prev","ReactFlowProvider","Chatbot","Config","messageParser","divChatBot","botIcon","Copyright","Date","getFullYear","footer","description","Paper","gutterBottom","ResourcesPage","initialState","genericReducer","action","store","createStore","theme","createTheme","rootPaper","minHeight","opacity","menuItems","Switch","Route","App","langMessages","StyledEngineProvider","injectFirst","ThemeProvider","IntlProvider","role","Router"],"mappings":"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","file":"static/js/main.061e5fbd.chunk.js","sourcesContent":["export enum ParentChildSelector {\r\n  child = 0,\r\n  parent = 4,\r\n  testator = -1,\r\n  grandParent = 5,\r\n  spouse = 1,\r\n  cohabitant = 2,\r\n  undividedSpouse = 3,\r\n}\r\n","import { ReactElement } from \"react\";\r\nimport { Typography } from \"@mui/material\";\r\nimport makeStyles from '@mui/styles/makeStyles';\r\n\r\nconst root = {\r\n  fontFamily: '\"Abril Fatface\", serif',\r\n  color: \"#016196\",\r\n};\r\n\r\nconst useStyles = makeStyles({ root });\r\nconst HeaderTitle = (): ReactElement => {\r\n  const classes = useStyles();\r\n\r\n  return (\r\n    <Typography variant=\"h2\" className={classes.root} noWrap>\r\n      ARVEBOT\r\n    </Typography>\r\n  );\r\n};\r\n\r\nexport default HeaderTitle;\r\n","// import classes from \"./MenuLink.module.css\";\r\nimport { ReactElement } from 'react';\r\nimport makeStyles from '@mui/styles/makeStyles';\r\nimport { NavLink } from 'react-router-dom';\r\n\r\ninterface propsTypes {\r\n    href: string;\r\n    name: ReactElement;\r\n}\r\n\r\nconst useStyles = makeStyles({\r\n    root: {\r\n        fontFamily: '\"Work Sans\", sans-serif',\r\n        // fontWeight: \"300\",\r\n        fontSize: '1.3rem',\r\n        color: '#4151C9',\r\n        padding: '0 20px',\r\n        textDecoration: 'none',\r\n        textAlign: 'center',\r\n        '&:hover': {\r\n            color: '#FFF5EE',\r\n            backgroundColor: '#87AFC7',\r\n            fontWeight: 'bold',\r\n        },\r\n    },\r\n    rootActive: {\r\n        backgroundColor: '#FFCBA4',\r\n        color: '#2B3856',\r\n        '&:hover': {\r\n            backgroundColor: '#FCCABD',\r\n            color: '#2B3856',\r\n        },\r\n    },\r\n});\r\n\r\nconst MenuLink = (props: propsTypes): ReactElement => {\r\n    const classes = useStyles(props);\r\n    return (\r\n        <NavLink\r\n            to={props.href}\r\n            className={classes.root}\r\n            exact\r\n            activeClassName={classes.rootActive}\r\n        >\r\n            {props.name}\r\n        </NavLink>\r\n    );\r\n};\r\n\r\nexport default MenuLink;\r\n","const navLinks = [\r\n  {\r\n    id: 0,\r\n    title: \"Menu.Home\",\r\n    path: \"/\",\r\n  },\r\n  {\r\n    id: 1,\r\n    title: \"Menu.Calculator\",\r\n    path: \"/calculator\",\r\n  },\r\n  {\r\n    id: 2,\r\n    title: \"Menu.About\",\r\n    path: \"/about\",\r\n  },\r\n  {\r\n    id: 3,\r\n    title: \"Menu.Resources\",\r\n    path: \"/resources\",\r\n  },\r\n];\r\n\r\nexport default navLinks;\r\n","import { Grid } from \"@mui/material\";\r\nimport MenuLink from \"./MenuLink/MenuLink\";\r\nimport NavLinks from \"./NavLinks\";\r\nimport { FormattedMessage } from \"react-intl\";\r\nimport { ReactElement } from \"react\";\r\n\r\nconst HeaderMenu = (): ReactElement => {\r\n  return (\r\n    <Grid\r\n      container\r\n      direction=\"row\"\r\n      justifyContent=\"space-evenly\"\r\n      alignItems=\"center\"\r\n    >\r\n      {NavLinks.map(({ id, title, path }) => {\r\n        return (\r\n          <Grid item key={id}>\r\n            <MenuLink name={<FormattedMessage id={`${title}`} />} href={path} />\r\n          </Grid>\r\n        );\r\n      })}\r\n    </Grid>\r\n  );\r\n};\r\n\r\nexport default HeaderMenu;\r\n","import { useState, useEffect, ReactElement } from \"react\";\r\nimport makeStyles from '@mui/styles/makeStyles';\r\nimport {\r\n  AppBar,\r\n  Toolbar,\r\n  Grid,\r\n  IconButton,\r\n  Drawer,\r\n  Link,\r\n  MenuItem,\r\n} from \"@mui/material\";\r\nimport MenuIcon from \"@mui/icons-material/Menu\";\r\nimport { Link as RouterLink } from \"react-router-dom\";\r\nimport HeaderTitle from \"./HeaderTitle/HeaderTitle\";\r\nimport HeaderMenu from \"./HeaderMenu/HeaderMenu\";\r\nimport NavLinks from \"../../Generic/Header/HeaderMenu/NavLinks\";\r\n\r\nconst useStyles = makeStyles({\r\n  header: {\r\n    backgroundColor: \"white\",\r\n    height: \"5rem\",\r\n  },\r\n  \"@media (max-width: 900px)\": {\r\n    paddingLeft: 0,\r\n  },\r\n  drawerContainer: {\r\n    padding: \"20px 30px\",\r\n  },\r\n  menuIconRoot: {\r\n    color: \"#4151C9\",\r\n  },\r\n});\r\n\r\nconst getDrawerChoices = () => {\r\n  return NavLinks.map(({ id, title, path }) => {\r\n    return (\r\n      <Link\r\n        {...{\r\n          component: RouterLink,\r\n          to: path,\r\n          color: \"inherit\",\r\n          style: { textDecoration: \"none\" },\r\n          key: id,\r\n        }}\r\n      >\r\n        <MenuItem>{title}</MenuItem>\r\n      </Link>\r\n    );\r\n  });\r\n};\r\nconst displayDesktop = () => {\r\n  return (\r\n    <Toolbar>\r\n      <Grid\r\n        container\r\n        direction=\"row\"\r\n        justifyContent=\"flex-start\"\r\n        alignItems=\"flex-end\"\r\n      >\r\n        <Grid item sm={6}>\r\n          <HeaderTitle />\r\n        </Grid>\r\n        <Grid item sm={6}>\r\n          <HeaderMenu />\r\n        </Grid>\r\n      </Grid>\r\n    </Toolbar>\r\n  );\r\n};\r\n\r\nconst Header = (): ReactElement => {\r\n  const [state, setState] = useState({\r\n    mobileView: false,\r\n    drawerOpen: false,\r\n  });\r\n  const { mobileView, drawerOpen } = state;\r\n  useEffect(() => {\r\n    const setResponsiveness = () => {\r\n      return window.innerWidth < 900\r\n        ? setState((prevState) => ({ ...prevState, mobileView: true }))\r\n        : setState((prevState) => ({ ...prevState, mobileView: false }));\r\n    };\r\n    setResponsiveness();\r\n    window.addEventListener(\"resize\", () => setResponsiveness());\r\n  }, []);\r\n\r\n  const classes = useStyles();\r\n\r\n  const displayMobile = () => {\r\n    const handleDrawerOpen = () =>\r\n      setState((prevState) => ({ ...prevState, drawerOpen: true }));\r\n    const handleDrawerClose = () =>\r\n      setState((prevState) => ({ ...prevState, drawerOpen: false }));\r\n\r\n    return (\r\n      <Toolbar>\r\n        <MenuIcon className={classes.menuIconRoot} />\r\n        <IconButton edge=\"start\" color=\"inherit\" onClick={handleDrawerOpen} size=\"large\" />\r\n        <Drawer anchor=\"left\" open={drawerOpen} onClose={handleDrawerClose}>\r\n          <div className={classes.drawerContainer}>{getDrawerChoices()}</div>\r\n        </Drawer>\r\n        <HeaderTitle />\r\n      </Toolbar>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <AppBar className={classes.header}>\r\n      {mobileView ? displayMobile() : displayDesktop()}\r\n    </AppBar>\r\n  );\r\n};\r\n\r\nexport default Header;\r\n","import { ReactElement } from \"react\";\r\nimport makeStyles from '@mui/styles/makeStyles';\r\nimport { Box, Typography } from \"@mui/material\";\r\nimport Typed from 'react-typed';\r\n// import Typed from \"typed.js\";\r\n\r\nconst useStyles = makeStyles({\r\n  root: {\r\n    padding: \"10rem 20rem\",\r\n    color: \"white\",\r\n    fontFamily: '\"Work Sans\", sans-serif',\r\n  },\r\n  highLightText: {\r\n    fontFamily: '\"Abril Fatface\", serif',\r\n    fontSize: \"4rem\",\r\n    color: \"yellow\",\r\n  },\r\n});\r\n\r\nconst HomeDetail = (): ReactElement => {\r\n  const classes = useStyles();\r\n  const textLines = [\"hjelper deg  finne lsningen og relevant rettsgrunnlag.\"]\r\n  return (\r\n    <Box>\r\n      <Typography variant=\"h4\" align=\"center\" className={classes.root}>\r\n        Lurer du p hvem som arver Peder s nr han dr? <br />\r\n        Hvor mye fr kona og barna? Hva med stesnnen? <br />\r\n        Og hvor mye kan han testamentere til Lilleviks fuglekikkerforening?{\" \"}\r\n        <br /> <br />\r\n        <span className={classes.highLightText}>BeregnArv</span> <Typed typeSpeed={50} strings={textLines}></Typed>\r\n      </Typography>\r\n    </Box >\r\n  );\r\n};\r\n\r\nexport default HomeDetail;\r\n","import { ReactElement } from \"react\";\r\nimport HomeDetail from \"../Components/HomeComponents/HomeDetail/HomeDetail\";\r\n\r\nconst HomePage = (): ReactElement => {\r\n  return (\r\n    // <Typography variant=\"h2\" align=\"center\">\r\n    //   HomePage\r\n    // </Typography>\r\n    <HomeDetail />\r\n  );\r\n};\r\n\r\nexport default HomePage;\r\n","import { Typography } from \"@mui/material\";\r\nimport { ReactElement } from \"react\";\r\nconst AboutPage = (): ReactElement => {\r\n  return (\r\n    <div>\r\n      <Typography variant=\"h2\" align=\"center\">\r\n        About Page\r\n      </Typography>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AboutPage;\r\n","import { ParentChildSelector } from '../Enums/ParentChildSelector';\r\nimport _ from 'lodash';\r\nexport class NodeEntity {\r\n    _id: number;\r\n    _level: number;\r\n    _path: Array<[number, number]>;\r\n    _partnerPath: Array<[number, number]>;\r\n    _parents: Array<number>;\r\n    _children: Array<number>;\r\n    _spouse: number | null;\r\n    _cohabitant: number | null;\r\n    _undividedEstateSpouse: number | null;\r\n    _relationshipMap: Map<string, string>;\r\n    _childCount: number;\r\n    _processChildNodePos: number;\r\n    _partnerNode: number | null;\r\n    constructor(id: number, level: number) {\r\n        this._id = id;\r\n        this._level = level;\r\n        this._path = [];\r\n        this._partnerPath = [];\r\n        this._parents = [];\r\n        this._children = [];\r\n        this._spouse = null;\r\n        this._cohabitant = null;\r\n        this._undividedEstateSpouse = null;\r\n        this._relationshipMap = this._getRelationshipMap();\r\n        this._childCount = 0;\r\n        this._processChildNodePos = 0;\r\n        this._partnerNode = null;\r\n    }\r\n    _getRelationshipMap = (): Map<string, string> => {\r\n        return new Map<string, string>([\r\n            ['0', 'child'],\r\n            ['00', 'grandchild'],\r\n            ['1', 'parent'],\r\n            ['10', 'brother/sister'],\r\n            ['100', 'nephew/niece'],\r\n            ['1000', 'grandniece'],\r\n            ['12', 'grandparent'],\r\n            ['120', 'uncle/aunt'],\r\n            ['1200', 'cousin'],\r\n            ['', ''],\r\n        ]);\r\n        return new Map<string, string>();\r\n    };\r\n\r\n    setPath(prevPath: Array<[number, number]>) {\r\n        this._path = prevPath;\r\n    }\r\n\r\n    getParentId(nodeMap: Map<number, NodeEntity>) {\r\n        if (this._path.length - 2 < 0) {\r\n            return null;\r\n        }\r\n        const currId = this._path[this._path.length - 2][1];\r\n        const currNode = NodeEntity.getNode(currId, nodeMap);\r\n        if (\r\n            !(\r\n                this._children.includes(this._path[this._path.length - 2][1]) ||\r\n                currNode._undividedEstateSpouse === this._id\r\n            )\r\n        )\r\n            return this._path[this._path.length - 2][1];\r\n        return null;\r\n    }\r\n\r\n    getGenerationCount() {\r\n        let parentCount = 0;\r\n        if (this._path.length - 2 < 0) {\r\n            return 0;\r\n        }\r\n        for (let i = this._path.length - 2; i >= 0; i--) {\r\n            if (this._path[i][0] === ParentChildSelector.grandParent) {\r\n                parentCount += 1;\r\n                break;\r\n            } else {\r\n                parentCount += 1;\r\n            }\r\n        }\r\n        return parentCount;\r\n    }\r\n\r\n    add_child = (\r\n        child: NodeEntity,\r\n        add_for_both = true,\r\n        isPartner = false,\r\n    ): void => {\r\n        const children_array = this._children;\r\n        const child_id = child._id;\r\n        if (!children_array.find((obj) => obj === child_id)) {\r\n            this._children.push(child_id);\r\n        }\r\n        if (!isPartner) {\r\n            child._path = [...this._path];\r\n            child._path.push([ParentChildSelector.child, child_id]);\r\n            child._level = this.getLevel(child._path);\r\n        } else {\r\n            child._partnerPath = [...this._path];\r\n            child._partnerPath.push([ParentChildSelector.child, child_id]);\r\n            // child._level = this.getLevel(child._path);\r\n        }\r\n        if (add_for_both) {\r\n            if (!child._parents.find((obj) => obj === this._id)) {\r\n                child._parents.push(this._id);\r\n            }\r\n        }\r\n    };\r\n    /* eslint-disable @typescript-eslint/no-unused-vars */\r\n\r\n    add_parent = (\r\n        parent: NodeEntity,\r\n        add_for_both = true,\r\n        grandParent = false,\r\n    ): void => {\r\n        // const parents_array = this._parents;\r\n        const parent_id = parent._id;\r\n        let isParentPresent = false;\r\n\r\n        for (const p of this._parents) {\r\n            if (p === parent_id) {\r\n                isParentPresent = true;\r\n                break;\r\n            }\r\n        }\r\n\r\n        // const t = this._parents.find((obj) => obj === parent_id);\r\n        if (!isParentPresent) {\r\n            this._parents.push(parent_id);\r\n        }\r\n        parent._path = [...this._path];\r\n\r\n        parent._path.push([ParentChildSelector.parent, parent_id]);\r\n        parent._level = this.getLevel(parent._path);\r\n        if (parent._level === 2) {\r\n            parent._path[parent._path.length - 1][0] =\r\n                ParentChildSelector.grandParent;\r\n        }\r\n        if (add_for_both) {\r\n            if (!parent._children.find((obj) => obj === this._id)) {\r\n                parent._children.push(this._id);\r\n            }\r\n        }\r\n    };\r\n\r\n    getLatestPathKey = () => {\r\n        if (this._path.length == 0) {\r\n            throw new Error('Invalid Case');\r\n        }\r\n        return this._path[this._path.length - 1][0];\r\n    };\r\n\r\n    getLevel = (path: Array<[number, number]>) => {\r\n        let level = 0;\r\n        path.map((x) => {\r\n            if (x[0] === ParentChildSelector.child) {\r\n                level = level - 1;\r\n            } else if (\r\n                x[0] === ParentChildSelector.parent ||\r\n                x[0] === ParentChildSelector.grandParent\r\n            ) {\r\n                level = level + 1;\r\n            } else {\r\n                level = level + 0;\r\n            }\r\n        });\r\n        return level;\r\n    };\r\n\r\n    static getNode = (id: number, nodeMap: Map<number, NodeEntity>) => {\r\n        const node: NodeEntity | undefined = nodeMap.get(id);\r\n        if (node == undefined) {\r\n            throw new Error('Node not found with given id:' + id);\r\n        }\r\n        return node;\r\n    };\r\n\r\n    setPathforPartner = (partnerSelector: number, partner: NodeEntity) => {\r\n        partner._path = [...this._path];\r\n        partner._path.push([partnerSelector, partner._id]);\r\n    };\r\n\r\n    getChildUnprocessedNode() {\r\n        if (this._processChildNodePos < this._children.length) {\r\n            return this._children[this._processChildNodePos++];\r\n        }\r\n    }\r\n    updateProcessChildNodePos() {\r\n        this._processChildNodePos++;\r\n    }\r\n\r\n    has_surviving_spouse = () => {\r\n        if (this._spouse !== null) return true;\r\n        return false;\r\n    };\r\n\r\n    has_surviving_cohabitant = () => {\r\n        if (this._cohabitant !== null) return true;\r\n        return false;\r\n    };\r\n}\r\n","export enum ChatStepTypes {\r\n    initalStep = 'initialStep',\r\n    testatorStep = 'testatorStep',\r\n    undividedEstateStep = 'undividedEstateStep',\r\n    netWealthStep = 'netWealthStep',\r\n    underAgeStep = 'underAgeStep',\r\n    spouseChoice = 'spouseChoice',\r\n    spouseStep = 'spouseStep',\r\n    cohabitantChoice = 'cohabitantChoice',\r\n    cohabitantStep = 'cohabitantStep',\r\n    successorStep = 'successorStep',\r\n    parentsStep = 'parentsStep',\r\n    rearChildrenStep = 'rearChildrenStep',\r\n    marriedParentsStep = 'marriedParentsStep',\r\n    grandParentStep = 'grandParentStep',\r\n    finalStep = 'finalStep',\r\n    secondParentChoice = 'secondParentChoice',\r\n    testatorOtherChildStep = 'testatorOtherChildStep',\r\n}\r\n\r\nexport enum QuestionType {\r\n    initialQuestion = 'none',\r\n    part1 = 'part1',\r\n    part2 = 'part2',\r\n    part3 = 'part3',\r\n    part4 = 'part4',\r\n    part5 = 'part5',\r\n    part6 = 'part6',\r\n    part7 = 'part7',\r\n    part8 = 'part8',\r\n}\r\n\r\nexport enum undividedOwnershipType {\r\n    felleseie = 'FELLESEIE',\r\n    delvis = 'DELVIS SREIE',\r\n    fullt = 'FULLT SREIE',\r\n}\r\n\r\nexport enum FormattedMessages {\r\n    FELLESEIE = 'Chatbot.OWNERSHIP_TYPE1',\r\n    DELVIS = 'Chatbot.OWNERSHIP_TYPE2',\r\n    FULLT = 'Chatbot.OWNERSHIP_TYPE3',\r\n}\r\n","import Person from '../ChatbotComponent/Helper/Classes/Person';\r\nimport { NodeEntity } from './Helper/Classes/NodeEntity';\r\nimport {\r\n    ChatStepTypes,\r\n    QuestionType,\r\n    undividedOwnershipType,\r\n} from './Helper/Enums/ChatStepTypes';\r\nimport _ from 'lodash';\r\nexport interface ChatbotInterface {\r\n    stepID: string;\r\n    person: NodeEntity;\r\n    testator: NodeEntity;\r\n    netWealth: number;\r\n    successor_flag: string;\r\n    parent_flag: string;\r\n    temp_person: NodeEntity;\r\n    temp_child: NodeEntity;\r\n    temp_parent: NodeEntity;\r\n    personsMap: Map<number, Person>;\r\n    nodeMap: Map<number, NodeEntity>;\r\n    id: number;\r\n    undividedSpouseId: number;\r\n    deceasedParentsArray: Array<number>;\r\n    grandParent_flag: string;\r\n    rearChildrenResponse: boolean;\r\n    undividedEstate: {\r\n        undividedEstateChoice: boolean;\r\n        undivided_flag: string;\r\n        totalEstateValue: number;\r\n        undividedEstateSeparateWealth: number;\r\n        temp_first: number;\r\n        temp_last: number;\r\n        ownershipType: string;\r\n    };\r\n    tempMessages: any;\r\n    successorProcessArray: Array<[number, number]>;\r\n    isUndividedParent: boolean;\r\n    yesNoClickedFlag: boolean;\r\n}\r\n\r\nconst initChatbotState: ChatbotInterface = {\r\n    stepID: ChatStepTypes.initalStep,\r\n    person: new NodeEntity(0, 0),\r\n    testator: new NodeEntity(0, 0),\r\n    netWealth: 0,\r\n    successor_flag: QuestionType.initialQuestion,\r\n    parent_flag: QuestionType.initialQuestion,\r\n    temp_person: new NodeEntity(0, 0),\r\n    temp_child: new NodeEntity(0, 0),\r\n    temp_parent: new NodeEntity(0, 0),\r\n    personsMap: new Map(),\r\n    nodeMap: new Map(),\r\n    id: 1,\r\n    undividedSpouseId: 0,\r\n    deceasedParentsArray: [],\r\n    grandParent_flag: QuestionType.initialQuestion,\r\n    rearChildrenResponse: false,\r\n    undividedEstate: {\r\n        undividedEstateChoice: false,\r\n        undivided_flag: QuestionType.initialQuestion,\r\n        totalEstateValue: 0,\r\n        undividedEstateSeparateWealth: 0,\r\n        temp_first: 0,\r\n        temp_last: 0,\r\n        ownershipType: '',\r\n    },\r\n    tempMessages: [],\r\n    successorProcessArray: [],\r\n    isUndividedParent: false,\r\n    yesNoClickedFlag: false,\r\n};\r\n\r\nexport const ChatbotState: ChatbotInterface = { ...initChatbotState };\r\n\r\nexport const InitialChatbotState: any = _.cloneDeep(initChatbotState);\r\n\r\nexport const cloneState = (curState: any, prevState: any) => {\r\n    curState.messages = prevState.messages;\r\n    curState.personMap = prevState.personMap;\r\n    curState.nodeMap = prevState.nodeMap;\r\n    curState.testator = prevState.testator;\r\n    curState.stepID = prevState.stepID;\r\n    curState.person = prevState.person;\r\n    curState.netWealth = prevState.netWealth;\r\n    curState.successor_flag = prevState.successor_flag;\r\n    curState.parent_flag = prevState.parent_flag;\r\n    curState.temp_person = prevState.temp_person;\r\n    curState.temp_child = prevState.temp_child;\r\n    curState.id = prevState.id;\r\n    curState.undividedSpouseId = prevState.undividedSpouseId;\r\n    curState.deceasedParentsArray = prevState.deceasedParentsArray;\r\n    curState.deceasedParentsArray = prevState.deceasedParentsArray;\r\n    curState.grandParent_flag = prevState.grandParent_flag;\r\n    curState.rearChildrenResponse = prevState.rearChildrenResponse;\r\n    curState.undividedEstate = prevState.undividedEstate;\r\n    curState.tempMessages = prevState.tempMessages;\r\n    curState.successorProcessArray = prevState.successorProcessArray;\r\n    curState.isUndividedParent = prevState.isUndividedParent;\r\n    curState.yesNoClickedFlag = prevState.yesNoClickedFlag;\r\n    curState.testator = prevState.testator;\r\n    curState.testator = prevState.testator;\r\n    curState.testator = prevState.testator;\r\n    return curState;\r\n};\r\nInitialChatbotState.messages = [];\r\n","import { Subject, Subscription } from 'rxjs';\r\nimport _ from 'lodash';\r\nimport { InitialChatbotState } from '../Generics';\r\n\r\nconst inSubject = new Subject();\r\nconst outSubject = new Subject();\r\nconst internalSubscriptionList = new Array<Subscription>();\r\nconst externalSubscriptionList = new Array<Subscription>();\r\nconst previousStates = new Array<any>();\r\nlet revertCnt = 0;\r\nlet isRevert = false;\r\n\r\nexport const messageService = {\r\n    sendMessageToChatbot: (message: any) => inSubject.next(message),\r\n\r\n    sendMessageFromChatbot: (message: any) => outSubject.next(message),\r\n\r\n    getMessageInChatbot: () => inSubject.asObservable(),\r\n\r\n    getMessageOutChatbot: () => outSubject.asObservable(),\r\n\r\n    addInternalSubscription: (subscription: Subscription) =>\r\n        internalSubscriptionList.push(subscription),\r\n\r\n    addExternalSubscription: (subscription: Subscription) =>\r\n        externalSubscriptionList.push(subscription),\r\n\r\n    addPreviousState: (data: any) => {\r\n        const stateCopy = _.cloneDeep(data);\r\n        if (\r\n            previousStates.filter(\r\n                (previousState) =>\r\n                    Object.entries(previousState) == Object.entries(stateCopy),\r\n            ).length === 0\r\n        ) {\r\n            previousStates.push(stateCopy);\r\n        }\r\n    },\r\n    printPreviousStates: () => {\r\n        console.log(previousStates);\r\n    },\r\n    removePreviousState: () => {\r\n        if (previousStates.length === 0) {\r\n            return null;\r\n        }\r\n        return previousStates.pop();\r\n    },\r\n    removePreviousStates: (cnt: number) => {\r\n        let finalState = {};\r\n        for (let i = 0; i < cnt; i++) {\r\n            if (previousStates.length === 0) {\r\n                return InitialChatbotState;\r\n            }\r\n            finalState = previousStates.pop();\r\n        }\r\n        return finalState;\r\n    },\r\n    getPreviousStates: () => previousStates,\r\n\r\n    getPreviousState: (reverseCount: number) => {\r\n        if (previousStates.length === 0) return null;\r\n        return previousStates[previousStates.length - 1 - reverseCount];\r\n    },\r\n\r\n    clearAllInternalSubscription: () => {\r\n        internalSubscriptionList.forEach((subscription: Subscription) => {\r\n            subscription.unsubscribe();\r\n        });\r\n    },\r\n\r\n    clearAllExternalSubscription: () => {\r\n        externalSubscriptionList.forEach((subscription: Subscription) => {\r\n            subscription.unsubscribe();\r\n        });\r\n    },\r\n    addRevertCnt: () => {\r\n        revertCnt += 1;\r\n    },\r\n    getRevertCnt: () => {\r\n        return revertCnt;\r\n    },\r\n    resetRevertCnt: () => {\r\n        revertCnt = 0;\r\n    },\r\n    setRevert: () => {\r\n        isRevert = true;\r\n    },\r\n    resetRevert: () => {\r\n        isRevert = false;\r\n    },\r\n    getRevert: () => {\r\n        return isRevert;\r\n    },\r\n    resetChatbotState: () => {\r\n        while (previousStates.length > 0) {\r\n            previousStates.shift();\r\n        }\r\n        revertCnt = 0;\r\n        isRevert = false;\r\n    },\r\n};\r\n","export enum BinaryAnswerTypeYes {\r\n  \"yes\",\r\n  \"ja\",\r\n}\r\n\r\nexport enum BinaryAnswerTypeNo {\r\n  \"no\",\r\n  \"nei\",\r\n}\r\n","export enum ValidationType {\r\n    emptyValue = 0,\r\n    invalidAmount = 1,\r\n    onlyDigit = 2,\r\n    incorrectValueForBoolean = 3,\r\n    incorrectValueForUndividedOptions = 4,\r\n}\r\nexport enum DefaultWarningMessage {\r\n    emptyValueMessage = 'The field cannot be empty.',\r\n    onlyDigitMessage = 'Only numerical values are allowed.',\r\n    errorForBooleanMessage = \"Please choose correct value or write 'yes/ja', 'no/nei'.\",\r\n    invalidAmountMessage = 'Please enter the amount in correct format.',\r\n    incorrectValueForUndividedMessage = 'Please choose one of the options or write them in the answer field.',\r\n}\r\n","import ActionProvider from '../../ActionProvider';\r\nimport {\r\n    BinaryAnswerTypeNo,\r\n    BinaryAnswerTypeYes,\r\n} from '../Enums/BinaryAnswerTypes';\r\nimport { DefaultWarningMessage, ValidationType } from '../Enums/ValidationType';\r\nimport _ from 'lodash';\r\nimport { undividedOwnershipType } from '../Enums/ChatStepTypes';\r\n\r\nexport class ChatbotValidation {\r\n    constructor(\r\n        private actionProvider: ActionProvider,\r\n        private chatbotState: any,\r\n    ) {}\r\n    validate = (\r\n        message: string,\r\n        validationTypes: Array<number>,\r\n        warningMessage = '',\r\n    ): boolean => {\r\n        validationTypes = this.addEmptyRuleAndSortInc(validationTypes);\r\n        for (const validationType of validationTypes) {\r\n            let validationResult = false;\r\n            switch (validationType) {\r\n                case ValidationType.emptyValue:\r\n                    validationResult = this.validateEmpty(message);\r\n                    break;\r\n                case ValidationType.invalidAmount:\r\n                    validationResult = this.validateAmount(message);\r\n                    break;\r\n                case ValidationType.onlyDigit:\r\n                    validationResult = this.validateDigit(message);\r\n                    break;\r\n                case ValidationType.incorrectValueForBoolean:\r\n                    validationResult = this.validateValueForBoolean(message);\r\n                    break;\r\n                case ValidationType.incorrectValueForUndividedOptions:\r\n                    validationResult =\r\n                        this.validateValueForUndividedOptions(message);\r\n                    break;\r\n                default:\r\n                    console.error('Invalid Validation type');\r\n                    return false;\r\n            }\r\n            if (warningMessage === '' && !validationResult) {\r\n                warningMessage = this.getWarningMessage(validationType);\r\n            }\r\n            if (!validationResult && this.chatbotState) {\r\n                this.showWarning(warningMessage);\r\n                const messageCopy = _.cloneDeep(this.chatbotState.messages);\r\n                this.actionProvider.handleValidation(\r\n                    messageCopy,\r\n                    this.actionProvider.stateRef,\r\n                );\r\n                return false;\r\n            } else {\r\n                this.hideWarning();\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    validateEmpty = (message: string) => {\r\n        // if valid string, returns true\r\n        if (message.length !== 0) return true;\r\n        return false;\r\n    };\r\n\r\n    validateAmount = (message: string) => {\r\n        const re = /^\\d*(\\.\\d+)?$/;\r\n        if (message.match(re)) {\r\n            return true;\r\n        } else return false;\r\n    };\r\n\r\n    validateDigit = (message: string) => {\r\n        const checkNatural = /^(0|([1-9]\\d*))$/;\r\n        if (checkNatural.test(message)) return true;\r\n        return false;\r\n    };\r\n\r\n    validateValueForBoolean = (message: string) => {\r\n        if (\r\n            (message in BinaryAnswerTypeYes || message in BinaryAnswerTypeNo) &&\r\n            !(message in [0, 1])\r\n        ) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n\r\n    validateValueForUndividedOptions = (message: string) => {\r\n        if (\r\n            Object.values(undividedOwnershipType).includes(\r\n                message as undividedOwnershipType,\r\n            )\r\n        ) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n\r\n    private showWarning = (warningMessage: string) => {\r\n        const warningDiv = document.getElementById('chatbot-warning-div');\r\n        if (warningDiv) {\r\n            warningDiv.innerHTML = `<div id=\"chatbot-warning-innerDiv\"><p style=\"margin: 0.3rem\">${warningMessage}</p></div>`;\r\n            warningDiv.style.display = 'block';\r\n\r\n            const newDiv = document.getElementById('chatbot-warning-innerDiv');\r\n            const closeButton = document.createElement('button');\r\n            closeButton.innerHTML = 'x';\r\n            closeButton.style.cssText = 'position: absolute; top: 0; right: 0;';\r\n            closeButton.addEventListener('click', () => {\r\n                if (newDiv) newDiv.remove();\r\n            });\r\n            if (newDiv !== null) {\r\n                newDiv.appendChild(closeButton);\r\n            }\r\n            return;\r\n        }\r\n    };\r\n    private hideWarning = () => {\r\n        const warningDiv = document.getElementById('chatbot-warning-div');\r\n        if (warningDiv) {\r\n            warningDiv.style.display = 'none';\r\n            return;\r\n        }\r\n    };\r\n    getWarningMessage(validationType: ValidationType) {\r\n        switch (validationType) {\r\n            case ValidationType.emptyValue:\r\n                return DefaultWarningMessage.emptyValueMessage;\r\n            case ValidationType.incorrectValueForBoolean:\r\n                return DefaultWarningMessage.errorForBooleanMessage;\r\n            case ValidationType.invalidAmount:\r\n                return DefaultWarningMessage.invalidAmountMessage;\r\n            case ValidationType.onlyDigit:\r\n                return DefaultWarningMessage.onlyDigitMessage;\r\n            case ValidationType.incorrectValueForUndividedOptions:\r\n                return DefaultWarningMessage.incorrectValueForUndividedMessage;\r\n            default:\r\n                return 'Improve error message in ChatbotType.ts';\r\n        }\r\n    }\r\n\r\n    addEmptyRuleAndSortInc = (valArray: Array<number>): Array<number> => {\r\n        if (!valArray.includes(0)) valArray.push(0);\r\n        return valArray.sort((a, b) => a - b);\r\n    };\r\n}\r\n","const numberInputTypesObject = {\r\n    0: ['0', 'zero', 'null', 'ingen', 'None', 'ikkje nokon'],\r\n    1: ['1', 'one', 'en', 'ett', 'et', 'ein', 'eitt', 'eit'],\r\n    2: ['2', 'two', 'to'],\r\n    3: ['3', 'three', 'tre'],\r\n    4: ['4', 'four', 'fire'],\r\n    5: ['5', 'five', 'fem'],\r\n    6: ['6', 'six', 'seks'],\r\n    7: ['7', 'seven', 'syv', 'sju'],\r\n    8: ['8', 'eight', 'aatte', 'tte'],\r\n    9: ['9', 'nine', 'ni'],\r\n    10: ['10', 'ten', 'ti'],\r\n    11: ['11', 'eleven', 'elleve'],\r\n    12: ['12', 'twelve', 'tolv'],\r\n    13: ['13', 'thirteen', 'tretten'],\r\n    14: ['14', 'fourteen', 'fjorten'],\r\n    15: ['15', 'fifteen', 'femten'],\r\n    16: ['16', 'sixteen', 'seksten'],\r\n    17: ['17', 'seventeen', 'sytten', 'stten'],\r\n    18: ['18', 'eighteen', 'atten'],\r\n    19: ['19', 'nineeen', 'nitten'],\r\n    20: ['20', 'twenty', 'tyve', 'tjue'],\r\n    21: ['21'],\r\n    // until 40.\r\n};\r\n\r\nexport const returnKeyFromEnteredNumberText = (chosenValue: string) => {\r\n    const key = Object.keys(numberInputTypesObject).find((key) =>\r\n        (numberInputTypesObject as any)[key].includes(\r\n            chosenValue.toLowerCase(),\r\n        ),\r\n    );\r\n    return key ?? chosenValue;\r\n};\r\n","import { FormattedMessage } from 'react-intl';\r\nimport {\r\n    FormattedMessages,\r\n    undividedOwnershipType,\r\n} from '../Enums/ChatStepTypes';\r\n\r\nexport const getReturnValueFromBooleanWidget = (\r\n    message: string,\r\n    state: any,\r\n) => {\r\n    state = {\r\n        ...state,\r\n        yesNoClickedFlag: true,\r\n    };\r\n    const returnValue =\r\n        message === 'yes' ? (\r\n            <FormattedMessage id=\"Chatbot.Yes\" />\r\n        ) : (\r\n            <FormattedMessage id=\"Chatbot.No\" />\r\n        );\r\n\r\n    return returnValue;\r\n};\r\n\r\nexport const getReturnValueFromUndividedWidget = (\r\n    message: string,\r\n    state: any,\r\n) => {\r\n    state = {\r\n        ...state,\r\n        yesNoClickedFlag: true,\r\n    };\r\n\r\n    const ownershipTypeWithFormattedMessages = {\r\n        [undividedOwnershipType.felleseie]: (\r\n            <FormattedMessage id={FormattedMessages.FELLESEIE} />\r\n        ),\r\n        [undividedOwnershipType.delvis]: (\r\n            <FormattedMessage id={FormattedMessages.DELVIS} />\r\n        ),\r\n        [undividedOwnershipType.fullt]: (\r\n            <FormattedMessage id={FormattedMessages.FULLT} />\r\n        ),\r\n    };\r\n\r\n    return (\r\n        ownershipTypeWithFormattedMessages[\r\n            message as keyof typeof ownershipTypeWithFormattedMessages\r\n        ] ?? 'The message is not in the array'\r\n    );\r\n};\r\n","\r\n// error:\r\n// 1- no digits in input error\r\n// 2- separatorCount error\r\n// 3- digitsBeforeSeparatorValue error\r\n// 4- unknown error, debug\r\n// 5- normal pass\r\n//\r\nconst checkSeparatorCount = (initialCurrencyValue: string): number => {\r\n    let checkSeparatorCount = 0;\r\n    for (const i of initialCurrencyValue) {\r\n        if (i == \",\" || i == \" \" || i == \".\") {\r\n            checkSeparatorCount += 1;\r\n        }\r\n    }\r\n    if (checkSeparatorCount == 0) {\r\n        return 0 // no separators, valid input, format it.\r\n    }\r\n    else if (checkSeparatorCount > 1) {\r\n        // more than 1 symbol in the entered value, invalid input, error\r\n        return 2\r\n    }\r\n    else {\r\n        return 1 // one separator, valid input.\r\n    }\r\n}\r\n\r\n\r\nconst checkDigitsBeforeSeparatorValue = (initialCurrencyValue: string): string => {\r\n    let digitsBeforeSymbol = 0;\r\n    for (const i of initialCurrencyValue) {\r\n        if (digitsBeforeSymbol > 3) {\r\n            // more than 3 digits before symbol\r\n            return \"incorrect\"\r\n        }\r\n        else if (i !== \",\" && i !== \" \" && i !== \".\") {\r\n            digitsBeforeSymbol += 1;\r\n        }\r\n        else {\r\n            digitsBeforeSymbol = 0;\r\n        }\r\n\r\n    }\r\n    return \"correct\"\r\n}\r\n\r\nconst removeTextFromCurrencyString = (inputCurrency: string): string => {\r\n    let beginningValue = \"\";\r\n    let endValue = \"\"\r\n\r\n    // match and remove extra text at the beginning\r\n    const matchesStart: RegExpMatchArray | null = inputCurrency.match(/^[\\D]{0,}/)\r\n    if (matchesStart) {\r\n        const matchStartResult = matchesStart[0];\r\n        beginningValue = inputCurrency.substring(matchStartResult.length,)\r\n    }\r\n\r\n    // match and remove extra text at the end\r\n    const matchesEnd: RegExpMatchArray | null = beginningValue.match(/[^\\d]{0,}$/)\r\n    if (matchesEnd) {\r\n        const matchEndResult = matchesEnd[0];\r\n        endValue = beginningValue.substring(0, beginningValue.length - matchEndResult.length)\r\n    }\r\n\r\n    return endValue.replace(\" \", \"\").replace(\".\", \"\").replace(\",\", \"\")\r\n}\r\n\r\nexport const ParseCurrencyStringForOutput = (unformattedCurrency: string): string => {\r\n    return new Intl.NumberFormat(\"no-NO\", {\r\n        style: \"currency\",\r\n        currency: \"NOK\",\r\n        currencyDisplay: \"narrowSymbol\",\r\n        minimumFractionDigits: 0,\r\n        maximumFractionDigits: 0,\r\n    }).format(Number(unformattedCurrency.replace(/[^0-9.-]+/g, \"\"))).replace(\"kr\", \"kr.\").concat(\",-\");\r\n\r\n}\r\n\r\nexport const validateCurrency = (inputCurrency: string): boolean => {\r\n    // const currencyMatchExpression = /^((\\d{1,3},)*\\d{3}|\\d{1,3})\\.\\d{2}$|^((\\d{1,3}\\.)*\\d{3}|\\d{1,3})$/;\r\n    const currencyMatchExpression = /^\\d+$/;\r\n    if (inputCurrency.match(currencyMatchExpression)) {\r\n        return true;\r\n    } else {\r\n        return false;\r\n    }\r\n};\r\n\r\nexport const CurrencyOutput = (inputCurrency: string): [number, string] => {\r\n\r\n    if ((/\\d/).test(inputCurrency)) {\r\n        const initialCurrencyValue: string = removeTextFromCurrencyString(inputCurrency)\r\n\r\n        let digitsBeforeSeparatorValue = \"correct\"\r\n        const separatorCount = checkSeparatorCount(initialCurrencyValue);\r\n        if (separatorCount !== 0) {\r\n            digitsBeforeSeparatorValue = checkDigitsBeforeSeparatorValue(initialCurrencyValue)\r\n        }\r\n        if ((separatorCount === 0 || separatorCount === 1) && digitsBeforeSeparatorValue === \"correct\") {\r\n            return [5, initialCurrencyValue]\r\n        }\r\n\r\n        else {\r\n            if (separatorCount === 2) {\r\n                return [2, \"separatorCount\"]\r\n            }\r\n            else if (digitsBeforeSeparatorValue === \"incorrect\") {\r\n                return [3, \"digitsBeforeSeparatorValue\"]\r\n            }\r\n            else {\r\n                return [4, \"unknown error, debug\"]\r\n            }\r\n        }\r\n    }\r\n    else {\r\n        // show error message and ask question again\r\n        return [1, \"\"]\r\n    }\r\n\r\n}\r\n","import { ReactElement, useRef, useState } from \"react\";\r\nimport Popover from \"@mui/material/Popover\";\r\nimport \"./ShowInfoWidget.scss\";\r\nimport LiveHelpIcon from \"@mui/icons-material/LiveHelp\";\r\nimport makeStyles from \"@mui/styles/makeStyles\";\r\nimport { FormattedMessage } from \"react-intl\";\r\nimport { useTheme } from \"@mui/material/styles\";\r\n// import { Typography } from \"@mui/material\";\r\n\r\nconst useStyles = makeStyles((_) => ({\r\n  popover: {\r\n    pointerEvents: \"none\",\r\n  },\r\n  paper: {\r\n    padding: useTheme().spacing(1),\r\n    backgroundColor: \"#e8e4c9\",\r\n  },\r\n}));\r\n\r\nconst ShowInfoWidget = (props: any): ReactElement => {\r\n  const classes = useStyles();\r\n  /*\r\n   used reference to parent element for correcting the scrollbar conflict issue on popover show.\r\n   https://stackoverflow.com/questions/53985436/material-ui-unblock-scrolling-when-popover-is-opened\r\n  */\r\n  const [anchorEl, setAnchorEl] = useState(null);\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n  const handlePopoverOpen = (event: any) => {\r\n    setAnchorEl(event.currentTarget);\r\n  };\r\n\r\n  const handlePopoverClose = () => {\r\n    setAnchorEl(null);\r\n  };\r\n\r\n  const open = Boolean(anchorEl);\r\n  return (\r\n    <div className=\"infoDiv\" ref={containerRef}>\r\n      <LiveHelpIcon\r\n        className=\"InfoWidgetIcon\"\r\n        onMouseEnter={handlePopoverOpen}\r\n        onMouseLeave={handlePopoverClose}\r\n        aria-owns={open ? \"mouse-over-popover\" : undefined}\r\n        aria-haspopup=\"true\"\r\n      />\r\n\r\n      <Popover\r\n        id=\"mouse-over-popover\"\r\n        className={classes.popover}\r\n        classes={{\r\n          paper: classes.paper,\r\n        }}\r\n        open={open}\r\n        anchorEl={anchorEl}\r\n        anchorOrigin={{\r\n          vertical: \"bottom\",\r\n          horizontal: \"right\",\r\n        }}\r\n        transformOrigin={{\r\n          vertical: \"bottom\",\r\n          horizontal: \"left\",\r\n        }}\r\n        onClose={handlePopoverClose}\r\n        disableRestoreFocus\r\n        container={containerRef.current}\r\n      >\r\n        <FormattedMessage id={props.text} />\r\n      </Popover>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ShowInfoWidget;\r\n","import { ReactElement } from \"react\";\r\nimport { FormattedMessage } from \"react-intl\";\r\nimport ShowInfoWidget from \"../../Custom/Widgets/ShowInfoWidget/ShowInfoWidget\";\r\n\r\nclass QuestionConstants {\r\n  static TestatorQuestion = (\r\n    <FormattedMessage id=\"Chatbot.TESTATOR_QUESTION\" />\r\n  );\r\n\r\n  static UndividedEstateQuestion = (\r\n    <FormattedMessage id=\"Chatbot.UNDIVIDED_ESTATE_QUESTION\" />\r\n  );\r\n\r\n  static YesNoWidgetOptions = {\r\n    widget: \"optionSelectorWidget\",\r\n    withAvatar: true,\r\n    loading: true,\r\n    terminateLoading: true,\r\n  };\r\n\r\n  static UndividedEstateResultText = (selectedOption: string): ReactElement => {\r\n    const undividedEstateResultText =\r\n      selectedOption === \"true\" ? \"Chatbot.Yes\" : \"Chatbot.No\";\r\n    return <FormattedMessage id={undividedEstateResultText} />;\r\n  };\r\n\r\n  static undvdSpouseOtherSuccessorQuestion = (): ReactElement => {\r\n    const undividedSpouseOtherSuccessorQuestion =\r\n      \"How many children does the first-deceased have from other relationship(s) (srkullsbarn)?\";\r\n    return <div>{undividedSpouseOtherSuccessorQuestion}</div>;\r\n  };\r\n\r\n  static testatorOtherSuccessorQuestion = (): ReactElement => {\r\n    const testatorOtherSuccessorQuestion =\r\n      \"How many children does the last-deceased have from other relationship(s) (srkullsbarn)?\";\r\n    return <div>{testatorOtherSuccessorQuestion}</div>;\r\n  };\r\n\r\n  static NetWealthQuestion = (\r\n    <div>\r\n      <FormattedMessage id=\"Chatbot.NET_WEALTH_QUESTION\" />\r\n      <ShowInfoWidget text=\"Chatbot.NET_WEALTH_EXTRA_INFO\" />\r\n    </div>\r\n  );\r\n\r\n  static NetWealthWarning = (\r\n    <FormattedMessage id=\"Chatbot.NET_WEALTH_WARNING\" />\r\n  );\r\n\r\n  static UnderAgeQuestion = (\r\n    <FormattedMessage id=\"Chatbot.UNDER_AGE_QUESTION\" />\r\n  );\r\n\r\n  static UnderAgeResultText = (selectedOption: boolean): ReactElement => {\r\n    const underAgeResultText = selectedOption\r\n      ? \"Chatbot.UnderAge\"\r\n      : \"Chatbot.NotUnderAge\";\r\n\r\n    return <FormattedMessage id={underAgeResultText} />;\r\n  };\r\n\r\n  static SpouseChoiceQuestion = (\r\n    <FormattedMessage id=\"Chatbot.SPOUSE_EXIST_QUESTION\" />\r\n  );\r\n\r\n  static SpouseQuestion = (<FormattedMessage id=\"Chatbot.SPOUSE_QUESTION\" />);\r\n\r\n  static CohabitantChoiceQuestion = (\r\n    <FormattedMessage id=\"Chatbot.COHABITANT_EXIST_QUESTION\" />\r\n  );\r\n\r\n  static CohabitantQuestion = (\r\n    <div>\r\n      <FormattedMessage id=\"Chatbot.COHABITANT_QUESTION\" />\r\n      <ShowInfoWidget text=\"Chatbot.COHABITANT_EXTRA_INFO\" />\r\n    </div>\r\n  );\r\n\r\n  static addSuccessorQuestion1 = (person_id: string): ReactElement => {\r\n    return (\r\n      <div>\r\n        <FormattedMessage\r\n          id=\"Chatbot.addSuccessorQn1\"\r\n          values={{ person_ID: <strong>{person_id}</strong> }}\r\n        />\r\n        <ShowInfoWidget text=\"Chatbot.CHILD_EXTRA_INFO\" />\r\n      </div>\r\n    );\r\n  };\r\n  static addSuccessorQuestion2 = (\r\n    person_id: string,\r\n    child_id_string: ReactElement\r\n  ): ReactElement => {\r\n    return (\r\n      <div>\r\n        <FormattedMessage\r\n          id=\"Chatbot.addSuccessorQn2\"\r\n          values={{\r\n            person_ID: <strong>{person_id}</strong>,\r\n            children_IDs: child_id_string,\r\n          }}\r\n        />\r\n        <ShowInfoWidget text=\"Chatbot.CHILD_EXTRA_INFO\" />\r\n      </div>\r\n    );\r\n  };\r\n\r\n  static AliveQuestion = (child_id: string): ReactElement => {\r\n    return (\r\n      <FormattedMessage\r\n        id=\"Chatbot.ALIVE_CHILD\"\r\n        values={{ child_ID: child_id }}\r\n      />\r\n    );\r\n  };\r\n\r\n  static AliveResultText = (selectedOption: string): ReactElement => {\r\n    const aliveResultText = selectedOption ? \"Chatbot.Yes\" : \"Chatbot.No\";\r\n\r\n    return <FormattedMessage id={aliveResultText} />;\r\n  };\r\n\r\n  static addParentsQuestion1 = (person_id: string): ReactElement => {\r\n    return (\r\n      <div>\r\n        <FormattedMessage\r\n          id=\"Chatbot.addParentsQn1\"\r\n          values={{ person_ID: <strong>{person_id}</strong> }}\r\n        />\r\n        <ShowInfoWidget text=\"Chatbot.PARENT_EXTRA_INFO\" />\r\n      </div>\r\n    );\r\n  };\r\n\r\n  static askSecondParentChoiceQuestion = (person_id: string): ReactElement => {\r\n    return (\r\n      <div>\r\n        <FormattedMessage\r\n          id=\"Chatbot.SecondParentChoice\"\r\n          values={{ person_ID: <strong>{person_id}</strong> }}\r\n        />\r\n      </div>\r\n    );\r\n  };\r\n\r\n  static addParentsQuestion2 = (\r\n    person_id: string,\r\n    parent_id_string: ReactElement\r\n  ): ReactElement => {\r\n    return (\r\n      <div>\r\n        <FormattedMessage\r\n          id=\"Chatbot.addParentsQn2\"\r\n          values={{\r\n            person_ID: <strong>{person_id}</strong>,\r\n            parents_IDs: parent_id_string,\r\n          }}\r\n        />\r\n        <ShowInfoWidget text=\"Chatbot.PARENT_EXTRA_INFO\" />\r\n      </div>\r\n    );\r\n  };\r\n\r\n  static MarriedParents1 = (\r\n    first_parent_id: string,\r\n    second_parent_id: string\r\n  ): ReactElement => {\r\n    return (\r\n      <div>\r\n        <FormattedMessage\r\n          id=\"Chatbot.marriedParents1\"\r\n          values={{\r\n            parent1_ID: <strong>{first_parent_id}</strong>,\r\n            parent2_ID: <strong>{second_parent_id}</strong>,\r\n          }}\r\n        />\r\n      </div>\r\n    );\r\n  };\r\n\r\n  static MarriedParents2 = (\r\n    first_parent_id: string,\r\n    second_parent_id: string\r\n  ): ReactElement => {\r\n    return (\r\n      <div>\r\n        <FormattedMessage\r\n          id=\"Chatbot.marriedParents2\"\r\n          values={{\r\n            parent1_ID: <strong>{first_parent_id}</strong>,\r\n            parent2_ID: <strong>{second_parent_id}</strong>,\r\n          }}\r\n        />\r\n      </div>\r\n    );\r\n  };\r\n\r\n  static addGrandParentsQuestion1 = (parent_id: string): ReactElement => {\r\n    return (\r\n      <div>\r\n        <FormattedMessage\r\n          id=\"Chatbot.addGrandParentQn1\"\r\n          values={{ parent_id: <strong>{parent_id}</strong> }}\r\n        />\r\n      </div>\r\n    );\r\n  };\r\n\r\n  static addGrandParentsQuestion2 = (\r\n    parent_id: string,\r\n    grandparent_id_string: ReactElement\r\n  ): ReactElement => {\r\n    return (\r\n      <div>\r\n        <FormattedMessage\r\n          id=\"Chatbot.addGrandParentQn2\"\r\n          values={{\r\n            parent_id: <strong>{parent_id}</strong>,\r\n            grandParents_IDs: grandparent_id_string,\r\n          }}\r\n        />\r\n      </div>\r\n    );\r\n  };\r\n\r\n  static FinalQuestion = (<FormattedMessage id=\"Chatbot.FINAL_QUESTION\" />);\r\n\r\n  static EmptyQuestion = (<p></p>);\r\n  static DefaultText = (<FormattedMessage id=\"Chatbot.DEFAULT_TEXT\" />);\r\n\r\n  // UndividedEstateStart\r\n\r\n  static TotalEstateNetValueQuestion = (\r\n    <div>\r\n      <FormattedMessage id=\"Chatbot.TOTAL_ESTATE_NET_VALUE_QUESTION\" />\r\n      <ShowInfoWidget text=\"Chatbot.TOTAL_ESTATE_NET_VALUE_EXTRA_INFO\" />\r\n    </div>\r\n  );\r\n\r\n  static TotalEstateNetValueWarning = (\r\n    <FormattedMessage id=\"Chatbot.NET_WEALTH_WARNING\" />\r\n  );\r\n\r\n  static OwnershipTypeQuestion = (\r\n    <FormattedMessage id=\"Chatbot.FELLESEIE_QUESTION\" />\r\n  );\r\n\r\n  static OwnershipQuestionWidgetOptions = {\r\n    widget: \"undividedEstateWidget\",\r\n    withAvatar: true,\r\n    loading: true,\r\n    terminateLoading: true,\r\n  };\r\n\r\n  static OwnershipTypeWarning = (\r\n    <FormattedMessage id=\"Chatbot.OptionChoiceWrongWarning\" />\r\n  );\r\n\r\n  static DelvisFirstQuestion = (\r\n    <div>\r\n      <FormattedMessage id=\"Chatbot.DELVIS_SAEREIE_FIRST_QUESTION\" />\r\n      <ShowInfoWidget text=\"Chatbot.DELVIS_SAEREIE_FIRST_EXTRA_INFO\" />\r\n    </div>\r\n  );\r\n\r\n  static DelvisSecondQuestion = (\r\n    <div>\r\n      <FormattedMessage id=\"Chatbot.DELVIS_SAEREIE_LAST_QUESTION\" />\r\n      <ShowInfoWidget text=\"Chatbot.DELVIS_SAEREIE_LAST_EXTRA_INFO\" />\r\n    </div>\r\n  );\r\n\r\n  static FulltSaereieQuestion = (\r\n    <div>\r\n      <FormattedMessage id=\"Chatbot.FULLT_SAEREIE_QUESTION\" />\r\n      <ShowInfoWidget text=\"Chatbot.FULLT_SAEREIE_EXTRA_INFO\" />\r\n    </div>\r\n  );\r\n\r\n  static UndividedEstateSpouseQuestion = (\r\n    <div>\r\n      <FormattedMessage id=\"Chatbot.UNDIVIDED_SPOUSE_QUESTION\" />\r\n    </div>\r\n  );\r\n\r\n  static TextBeforeSucsrUndvdSpouse = (\r\n    <div>\r\n      <FormattedMessage id=\"Chatbot.TextBeforeSucsrUndvdSpouse\" />\r\n    </div>\r\n  );\r\n\r\n  // UndividedEstateEnd\r\n  static addSuccessorCount = (person_id: string): ReactElement => {\r\n    return (\r\n      <div>\r\n        <FormattedMessage\r\n          id=\"Chatbot.addSuccessorCount\"\r\n          values={{ person_ID: <strong>{person_id}</strong> }}\r\n        />\r\n      </div>\r\n    );\r\n  };\r\n\r\n  static undividedChildrenTogetherCount = (): ReactElement => {\r\n    return <div>How many children do they have together?</div>;\r\n  };\r\n\r\n  static addSuccessorOfParentCount = (\r\n    person_id: string,\r\n    existing_child_id: ReactElement\r\n  ): ReactElement => {\r\n    return (\r\n      <div>\r\n        <FormattedMessage\r\n          id=\"Chatbot.addSuccessorCountExistingParent\"\r\n          values={{\r\n            person_ID: <strong>{person_id}</strong>,\r\n            existing_child_ID: <strong>{existing_child_id}</strong>,\r\n          }}\r\n        />\r\n      </div>\r\n    );\r\n  };\r\n}\r\n\r\nexport default QuestionConstants;\r\n","export default class InheritanceConstants {\r\n  static DESC_COHABITANT_WITHOUT_COMMON_CHILD =\r\n    \"Arvelater har ikke felles barn med samboer og vedkommende har ikke krav p arv (MED MINDRE DE VENTER FELLES BARN!).\";\r\n  static DESC_NO_SPOUSE_OR_COHABITANT =\r\n    \"Arvelater etterlater hverken ektefelle eller samboer.\";\r\n  static DESC_COHABITANT_NO_CLOSE_RELATIVES_2 =\r\n    \"Arvelaters nrmeste gjenlevende slektning er i tredje arvegangsklasse, men etterkommer av barnebarn av arvelaters besteforeldre. Hele arven gr da til gjenlevende samboer med felles barn.\";\r\n  static DESC_COHABITANT_NO_CLOSE_RELATIVES =\r\n    \"Arvelater har ingen gjenlevende slektninger i de tre frste arvegangsklassene. Hele arven gr da til gjenlevende samboer med felles barn.\";\r\n  static DESC_SPOUSE_NO_CLOSE_RELATIVES_2 =\r\n    \"Arvelaters nrmeste gjenlevende slektning er i andre arvegangsklasse, men etterkommer av barnebarn av arvelaters besteforeldre. Hele arven gr da til gjenlevende ektefellep.\";\r\n  static DESC_SPOUSE_NO_CLOSE_RELATIVES =\r\n    \"Arvelater har ingen gjenlevende slektninger i de to frste arvegangsklassene. Hele arven gr da til gjenlevende ektefelle.\";\r\n\r\n  static G = 101351;\r\n  static MINIMUM_INHERITANCE_SPOUSE_VS_CHILDREN = 4 * this.G;\r\n  static FRACTION_INHERITANCE_SPOUSE_VS_CHILDREN = 1 / 4;\r\n  static MINIMUM_INHERITANCE_SPOUSE_VS_PARENTS = 6 * this.G;\r\n  static FRACTION_INHERITANCE_SPOUSE_VS_PARENTS = 1 / 2;\r\n  static MINIMUM_INHERITANCE_COHABITANT_VS_CHILDREN = 4 * this.G;\r\n  static FRACTION_INHERITANCE_COHABITANT_VS_CHILDREN = 0;\r\n  static MINIMUM_INHERITANCE_COHABITANT_VS_PARENTS = 4 * this.G;\r\n  static FRACTION_INHERITANCE_COHABITANT_VS_PARENTS = 0;\r\n  static FRACTION_PLIKTDEL = 2 / 3;\r\n  static LINE_MAXIMUM_PLIKTDEL = 15 * this.G;\r\n\r\n  static LAW_LINKS = {\r\n    \"4\": [\r\n      \"https://lovdata.no/dokument/NL/lov/2019-06-14-21/KAPITTEL_2-1#%C2%A74\",\r\n      \"https://lovdata.no/NL/lov/2019-06-14-21/4\",\r\n    ],\r\n    \"5\": [\r\n      \"https://lovdata.no/dokument/NL/lov/2019-06-14-21/KAPITTEL_2-1#%C2%A75\",\r\n      \"https://lovdata.no/NL/lov/2019-06-14-21/5\",\r\n    ],\r\n    \"6\": [\r\n      \"https://lovdata.no/dokument/NL/lov/2019-06-14-21/KAPITTEL_2-1#%C2%A76\",\r\n      \"https://lovdata.no/NL/lov/2019-06-14-21/6\",\r\n    ],\r\n    \"7\": [\r\n      \"https://lovdata.no/dokument/NL/lov/2019-06-14-21/KAPITTEL_2-1#%C2%A77\",\r\n      \"https://lovdata.no/NL/lov/2019-06-14-21/7\",\r\n    ],\r\n    \"8\": [\r\n      \"https://lovdata.no/dokument/NL/lov/2019-06-14-21/KAPITTEL_2-2#%C2%A78\",\r\n      \"https://lovdata.no/NL/lov/2019-06-14-21/8\",\r\n    ],\r\n    \"9\": [\r\n      \"https://lovdata.no/dokument/NL/lov/2019-06-14-21/KAPITTEL_2-2#%C2%A79\",\r\n      \"https://lovdata.no/NL/lov/2019-06-14-21/9\",\r\n    ],\r\n    \"10\": [\r\n      \"https://lovdata.no/dokument/NL/lov/2019-06-14-21/KAPITTEL_2-2#%C2%A710\",\r\n      \"https://lovdata.no/NL/lov/2019-06-14-21/10\",\r\n    ],\r\n    \"12\": [\r\n      \"https://lovdata.no/dokument/NL/lov/2019-06-14-21/KAPITTEL_2-3#%C2%A712\",\r\n      \"https://lovdata.no/NL/lov/2019-06-14-21/12\",\r\n    ],\r\n    \"50\": [\r\n      \"https://lovdata.no/dokument/NL/lov/2019-06-14-21/KAPITTEL_2-6-3#%C2%A750\",\r\n      \"https://lovdata.no/NL/lov/2019-06-14-21/50\",\r\n    ],\r\n    \"75\": [\r\n      \"https://lovdata.no/dokument/NL/lov/2019-06-14-21/KAPITTEL_2-8#%C2%A775\",\r\n      \"https://lovdata.no/NL/lov/2019-06-14-21/75\",\r\n    ],\r\n    \"76\": [\r\n      \"https://lovdata.no/dokument/NL/lov/2019-06-14-21/KAPITTEL_2-9#%C2%A776\",\r\n      \"https://lovdata.no/NL/lov/2019-06-14-21/76\",\r\n    ],\r\n  };\r\n\r\n  static CODE_PARAGRAPHS = {\r\n    \"4 frste og annet ledd\":\r\n      \"De nrmeste slektsarvingene er arvelaterens livsarvinger.\\n\\nArven deles likt mellom arvelaterens barn, om ikke noe annet flger av srskilte lovregler. Hvis et barn er dd, gr dette barnets del av arven til barnets livsarvinger med lik andel p hver gren. P samme mte arver fjernere livsarvinger. Hvis et barn er dd og ikke etterlater seg livsarvinger, gr dette barnets del av arven til de andre barna eller deres livsarvinger med lik andel p hver gren.\",\r\n    \"5 frste, andre og tredje ledd\":\r\n      \"Hvis arvelateren ikke har livsarvinger, gr arven til foreldrene.\\n\\nForeldrene arver likt. Hvis en forelder er dd, gr denne forelderens del av arven til hans eller hennes livsarvinger med lik andel p hver gren.\\n\\nHvis den ene av foreldrene er dd uten  etterlate seg livsarvinger, gr hele arven til den andre forelderen eller til hans eller hennes livsarvinger med lik andel p hver gren. Dr arvelateren fr fylte 25 r, gr likevel halvparten av arven til besteforeldrene p den dde forelderens side eller til deres livsarvinger i samsvar med  6 dersom foreldrene verken var gift eller samboende med hverandre da den frste dde, eller det forel omstendigheter som nevnt i  11. Er heller ingen slike arvinger i live, gjelder reglene i frste punktum.\",\r\n    \"6 frste og annet ledd\":\r\n      \"Hvis arvelateren ikke har slektsarvinger som nevnt i  4 og 5, gr arven til besteforeldrene eller til livsarvinger etter dem, slik at reglene i  5 annet ledd gjelder tilsvarende. Fjernere livsarvinger etter besteforeldrene enn deres barnebarn har likevel ikke arverett etter loven.\\n\\nHvis en av besteforeldrene er dd, og ingen barn eller barnebarn er i live, gr arven som ellers ville ha tilkommet ham eller henne, til den andre av besteforeldrene p samme side eller til dennes barn eller barnebarn. Hvis det ikke er arvinger p den ene siden, gr hele arven til arvingene p den andre siden.\",\r\n    \"6 frste ledd, andre punktum\":\r\n      \"Fjernere livsarvinger etter besteforeldrene enn deres barnebarn har likevel ikke arverett etter loven.\",\r\n    \"7\": \"Arverett etter dette kapitlet gjelder bare foreldreskap som flger av reglene i barneloven, adopsjonsloven eller annen lov.\\n\\nFaren og farens slekt tar ikke arv etter barnet dersom det er unnfanget som flge av en handling som er et brudd p en bestemmelse i straffeloven  291, 294, 295, 296, 299, 302, 312 eller 314, og som faren er dmt for. Frste punktum gjelder ogs hvis dommen gr ut p at faren ikke kan straffes p grunn av vilkrene i straffeloven  20.\",\r\n    \"8 frste ledd\":\r\n      \"Ektefellen har rett til en firedel av arven nr det er livsarvinger etter arvelateren, men ektefellen har uansett rett til en minstearv p fire ganger folketrygdens grunnbelp ved arvefallet.\",\r\n    \"9 frste ledd\":\r\n      \"Ektefellen har rett til halvparten av arven nr arvelaterens nrmeste slektsarvinger er foreldrene eller deres etterkommere, men ektefellen har uansett rett til en minstearv p seks ganger folketrygdens grunnbelp ved arvefallet.\",\r\n    \"9 annet ledd\":\r\n      \"Ektefellen arver alt nr det verken er livsarvinger eller slektsarvinger som nevnt i frste ledd etter arvelateren.\",\r\n    \"10 annet ledd\":\r\n      \"Et belp tilsvarende seks ganger folketrygdens grunnbelp ved arvefallet kan ikke fratas ektefellen ved testament. Etterlater arvelateren seg livsarvinger, er belpsgrensen etter frste punktum fire ganger folketrygdens grunnbelp.\",\r\n    \"12 frste ledd\":\r\n      \"Den som var samboer med arvelateren ved ddsfallet og har, har hatt eller venter barn med arvelateren, har rett til en arv p fire ganger folketrygdens grunnbelp ved arvefallet. Dette gjelder ogs om det er livsarvinger etter arvelateren.  8 annet ledd gjelder tilsvarende\",\r\n    \"50 frste ledd\":\r\n      \"To tredeler av formuen etter arvelateren er pliktdelsarv for livsarvingene. Pliktdelsarven er likevel aldri strre enn 15 ganger folketrygdens grunnbelp ved arvefallet til hvert av arvelaterens barn eller hvert barns linje.\",\r\n    \"75 frste ledd\":\r\n      \"Har en livsarving mottatt en ytelse av konomisk verdi fra arvelateren, skal ytelsen avkortes i livsarvingens arv hvis dette var satt som en betingelse for ytelsen. En betingelse om avkorting br vre skriftlig og gjort kjent for de andre livsarvingene.\",\r\n    \"76 frste ledd, frste punktum\":\r\n      \"Hvis den avdde ikke har arvinger etter loven eller etter testament, skal nettoformuen g til frivillig virksomhet til fordel for barn og unge.\",\r\n  };\r\n}\r\n","import ActionProvider from '../ChatbotComponent/ActionProvider';\r\nimport { ChatbotInterface } from '../ChatbotComponent/Generics';\r\nimport Person from '../ChatbotComponent/Helper/Classes/Person';\r\n\r\nimport _ from 'lodash';\r\nimport { inheritanceFractionType } from './ReportCalculationBase';\r\nimport {\r\n    getNode,\r\n    getPerson,\r\n    get_class_and_distance_closest_surviving_relative,\r\n} from '../ChatbotComponent/ActionProviderMethods/OtherChatbotMethods';\r\n\r\nconst manipulateDuplicatedMapArray = (\r\n    duplicatedMapArray: Array<inheritanceFractionType>,\r\n) => {\r\n    const personValue = duplicatedMapArray[0].person;\r\n    const fracSum = duplicatedMapArray.reduce((accumulator, item) => {\r\n        return accumulator + item.frac;\r\n    }, 0);\r\n    const chainsValue = duplicatedMapArray.reduce((arr: any[], curr) => {\r\n        arr.push(curr.chains);\r\n        return arr;\r\n    }, []);\r\n\r\n    return {\r\n        person: personValue,\r\n        frac: fracSum,\r\n        chains: chainsValue,\r\n    };\r\n};\r\n\r\nexport const combine_duplicates = (\r\n    inheritance_fraction_list: Array<inheritanceFractionType>,\r\n): Array<inheritanceFractionType> => {\r\n    const duplicateArrayPersonMap = new Map<\r\n        string,\r\n        Array<inheritanceFractionType>\r\n    >();\r\n    const combinedArray: Array<inheritanceFractionType> = [];\r\n\r\n    for (const inheritance_fraction of inheritance_fraction_list) {\r\n        if (!duplicateArrayPersonMap.has(inheritance_fraction.person)) {\r\n            duplicateArrayPersonMap.set(inheritance_fraction.person, [\r\n                inheritance_fraction,\r\n            ]);\r\n        } else {\r\n            const tempInheritanceFractionList = duplicateArrayPersonMap.get(\r\n                inheritance_fraction.person,\r\n            );\r\n            tempInheritanceFractionList?.push(inheritance_fraction);\r\n            if (tempInheritanceFractionList !== undefined) {\r\n                duplicateArrayPersonMap.set(\r\n                    inheritance_fraction.person,\r\n                    tempInheritanceFractionList,\r\n                );\r\n            }\r\n        }\r\n    }\r\n\r\n    for (const key of duplicateArrayPersonMap.keys()) {\r\n        const currentValue = duplicateArrayPersonMap.get(key);\r\n        if (currentValue !== undefined) {\r\n            combinedArray.push(manipulateDuplicatedMapArray(currentValue));\r\n        }\r\n    }\r\n    return combinedArray;\r\n};\r\n\r\nexport const split_evenly_between_lines = (\r\n    actionProvider: ActionProvider,\r\n    state: ChatbotInterface,\r\n    person_list: Array<number>,\r\n    maximum_distance: number | undefined = undefined,\r\n    allow_parents = false,\r\n): inheritanceFractionType[] => {\r\n    let split_fraction_list: inheritanceFractionType[] = [];\r\n    if (person_list.length === 0) {\r\n        return split_fraction_list;\r\n    }\r\n\r\n    const split_frac = 1 / person_list.length;\r\n\r\n    for (const person of person_list) {\r\n        const personDetail: Person = getPerson(person, state.personsMap);\r\n        const personNode = getNode(person, state.nodeMap);\r\n        if (personDetail._deceased) {\r\n            if (maximum_distance === 0) {\r\n                // pass\r\n            } else if (\r\n                get_class_and_distance_closest_surviving_relative(\r\n                    personNode,\r\n                    state,\r\n                )[1] !== 1\r\n            ) {\r\n                if (allow_parents) {\r\n                    let temp_list: inheritanceFractionType[] =\r\n                        split_evenly_between_lines(\r\n                            actionProvider,\r\n                            state,\r\n                            personNode._parents,\r\n                        );\r\n                    let level_sum = 0;\r\n                    for (const item of temp_list) {\r\n                        level_sum += item.frac;\r\n                    }\r\n                    const interm_temp_list: inheritanceFractionType[] = [];\r\n                    if (level_sum !== 1) {\r\n                        for (const item of temp_list) {\r\n                            interm_temp_list.push({\r\n                                person: item.person,\r\n                                frac: item.frac / level_sum,\r\n                                chains: item.chains,\r\n                            });\r\n                        }\r\n                        temp_list = interm_temp_list;\r\n                    }\r\n\r\n                    const temp_split_fraction_list: Array<inheritanceFractionType> =\r\n                        [];\r\n                    for (const item of temp_list) {\r\n                        temp_split_fraction_list.push({\r\n                            person: item.person,\r\n                            frac: item.frac * split_frac,\r\n                            chains: item.chains.concat([\r\n                                personDetail._personName,\r\n                            ]),\r\n                        });\r\n                    }\r\n                    split_fraction_list = split_fraction_list.concat(\r\n                        temp_split_fraction_list,\r\n                    );\r\n                } else {\r\n                    return [];\r\n                }\r\n            } else {\r\n                let temp_list = split_evenly_between_lines(\r\n                    actionProvider,\r\n                    state,\r\n                    personNode._children,\r\n                );\r\n                const temp_fraction_list: Array<inheritanceFractionType> = [];\r\n                let level_sum = 0;\r\n                for (const item of temp_list) {\r\n                    level_sum += item.frac;\r\n                }\r\n                if (level_sum !== 1) {\r\n                    temp_list.map((temp_list_item) => {\r\n                        temp_fraction_list.push({\r\n                            person: temp_list_item.person,\r\n                            frac: temp_list_item.frac / level_sum,\r\n                            chains: temp_list_item.chains,\r\n                        });\r\n                    });\r\n                    temp_list = temp_fraction_list;\r\n                }\r\n                const temp_split_fraction_list: Array<inheritanceFractionType> =\r\n                    [];\r\n                temp_list.map((temp_list_item) => {\r\n                    temp_split_fraction_list.push({\r\n                        person: temp_list_item.person,\r\n                        frac: temp_list_item.frac * split_frac,\r\n                        chains: temp_list_item.chains.concat(\r\n                            personDetail._personName,\r\n                        ),\r\n                    });\r\n                });\r\n\r\n                split_fraction_list = split_fraction_list.concat(\r\n                    temp_split_fraction_list,\r\n                );\r\n            }\r\n        } else {\r\n            split_fraction_list.push({\r\n                person: personDetail._personName,\r\n                frac: split_frac,\r\n                chains: [],\r\n            });\r\n        }\r\n    }\r\n    let level_sum = 0;\r\n    for (const item of split_fraction_list) {\r\n        level_sum += item.frac;\r\n    }\r\n\r\n    if (level_sum !== 1) {\r\n        const temp_split_fraction_list: Array<inheritanceFractionType> = [];\r\n        for (const item of split_fraction_list) {\r\n            temp_split_fraction_list.push({\r\n                person: item.person,\r\n                frac: item.frac / level_sum,\r\n                chains: item.chains,\r\n            });\r\n        }\r\n        split_fraction_list = split_fraction_list.concat(\r\n            temp_split_fraction_list,\r\n        );\r\n    }\r\n\r\n    if (_.isEqual(split_fraction_list, [])) return [];\r\n    return split_fraction_list;\r\n};\r\n","import { ChatbotInterface } from \"../ChatbotComponent/Generics\";\r\nimport { NodeEntity } from \"../ChatbotComponent/Helper/Classes/NodeEntity\";\r\nimport Norsk from \"../../../languages/translationNO.json\";\r\nimport { createIntl, createIntlCache } from \"react-intl\";\r\nimport ActionProvider from \"../ChatbotComponent/ActionProvider\";\r\nimport {\r\n  getNode,\r\n  getPerson,\r\n  get_class_and_distance_closest_surviving_relative,\r\n} from \"../ChatbotComponent/ActionProviderMethods/OtherChatbotMethods\";\r\nimport InheritanceConstants from \"../ChatbotComponent/Helper/Methods/InheritanceConstants\";\r\nimport { combine_duplicates, split_evenly_between_lines } from \"./ReportUtils\";\r\nconst cache = createIntlCache();\r\nconst intl = createIntl({ locale: \"nb-NO\", messages: Norsk }, cache);\r\n\r\ninterface InheritanceCalculationInterface {\r\n  state: ChatbotInterface;\r\n  actionProvider: ActionProvider;\r\n  person: NodeEntity;\r\n  survivor: number | null;\r\n  survivor_type: string;\r\n  class_closest: number | undefined;\r\n  distance_closest: number | undefined;\r\n  old_surviving_reference_paragraphs: string;\r\n  surviving_reference_paragraphs: Array<string>;\r\n  minimum_surviving_inheritance: number;\r\n  surviving_fraction: number;\r\n  descriptive_text: string;\r\n  survivor_inheritance_sum: number;\r\n  genealogy_inheritance_sum: number;\r\n  splits_with_chains: Array<inheritanceFractionType>;\r\n  genealogy_inheritance: Array<inheritanceFractionType>;\r\n  inheritanceType: number;\r\n  netWealth: number;\r\n}\r\nexport type inheritanceFractionType = {\r\n  person: string;\r\n  frac: number;\r\n  chains: Array<string>;\r\n};\r\n\r\nexport interface ReportMethods {\r\n  computeInheritance(): void;\r\n  compute_default_genealogy_splits_with_chains(\r\n    person: number\r\n  ): inheritanceFractionType[];\r\n  computeGenealogyInheritance(person_id: number): inheritanceFractionType[];\r\n}\r\n\r\nexport class ReportCalculationBase implements InheritanceCalculationInterface {\r\n  state: ChatbotInterface;\r\n  actionProvider: ActionProvider;\r\n  person: NodeEntity;\r\n  survivor: number | null = null;\r\n  survivor_type = \"\";\r\n  class_closest: number | undefined;\r\n  distance_closest: number | undefined;\r\n  old_surviving_reference_paragraphs = \"\";\r\n  surviving_reference_paragraphs: string[] = [];\r\n  minimum_surviving_inheritance = 0;\r\n  surviving_fraction = 0;\r\n  descriptive_text = \"\";\r\n  survivor_inheritance_sum = 0;\r\n  genealogy_inheritance_sum = 0;\r\n  splits_with_chains: Array<inheritanceFractionType> = [];\r\n  genealogy_inheritance: Array<inheritanceFractionType> = [];\r\n  genealogy_splits: Array<inheritanceFractionType> = [];\r\n  will: undefined;\r\n  inheritanceType: number;\r\n  netWealth: number;\r\n  constructor(\r\n    person: NodeEntity,\r\n    actionProvider: ActionProvider,\r\n    state: ChatbotInterface,\r\n    inheritanceType: number,\r\n    will = undefined\r\n  ) {\r\n    this.state = state;\r\n    this.actionProvider = actionProvider;\r\n    this.person = getNode(person._id, this.state.nodeMap);\r\n    this.will = will;\r\n    this.inheritanceType = inheritanceType;\r\n    this.netWealth = state.netWealth;\r\n  }\r\n\r\n  initializeInheritance = () => {\r\n    if (this.person === undefined) {\r\n      return;\r\n    }\r\n    console.log(\"Computing inheritances\");\r\n    this.initializeInheritanceVariablesCommon();\r\n  };\r\n\r\n  initializePliktInheritance = () => {\r\n    console.log(\"Computing pliktdelsarv\");\r\n\r\n    [this.class_closest, this.distance_closest] =\r\n      get_class_and_distance_closest_surviving_relative(\r\n        this.state.testator,\r\n        this.state\r\n      );\r\n\r\n    if (this.person.has_surviving_spouse()) {\r\n      this.survivor = this.person._spouse;\r\n      this.survivor_type = intl.formatMessage({\r\n        id: \"REPORT.Inheritance.survivorType1\",\r\n      });\r\n\r\n      this.surviving_reference_paragraphs.push(\r\n        intl.formatMessage({\r\n          id: \"REPORT.Inheritance.surviving_reference_paragraphs_10annet\",\r\n        })\r\n      );\r\n      this.minimum_surviving_inheritance =\r\n        InheritanceConstants.MINIMUM_INHERITANCE_SPOUSE_VS_CHILDREN;\r\n      if (this.class_closest === 1) {\r\n        this.descriptive_text = intl.formatMessage({\r\n          id: \"REPORT.Inheritance.DescriptiveTest_firstClass_spouse_4G\",\r\n        });\r\n      } else {\r\n        this.descriptive_text = intl.formatMessage({\r\n          id: \"REPORT.Inheritance.DescriptiveTest_firstClass_spouse_6G\",\r\n        });\r\n      }\r\n    } else {\r\n      this.survivor = null;\r\n      this.surviving_reference_paragraphs = [];\r\n      this.descriptive_text = InheritanceConstants.DESC_NO_SPOUSE_OR_COHABITANT;\r\n      this.minimum_surviving_inheritance = 0;\r\n    }\r\n  };\r\n\r\n  initializeUndividedInheritance = () => {\r\n    console.log(\"Computing undivided estate inheritances\");\r\n\r\n    this.initializeInheritanceVariablesCommon();\r\n  };\r\n\r\n  computeMethod = (inheritanceOption: number) => {\r\n    switch (inheritanceOption) {\r\n      case 1:\r\n        this.initializeInheritance();\r\n        break;\r\n      case 2:\r\n        this.initializePliktInheritance();\r\n        break;\r\n      case 3:\r\n        this.initializeUndividedInheritance();\r\n        break;\r\n      default:\r\n        console.log(\"check error\");\r\n    }\r\n  };\r\n\r\n  initializeInheritanceVariablesCommon = () => {\r\n    [this.class_closest, this.distance_closest] =\r\n      get_class_and_distance_closest_surviving_relative(\r\n        this.state.testator,\r\n        this.state\r\n      );\r\n    if (this.person.has_surviving_spouse()) {\r\n      this.survivor = this.person._spouse;\r\n      this.survivor_type = intl.formatMessage({\r\n        id: \"REPORT.Inheritance.survivorType1\",\r\n      });\r\n\r\n      if (this.class_closest === undefined || this.class_closest > 2) {\r\n        this.old_surviving_reference_paragraphs = intl.formatMessage({\r\n          id: \"REPORT.Inheritance.old_surviving_reference_paragraphs_6forste\",\r\n        });\r\n        this.surviving_reference_paragraphs.push(\r\n          intl.formatMessage({\r\n            id: \"REPORT.Inheritance.surviving_reference_paragraphs_9annet\",\r\n          })\r\n        );\r\n        this.minimum_surviving_inheritance = 0;\r\n        this.surviving_fraction = 1;\r\n        this.descriptive_text = intl.formatMessage({\r\n          id: \"REPORT.Inheritance.DESC_SPOUSE_NO_CLOSE_RELATIVES\",\r\n        });\r\n      } else if (this.class_closest === 1) {\r\n        this.old_surviving_reference_paragraphs = intl.formatMessage({\r\n          id: \"REPORT.Inheritance.old_surviving_reference_paragraphs_6forste\",\r\n        });\r\n        this.surviving_reference_paragraphs.push(\r\n          intl.formatMessage({\r\n            id: \"REPORT.Inheritance.old_surviving_reference_paragraphs_8forste\",\r\n          })\r\n        );\r\n        this.minimum_surviving_inheritance =\r\n          InheritanceConstants.MINIMUM_INHERITANCE_SPOUSE_VS_CHILDREN;\r\n        this.surviving_fraction =\r\n          InheritanceConstants.FRACTION_INHERITANCE_SPOUSE_VS_CHILDREN;\r\n        this.descriptive_text = intl.formatMessage({\r\n          id: \"REPORT.Inheritance.DescriptiveText4G\",\r\n        });\r\n      } else if (this.class_closest === 2) {\r\n        this.old_surviving_reference_paragraphs = intl.formatMessage({\r\n          id: \"REPORT.Inheritance.old_surviving_reference_paragraphs_6forste\",\r\n        });\r\n        this.surviving_reference_paragraphs.push(\r\n          intl.formatMessage({\r\n            id: \"REPORT.Inheritance.old_surviving_reference_paragraphs_9forste\",\r\n          })\r\n        );\r\n        this.minimum_surviving_inheritance =\r\n          InheritanceConstants.MINIMUM_INHERITANCE_SPOUSE_VS_PARENTS;\r\n        this.surviving_fraction =\r\n          InheritanceConstants.FRACTION_INHERITANCE_SPOUSE_VS_PARENTS;\r\n        this.descriptive_text = intl.formatMessage({\r\n          id: \"REPORT.Inheritance.DescriptiveText6G\",\r\n        });\r\n      }\r\n    } else if (this.person.has_surviving_cohabitant()) {\r\n      this.survivor = this.person._cohabitant;\r\n      this.survivor_type = intl.formatMessage({\r\n        id: \"Report.Inheritance.survivorType2\",\r\n      });\r\n\r\n      if (this.class_closest === undefined || this.class_closest > 3) {\r\n        this.old_surviving_reference_paragraphs = intl.formatMessage({\r\n          id: \"REPORT.Inheritance.old_surviving_reference_paragraphs_28Bforste\",\r\n        });\r\n        this.surviving_reference_paragraphs.push(\r\n          intl.formatMessage({\r\n            id: \"REPORT.Inheritance.old_surviving_reference_paragraphs_12forste\",\r\n          })\r\n        );\r\n        this.minimum_surviving_inheritance = 0;\r\n        this.surviving_fraction = 1;\r\n        this.descriptive_text = intl.formatMessage({\r\n          id: \"REPORT.Inheritance.DESC_COHABITANT_NO_CLOSE_RELATIVES\",\r\n        });\r\n      } else if (this.class_closest === 1) {\r\n        this.old_surviving_reference_paragraphs = intl.formatMessage({\r\n          id: \"REPORT.Inheritance.old_surviving_reference_paragraphs_28Bforste\",\r\n        });\r\n        this.surviving_reference_paragraphs.push(\r\n          intl.formatMessage({\r\n            id: \"REPORT.Inheritance.old_surviving_reference_paragraphs_12forste\",\r\n          })\r\n        );\r\n        this.minimum_surviving_inheritance =\r\n          InheritanceConstants.MINIMUM_INHERITANCE_COHABITANT_VS_CHILDREN;\r\n        this.surviving_fraction =\r\n          InheritanceConstants.FRACTION_INHERITANCE_COHABITANT_VS_CHILDREN;\r\n        this.descriptive_text = intl.formatMessage({\r\n          id: \"REPORT.Inheritance.DescriptiveText_firstClass_cohab_4G\",\r\n        });\r\n      } else if (this.class_closest === 2) {\r\n        this.old_surviving_reference_paragraphs = intl.formatMessage({\r\n          id: \"REPORT.Inheritance.old_surviving_reference_paragraphs_28Bforste\",\r\n        });\r\n        this.surviving_reference_paragraphs.push(\r\n          intl.formatMessage({\r\n            id: \"REPORT.Inheritance.old_surviving_reference_paragraphs_12forste\",\r\n          })\r\n        );\r\n        this.minimum_surviving_inheritance =\r\n          InheritanceConstants.MINIMUM_INHERITANCE_COHABITANT_VS_PARENTS;\r\n        this.surviving_fraction =\r\n          InheritanceConstants.FRACTION_INHERITANCE_COHABITANT_VS_PARENTS;\r\n        this.descriptive_text = intl.formatMessage({\r\n          id: \"REPORT.Inheritance.DescriptiveText_secondClass_cohab_4G\",\r\n        });\r\n      } else if (this.class_closest === 3) {\r\n        if (this.distance_closest && this.distance_closest <= 2) {\r\n          this.old_surviving_reference_paragraphs = intl.formatMessage({\r\n            id: \"REPORT.Inheritance.old_surviving_reference_paragraphs_28Bforste\",\r\n          });\r\n          this.surviving_reference_paragraphs.push(\r\n            intl.formatMessage({\r\n              id: \"REPORT.Inheritance.old_surviving_reference_paragraphs_12forste\",\r\n            })\r\n          );\r\n          this.minimum_surviving_inheritance = 4 * InheritanceConstants.G;\r\n          this.surviving_fraction = 0;\r\n          this.descriptive_text = intl.formatMessage({\r\n            id: \"REPORT.Inheritance.DescriptiveText_thirdClass_cohab_4G\",\r\n          });\r\n        } else {\r\n          this.old_surviving_reference_paragraphs = intl.formatMessage({\r\n            id: \"REPORT.Inheritance.old_surviving_reference_paragraphs_28Bforste\",\r\n          });\r\n          this.surviving_reference_paragraphs.push(\r\n            intl.formatMessage({\r\n              id: \"REPORT.Inheritance.old_surviving_reference_paragraphs_12forste\",\r\n            })\r\n          );\r\n          this.minimum_surviving_inheritance = 0;\r\n          this.surviving_fraction = 1;\r\n          this.descriptive_text = intl.formatMessage({\r\n            id: \"REPORT.Inheritance.DESC_COHABITANT_NO_CLOSE_RELATIVES_2\",\r\n          });\r\n        }\r\n      }\r\n    } else {\r\n      this.survivor = null;\r\n      this.surviving_reference_paragraphs = [];\r\n      this.minimum_surviving_inheritance = 0;\r\n      this.surviving_fraction = 0;\r\n      this.descriptive_text = intl.formatMessage({\r\n        id: \"REPORT.Inheritance.DESC_NO_SPOUSE_OR_COHABITANT\",\r\n      });\r\n    }\r\n  };\r\n\r\n  computeGenealogyInheritance = (\r\n    person_id: number,\r\n    state: ChatbotInterface\r\n  ) => {\r\n    this.survivor_inheritance_sum = Math.min(\r\n      this.state.netWealth,\r\n      Math.max(\r\n        this.minimum_surviving_inheritance,\r\n        this.surviving_fraction * this.state.netWealth\r\n      )\r\n    );\r\n    this.genealogy_inheritance_sum =\r\n      this.state.netWealth - this.survivor_inheritance_sum;\r\n    if (this.genealogy_inheritance_sum !== 0) {\r\n      this.splits_with_chains =\r\n        this.compute_default_genealogy_splits_with_chains(\r\n          person_id,\r\n          this.actionProvider,\r\n          state\r\n        );\r\n      this.genealogy_splits = combine_duplicates(this.splits_with_chains);\r\n\r\n      this.genealogy_splits.map((genealogy_split: inheritanceFractionType) => {\r\n        return this.genealogy_inheritance.push({\r\n          person: genealogy_split.person,\r\n          frac: genealogy_split.frac * this.genealogy_inheritance_sum,\r\n          chains: genealogy_split.chains,\r\n        });\r\n      });\r\n    } else {\r\n      this.splits_with_chains = [];\r\n      this.genealogy_splits = [];\r\n      this.genealogy_inheritance = [];\r\n    }\r\n    return this.genealogy_inheritance;\r\n  };\r\n\r\n  computeGenealogyPliktInheritance = (\r\n    person_id: number,\r\n    state: ChatbotInterface\r\n  ) => {\r\n    this.survivor_inheritance_sum = Math.min(\r\n      this.netWealth,\r\n      this.minimum_surviving_inheritance\r\n    );\r\n\r\n    this.genealogy_inheritance_sum = Math.min(\r\n      this.netWealth - this.survivor_inheritance_sum,\r\n      this.netWealth * InheritanceConstants.FRACTION_PLIKTDEL,\r\n      InheritanceConstants.LINE_MAXIMUM_PLIKTDEL * this.person._children.length\r\n    );\r\n\r\n    if (this.genealogy_inheritance_sum !== 0) {\r\n      this.splits_with_chains =\r\n        this.compute_default_genealogy_splits_with_chains(\r\n          person_id,\r\n          this.actionProvider,\r\n          state\r\n        );\r\n      this.genealogy_splits = combine_duplicates(this.splits_with_chains);\r\n\r\n      this.genealogy_splits.map((genealogy_split: inheritanceFractionType) => {\r\n        return this.genealogy_inheritance.push({\r\n          person: genealogy_split.person,\r\n          frac: genealogy_split.frac * this.genealogy_inheritance_sum,\r\n          chains: genealogy_split.chains,\r\n        });\r\n      });\r\n    }\r\n  };\r\n\r\n  compute_default_genealogy_splits_with_chains = (\r\n    person: number,\r\n    actionProvider: ActionProvider,\r\n    state: ChatbotInterface\r\n  ): Array<inheritanceFractionType> => {\r\n    const personNode = getNode(person, state.nodeMap);\r\n    const personObject = getPerson(person, state.personsMap);\r\n    const class_closest = get_class_and_distance_closest_surviving_relative(\r\n      personNode,\r\n      state\r\n    )[0];\r\n    if (class_closest === 1) {\r\n      return split_evenly_between_lines(\r\n        actionProvider,\r\n        state,\r\n        personNode._children\r\n      );\r\n    } else if (class_closest === 2) {\r\n      const firstParentSpouse = getNode(\r\n        personNode._parents[0],\r\n        state.nodeMap\r\n      )._spouse;\r\n      if (\r\n        !personObject._underAge ||\r\n        firstParentSpouse === personNode._parents[1]\r\n      ) {\r\n        return split_evenly_between_lines(\r\n          actionProvider,\r\n          state,\r\n          personNode._parents\r\n        );\r\n      } else {\r\n        return split_evenly_between_lines(\r\n          actionProvider,\r\n          state,\r\n          personNode._parents,\r\n          undefined,\r\n          true\r\n        );\r\n      }\r\n    } else if (class_closest === 3) {\r\n      const grandParent_splits = split_evenly_between_lines(\r\n        actionProvider,\r\n        state,\r\n        personNode._parents,\r\n        2\r\n      );\r\n      let num = 0;\r\n      for (const splits of grandParent_splits) {\r\n        if (splits) {\r\n          num = num + 1;\r\n        }\r\n      }\r\n      const resultGrandParentSplit: Array<inheritanceFractionType> = [];\r\n      grandParent_splits.map((grandParent_split) => {\r\n        resultGrandParentSplit.push({\r\n          person: grandParent_split.person,\r\n          frac: grandParent_split.frac / num,\r\n          chains: grandParent_split.chains,\r\n        });\r\n      });\r\n      return resultGrandParentSplit;\r\n    } else if (class_closest === undefined || class_closest > 3) return [];\r\n    else return [];\r\n  };\r\n}\r\n","import { ChatbotInterface } from \"../ChatbotComponent/Generics\";\r\nimport { NodeEntity } from \"../ChatbotComponent/Helper/Classes/NodeEntity\";\r\nimport Norsk from \"../../../languages/translationNO.json\";\r\nimport { createIntl, createIntlCache } from \"react-intl\";\r\nimport ActionProvider from \"../ChatbotComponent/ActionProvider\";\r\nimport { ReportCalculationBase } from \"./ReportCalculationBase\";\r\nimport { getNode } from \"../ChatbotComponent/ActionProviderMethods/OtherChatbotMethods\";\r\nconst cache = createIntlCache();\r\nconst intl = createIntl({ locale: \"nb-NO\", messages: Norsk }, cache);\r\n\r\nexport class InheritanceCalculation extends ReportCalculationBase {\r\n  state: ChatbotInterface;\r\n  actionProvider: ActionProvider;\r\n  person: NodeEntity;\r\n  will: undefined;\r\n  constructor(\r\n    person: NodeEntity,\r\n    actionProvider: ActionProvider,\r\n    state: ChatbotInterface,\r\n    will = undefined\r\n  ) {\r\n    super(person, actionProvider, state, 1, will);\r\n    this.state = state;\r\n    this.actionProvider = actionProvider;\r\n    this.person = getNode(person._id, this.state.nodeMap);\r\n    this.will = will;\r\n  }\r\n\r\n  // computeInheritance = () => {\r\n  //   [this.class_closest, this.distance_closest] =\r\n  //     get_class_and_distance_closest_surviving_relative(\r\n  //       this.state.testator,\r\n  //       this.state\r\n  //     );\r\n\r\n  //   if (this.person.has_surviving_spouse()) {\r\n  //     // TODO define has_surviving_spouse in NodeEntity.ts\r\n  //     this.survivor = this.person._spouse;\r\n  //     this.survivor_type = intl.formatMessage({\r\n  //       id: \"REPORT.Inheritance.survivorType1\",\r\n  //     });\r\n\r\n  //     if (this.class_closest === undefined || this.class_closest > 2) {\r\n  //       this.old_surviving_reference_paragraphs = intl.formatMessage({\r\n  //         id: \"REPORT.Inheritance.old_surviving_reference_paragraphs_6forste\",\r\n  //       });\r\n  //       this.surviving_reference_paragraphs.push(\r\n  //         intl.formatMessage({\r\n  //           id: \"REPORT.Inheritance.surviving_reference_paragraphs_9annet\",\r\n  //         })\r\n  //       );\r\n  //       this.minimum_surviving_inheritance = 0;\r\n  //       this.surviving_fraction = 1;\r\n  //       this.descriptive_text = intl.formatMessage({\r\n  //         id: \"REPORT.Inheritance.DESC_SPOUSE_NO_CLOSE_RELATIVES\",\r\n  //       });\r\n  //     } else if (this.class_closest === 1) {\r\n  //       this.old_surviving_reference_paragraphs = intl.formatMessage({\r\n  //         id: \"REPORT.Inheritance.old_surviving_reference_paragraphs_6forste\",\r\n  //       });\r\n  //       this.surviving_reference_paragraphs.push(\r\n  //         intl.formatMessage({\r\n  //           id: \"REPORT.Inheritance.old_surviving_reference_paragraphs_8forste\",\r\n  //         })\r\n  //       );\r\n  //       this.minimum_surviving_inheritance =\r\n  //         InheritanceConstants.MINIMUM_INHERITANCE_SPOUSE_VS_CHILDREN;\r\n  //       this.surviving_fraction =\r\n  //         InheritanceConstants.FRACTION_INHERITANCE_SPOUSE_VS_CHILDREN;\r\n  //       this.descriptive_text = intl.formatMessage({\r\n  //         id: \"REPORT.Inheritance.DescriptiveText4G\",\r\n  //       });\r\n  //     } else if (this.class_closest === 2) {\r\n  //       this.old_surviving_reference_paragraphs = intl.formatMessage({\r\n  //         id: \"REPORT.Inheritance.old_surviving_reference_paragraphs_6forste\",\r\n  //       });\r\n  //       this.surviving_reference_paragraphs.push(\r\n  //         intl.formatMessage({\r\n  //           id: \"REPORT.Inheritance.old_surviving_reference_paragraphs_9forste\",\r\n  //         })\r\n  //       );\r\n  //       this.minimum_surviving_inheritance =\r\n  //         InheritanceConstants.MINIMUM_INHERITANCE_SPOUSE_VS_PARENTS;\r\n  //       this.surviving_fraction =\r\n  //         InheritanceConstants.FRACTION_INHERITANCE_SPOUSE_VS_PARENTS;\r\n  //       this.descriptive_text = intl.formatMessage({\r\n  //         id: \"REPORT.Inheritance.DescriptiveText6G\",\r\n  //       });\r\n  //     }\r\n  //   } else if (this.person.has_surviving_cohabitant()) {\r\n  //     this.survivor = this.person._cohabitant;\r\n  //     this.survivor_type = intl.formatMessage({\r\n  //       id: \"Report.Inheritance.survivorType2\",\r\n  //     });\r\n\r\n  //     if (this.class_closest === undefined || this.class_closest > 3) {\r\n  //       this.old_surviving_reference_paragraphs = intl.formatMessage({\r\n  //         id: \"REPORT.Inheritance.old_surviving_reference_paragraphs_28Bforste\",\r\n  //       });\r\n  //       this.surviving_reference_paragraphs.push(\r\n  //         intl.formatMessage({\r\n  //           id: \"REPORT.Inheritance.old_surviving_reference_paragraphs_12forste\",\r\n  //         })\r\n  //       );\r\n  //       this.minimum_surviving_inheritance = 0;\r\n  //       this.surviving_fraction = 1;\r\n  //       this.descriptive_text = intl.formatMessage({\r\n  //         id: \"REPORT.Inheritance.DESC_COHABITANT_NO_CLOSE_RELATIVES\",\r\n  //       });\r\n  //     } else if (this.class_closest === 1) {\r\n  //       this.old_surviving_reference_paragraphs = intl.formatMessage({\r\n  //         id: \"REPORT.Inheritance.old_surviving_reference_paragraphs_28Bforste\",\r\n  //       });\r\n  //       this.surviving_reference_paragraphs.push(\r\n  //         intl.formatMessage({\r\n  //           id: \"REPORT.Inheritance.old_surviving_reference_paragraphs_12forste\",\r\n  //         })\r\n  //       );\r\n  //       this.minimum_surviving_inheritance =\r\n  //         InheritanceConstants.MINIMUM_INHERITANCE_COHABITANT_VS_CHILDREN;\r\n  //       this.surviving_fraction =\r\n  //         InheritanceConstants.FRACTION_INHERITANCE_COHABITANT_VS_CHILDREN;\r\n  //       this.descriptive_text = intl.formatMessage({\r\n  //         id: \"REPORT.Inheritance.DescriptiveText_firstClass_cohab_4G\",\r\n  //       });\r\n  //     } else if (this.class_closest === 2) {\r\n  //       this.old_surviving_reference_paragraphs = intl.formatMessage({\r\n  //         id: \"REPORT.Inheritance.old_surviving_reference_paragraphs_28Bforste\",\r\n  //       });\r\n  //       this.surviving_reference_paragraphs.push(\r\n  //         intl.formatMessage({\r\n  //           id: \"REPORT.Inheritance.old_surviving_reference_paragraphs_12forste\",\r\n  //         })\r\n  //       );\r\n  //       this.minimum_surviving_inheritance =\r\n  //         InheritanceConstants.MINIMUM_INHERITANCE_COHABITANT_VS_PARENTS;\r\n  //       this.surviving_fraction =\r\n  //         InheritanceConstants.FRACTION_INHERITANCE_COHABITANT_VS_PARENTS;\r\n  //       this.descriptive_text = intl.formatMessage({\r\n  //         id: \"REPORT.Inheritance.DescriptiveText_secondClass_cohab_4G\",\r\n  //       });\r\n  //     } else if (this.class_closest === 3) {\r\n  //       if (this.distance_closest && this.distance_closest <= 2) {\r\n  //         this.old_surviving_reference_paragraphs = intl.formatMessage({\r\n  //           id: \"REPORT.Inheritance.old_surviving_reference_paragraphs_28Bforste\",\r\n  //         });\r\n  //         this.surviving_reference_paragraphs.push(\r\n  //           intl.formatMessage({\r\n  //             id: \"REPORT.Inheritance.old_surviving_reference_paragraphs_12forste\",\r\n  //           })\r\n  //         );\r\n  //         this.minimum_surviving_inheritance = 4 * InheritanceConstants.G;\r\n  //         this.surviving_fraction = 0;\r\n  //         this.descriptive_text = intl.formatMessage({\r\n  //           id: \"REPORT.Inheritance.DescriptiveText_thirdClass_cohab_4G\",\r\n  //         });\r\n  //       } else {\r\n  //         this.old_surviving_reference_paragraphs = intl.formatMessage({\r\n  //           id: \"REPORT.Inheritance.old_surviving_reference_paragraphs_28Bforste\",\r\n  //         });\r\n  //         this.surviving_reference_paragraphs.push(\r\n  //           intl.formatMessage({\r\n  //             id: \"REPORT.Inheritance.old_surviving_reference_paragraphs_12forste\",\r\n  //           })\r\n  //         );\r\n  //         this.minimum_surviving_inheritance = 0;\r\n  //         this.surviving_fraction = 1;\r\n  //         this.descriptive_text = intl.formatMessage({\r\n  //           id: \"REPORT.Inheritance.DESC_COHABITANT_NO_CLOSE_RELATIVES_2\",\r\n  //         });\r\n  //       }\r\n  //     }\r\n  //   } else {\r\n  //     this.survivor = null;\r\n  //     this.surviving_reference_paragraphs = [];\r\n  //     this.minimum_surviving_inheritance = 0;\r\n  //     this.surviving_fraction = 0;\r\n  //     this.descriptive_text = intl.formatMessage({\r\n  //       id: \"REPORT.Inheritance.DESC_NO_SPOUSE_OR_COHABITANT\",\r\n  //     });\r\n  //   }\r\n  // };\r\n\r\n  // compute_default_genealogy_splits_with_chains = (person: number) => {\r\n  //   //\r\n  //   const personNode = getNode(person, this.state.nodeMap);\r\n  //   const personDetail = getPerson(person, this.state.personsMap);\r\n  //   const [closest_class, closest_distance] =\r\n  //     get_class_and_distance_closest_surviving_relative(personNode, this.state);\r\n  //   if (closest_class === 1) {\r\n  //     return this.reportUtils.split_evenly_between_lines(personNode._children);\r\n  //   } else if (closest_class === 2) {\r\n  //     const firstParentNode = getNode(\r\n  //       personNode._parents[0],\r\n  //       this.state.nodeMap\r\n  //     );\r\n  //     if (\r\n  //       !personDetail._underAge ||\r\n  //       firstParentNode._spouse === personNode._parents[1]\r\n  //     ) {\r\n  //       return this.reportUtils.split_evenly_between_lines(personNode._parents);\r\n  //     } else\r\n  //       return this.reportUtils.split_evenly_between_lines(\r\n  //         personNode._parents,\r\n  //         undefined,\r\n  //         true\r\n  //       );\r\n  //   } else if (closest_class === 3) {\r\n  //     const grandparent_splits = [];\r\n  //     for (const parent of personNode._parents) {\r\n  //       const parentNode = getNode(parent, this.state.nodeMap);\r\n  //       grandparent_splits.push(\r\n  //         this.reportUtils.split_evenly_between_lines(parentNode._parents, 2)\r\n  //       );\r\n  //     }\r\n  //     const tempArray = [];\r\n  //     for (const a of grandparent_splits) {\r\n  //       if (a.length > 0) {\r\n  //         tempArray.push(a);\r\n  //       }\r\n  //     }\r\n  //     const num = tempArray.length;\r\n\r\n  //     const temp_list = [];\r\n  //     for (const split of grandparent_splits) {\r\n  //       if (split.length > 0) {\r\n  //         temp_list.push([split[0]]);\r\n  //       }\r\n  //     }\r\n  //     const resultList = [];\r\n  //     for (const item of temp_list) {\r\n  //       resultList.push([item[0], item[1] / num, item[2]]);\r\n  //     }\r\n  //     return resultList;\r\n  //   } else if (closest_class === undefined || closest_class > 3) {\r\n  //     return [];\r\n  //   }\r\n  // };\r\n\r\n  // computeGenealogyInheritance = (person_id: number) => {\r\n  //   this.survivor_inheritance_sum = Math.min(\r\n  //     this.state.netWealth,\r\n  //     Math.max(\r\n  //       this.minimum_surviving_inheritance,\r\n  //       this.surviving_fraction * this.state.netWealth\r\n  //     )\r\n  //   );\r\n  //   this.genealogy_inheritance_sum =\r\n  //     this.state.netWealth - this.survivor_inheritance_sum;\r\n  //   if (this.genealogy_inheritance_sum !== 0) {\r\n  //     this.splits_with_chains =\r\n  //       this.compute_default_genealogy_splits_with_chains(person_id);\r\n  //     const genealogy_splits = this.reportUtils.combine_duplicates(\r\n  //       this.splits_with_chains\r\n  //     );\r\n\r\n  //     genealogy_splits.map((genealogy_split: any) => {\r\n  //       return this.genealogy_inheritance.push({\r\n  //         person: genealogy_split.person,\r\n  //         frac: genealogy_split.frac * this.genealogy_inheritance_sum,\r\n  //         chains: genealogy_split.chains,\r\n  //       });\r\n  //     });\r\n  //   } else {\r\n  //     this.splits_with_chains = [];\r\n  //     this.genealogy_splits = splits_initial;\r\n  //     this.genealogy_inheritance = [splits_initial];\r\n  //   }\r\n  //   return this.genealogy_inheritance;\r\n  // };\r\n}\r\n","import { StyleSheet } from \"@react-pdf/renderer\";\r\n\r\nexport const styles = StyleSheet.create({\r\n  page: {\r\n    backgroundColor: \"white\",\r\n    color: \"black\",\r\n    fontFamily: \"Times-Roman\",\r\n    flexDirection: \"column\",\r\n    paddingLeft: 20,\r\n    paddingRight: 20,\r\n    paddingBottom: 30,\r\n  },\r\n  section: {\r\n    margin: 10,\r\n  },\r\n  header: {\r\n    fontSize: 12,\r\n    marginBottom: 20,\r\n    textAlign: \"center\",\r\n    color: \"grey\",\r\n    fontFamily: \"Times-Roman\",\r\n  },\r\n  heading: {\r\n    fontSize: 24,\r\n    color: \"#17365D\",\r\n    marginBottom: 10,\r\n    textDecoration: \"underline\",\r\n  },\r\n  subheading: {\r\n    fontSize: 14,\r\n    color: \"#2979ff\",\r\n    fontFamily: \"Helvetica-Bold\",\r\n  },\r\n  paragraphHeading: {\r\n    fontSize: 12,\r\n    color: \"#365F91\",\r\n    fontFamily: \"Helvetica-Bold\",\r\n  },\r\n  paragraph: {\r\n    fontSize: 10,\r\n    fontFamily: \"Times-Roman\",\r\n    margin: 10,\r\n  },\r\n  pageNumber: {\r\n    position: \"absolute\",\r\n    fontSize: 12,\r\n    bottom: 30,\r\n    left: 0,\r\n    right: 0,\r\n    textAlign: \"center\",\r\n    color: \"grey\",\r\n  },\r\n  boldValue: {\r\n    fontFamily: \"Times-Bold\",\r\n    fontWeight: 600,\r\n  },\r\n  italicValue: {\r\n    fontFamily: \"Times-Italic\",\r\n    fontStyle: \"italic\",\r\n  },\r\n  urlStyle: {\r\n    fontFamily: \"Times-Roman\",\r\n    color: \"#1a0dab\",\r\n  },\r\n  tableHeaderRow: {\r\n    backgroundColor: \"grey\",\r\n    borderWidth: 0,\r\n    fontSize: 12,\r\n    textAlign: \"center\",\r\n  },\r\n  tableDataRow: {\r\n    backgroundColor: \"white\",\r\n    borderWidth: 0,\r\n    fontSize: 10,\r\n    textAlign: \"center\",\r\n  },\r\n  marginTop: {\r\n    marginTop: 10,\r\n  },\r\n  redText: {\r\n    color: \"#ff0000\",\r\n  },\r\n  imageView: {\r\n    backgroundColor: \"white\",\r\n  },\r\n  image: {\r\n    backgroundColor: \"white\",\r\n    marginTop: 20,\r\n  },\r\n});\r\n","import { Text } from \"@react-pdf/renderer\";\r\nimport { styles } from \"../../../styles\";\r\n\r\ntype BoldProps = {\r\n  children: React.ReactNode;\r\n};\r\n\r\nexport const Bold = (props: BoldProps) => (\r\n  <Text style={styles.boldValue}>{props.children}</Text>\r\n);\r\n","import { Text } from \"@react-pdf/renderer\";\r\nimport { styles } from \"../../../styles\";\r\n\r\ntype ItalicProps = {\r\n  children: React.ReactNode;\r\n};\r\n\r\nexport const Italic = (props: ItalicProps) => (\r\n  <Text style={styles.italicValue}>{props.children}</Text>\r\n);\r\n","import { Text, Link } from \"@react-pdf/renderer\";\r\nimport { Bold } from \"./PDF/Sections/common/text-styles/Bold\";\r\nimport { Italic } from \"./PDF/Sections/common/text-styles/Italic\";\r\nimport \"react-pdf/dist/umd/Page/AnnotationLayer.css\";\r\n\r\nexport const currencyFormatNO = (currencyValue: number): string => {\r\n  return Intl.NumberFormat(\"no-NO\", {\r\n    style: \"currency\",\r\n    currency: \"NOK\",\r\n    useGrouping: true,\r\n  })\r\n    .format(currencyValue)\r\n    .replace(\"kr\", \"NOK\")\r\n    .replace(\",\", \".\");\r\n};\r\n\r\nexport const add_legal_references = (\r\n  code_paragraphs: string[],\r\n  CODE_PARAGRAPHS: any,\r\n  LAW_LINKS: any\r\n) => {\r\n  const legalReferenceTextArray: any[] = [];\r\n  code_paragraphs.forEach((code_paragraph) => {\r\n    legalReferenceTextArray.push(\r\n      add_legal_reference(code_paragraph, CODE_PARAGRAPHS, LAW_LINKS)\r\n    );\r\n  });\r\n  return legalReferenceTextArray;\r\n};\r\n\r\nexport const add_legal_reference = (\r\n  code_paragraph: string,\r\n  CODE_PARAGRAPHS: any,\r\n  LAW_LINKS: any\r\n) => {\r\n  const lovdataLink = addLovdataLink(code_paragraph, LAW_LINKS);\r\n  return (\r\n    <Text>\r\n      {\"\\n\\n\"}\r\n      <Bold>Arveloven  {code_paragraph}:</Bold>{\" \"}\r\n      <Italic>{CODE_PARAGRAPHS[code_paragraph]}</Italic>\r\n      {\"\\n\\n\"}\r\n      <Text>{lovdataLink}</Text>\r\n    </Text>\r\n  );\r\n};\r\n\r\nexport const addLovdataLink = (code_paragraph: string, LAW_LINKS: any) => {\r\n  const code_paragraph_code = code_paragraph.replace(/[^\\d].*/, \"\");\r\n  const hyperlinkText = add_hyperlink(LAW_LINKS[code_paragraph_code]);\r\n  return (\r\n    <Text>\r\n      For  lese lovteksten i kontekst hos Lovdata, g til {hyperlinkText}.\r\n    </Text>\r\n  );\r\n};\r\n\r\nconst add_hyperlink = (url_text: [string, string]) => {\r\n  return (\r\n    <Link src={url_text[0]}>\r\n      <Text>{url_text[1]}</Text>\r\n    </Link>\r\n  );\r\n};\r\n\r\nexport const unravel_chain_to_string = (\r\n  chain: Array<string>\r\n): string | null => {\r\n  if (chain.length === 0) {\r\n    return null;\r\n  }\r\n  let s = chain.splice(0, 1)[0];\r\n  chain.map((link) => {\r\n    s = `${s} som er stedfortreder for person med person-id ${link}`;\r\n  });\r\n  return s ? s : \"\";\r\n};\r\n\r\nexport const unravel_chains_to_string = (\r\n  chains: Array<Array<string>>\r\n): string => {\r\n  const chains_unraveled: Array<string> = [];\r\n  for (const chain of chains) {\r\n    const unravelOutput: string | null = unravel_chain_to_string(chain);\r\n    if (unravelOutput !== null && unravelOutput.length !== 0) {\r\n      chains_unraveled.push(unravelOutput);\r\n    }\r\n  }\r\n  const n = chains_unraveled.length;\r\n  let text = \"\";\r\n  if (n === 0) return \"\";\r\n  else if (n === 1) {\r\n    text = ` som stedfortreder for ${chains_unraveled[0]}`;\r\n    return text;\r\n  } else {\r\n    text = \" som stedfortreder for \";\r\n    chains_unraveled.map((ind, unraveled_chain) => {\r\n      if (ind && ind.length === 0) {\r\n        text += `${unraveled_chain}`;\r\n      } else if (ind && ind.length === n - 1) {\r\n        text += ` og som stedfortreder for ${unraveled_chain}`;\r\n      } else {\r\n        text += `, som stedfortreder for ${unraveled_chain}`;\r\n      }\r\n    });\r\n    return text;\r\n  }\r\n};\r\n","import { Text } from '@react-pdf/renderer';\r\nimport { InheritanceCalculation } from '../../../../InheritanceCalculation';\r\nimport {\r\n    currencyFormatNO,\r\n    unravel_chains_to_string,\r\n} from '../../../../pdf_utils';\r\nimport { PliktdelsarvCalculation } from '../../../../PliktdelsarvCalculation';\r\nimport { Bold } from '../text-styles/Bold';\r\n\r\nexport const getGenealogyInheritanceText = (\r\n    value: InheritanceCalculation | PliktdelsarvCalculation,\r\n) => {\r\n    const finalGenealogyInheritanceText = [];\r\n    for (const obj of value.genealogy_inheritance) {\r\n        const id = Math.random().toString(36).substring(7);\r\n        finalGenealogyInheritanceText.push(\r\n            <Text key={id}>\r\n                Person med person-id <Bold>{obj.person}</Bold> arver totalt{' '}\r\n                <Bold>{currencyFormatNO(obj.frac)} </Bold>\r\n                {unravel_chains_to_string([obj.chains])}.{'\\n'}\r\n            </Text>,\r\n        );\r\n    }\r\n    return finalGenealogyInheritanceText;\r\n};\r\n","import { Text, View } from '@react-pdf/renderer';\r\nimport InheritanceConstants from '../../../../../ChatbotComponent/Helper/Methods/InheritanceConstants';\r\nimport { InheritanceCalculation } from '../../../../InheritanceCalculation';\r\nimport { styles } from '../../../styles';\r\nimport { add_legal_reference, currencyFormatNO } from '../../../../pdf_utils';\r\nimport { Bold } from '../text-styles/Bold';\r\nimport { getGenealogyInheritanceText } from './CommonMethods';\r\n\r\nconst GenealogyUtils = (value: InheritanceCalculation) => {\r\n    const genealogy_inheritance_sum = value.genealogy_inheritance_sum;\r\n    const genealogyText = getGenealogyText(genealogy_inheritance_sum, value);\r\n    return (\r\n        <View>\r\n            <Text>{genealogyText}</Text>\r\n        </View>\r\n    );\r\n};\r\n\r\n// add_inheritance_calculation_relatives\r\nconst getGenealogyText = (\r\n    genealogy_inheritance_sum: number,\r\n    value: InheritanceCalculation,\r\n) => {\r\n    if (genealogy_inheritance_sum === 0) {\r\n        return (\r\n            <Text style={styles.paragraph}>\r\n                Det er ingen slektsarv igjen  fordele.\r\n            </Text>\r\n        );\r\n    } else if (\r\n        value.class_closest === undefined ||\r\n        (value.class_closest === 3 &&\r\n            value.distance_closest &&\r\n            value.distance_closest > 2)\r\n    ) {\r\n        let code_paragraph = '6 frste ledd, andre punktum';\r\n        const legalReference1 = add_legal_reference(\r\n            code_paragraph,\r\n            InheritanceConstants.CODE_PARAGRAPHS,\r\n            InheritanceConstants.LAW_LINKS,\r\n        );\r\n\r\n        code_paragraph = '76 frste ledd, frste punktum';\r\n        const legalReference2 = add_legal_reference(\r\n            code_paragraph,\r\n            InheritanceConstants.CODE_PARAGRAPHS,\r\n            InheritanceConstants.LAW_LINKS,\r\n        );\r\n        return (\r\n            <Text>\r\n                <Text style={styles.paragraph}>\r\n                    \"Testator har ingen nre slektninger.\"\r\n                </Text>\r\n                <Text style={styles.paragraph}>{legalReference1}</Text>\r\n                <View>\r\n                    <Text style={styles.subheading}>Frivillig arbeid</Text>\r\n                    <Bold>\r\n                        {currencyFormatNO(value.genealogy_inheritance_sum)}\r\n                    </Bold>\r\n                    <Text style={styles.paragraph}>\r\n                        {' '}\r\n                        vil g til frivillig arbeid til fordel for barn og unge.\r\n                    </Text>\r\n                    <Text style={styles.paragraph}>{legalReference2}</Text>\r\n                </View>\r\n            </Text>\r\n        );\r\n    } else {\r\n        return (\r\n            <Text>\r\n                <Text style={styles.paragraph}>\r\n                    De gjenvrende{' '}\r\n                    <Bold>{currencyFormatNO(genealogy_inheritance_sum)}</Bold>{' '}\r\n                    fordeles p slekten slik at det blir likt p hver gren i den\r\n                    aktuelle arvegangsklasse. Nrmeste levende slektning er i\r\n                    arvegangsklasse {value.class_closest}\r\n                    {getParagraph(\r\n                        value.class_closest,\r\n                        InheritanceConstants.CODE_PARAGRAPHS,\r\n                        InheritanceConstants.LAW_LINKS,\r\n                    )}\r\n                </Text>\r\n                <Text style={styles.paragraph}>\r\n                    {'\\n\\n'}\r\n                    {getGenealogyInheritanceText(value)}\r\n                </Text>\r\n            </Text>\r\n        );\r\n    }\r\n};\r\n\r\nconst getParagraph = (\r\n    class_closest: number,\r\n    CODE_PARAGRAPHS: any,\r\n    LAW_LINKS: any,\r\n) => {\r\n    let code_paragraph = '';\r\n    let helpText = '';\r\n    if (class_closest === 1) {\r\n        code_paragraph = '4 frste og annet ledd';\r\n        helpText = ' (livsarvinger/etterkommere av arvelater).';\r\n    } else if (class_closest === 2) {\r\n        code_paragraph = '5 frste, andre og tredje ledd';\r\n        helpText = ' (arvelaters foreldre og deres etterkommere).';\r\n    } else if (class_closest === 3) {\r\n        code_paragraph = '6 frste og annet ledd';\r\n        helpText = ' (arvelaters besteforeldre og deres etterkommere).';\r\n    } else {\r\n        console.log('check for error');\r\n    }\r\n    const legalReferenceText = add_legal_reference(\r\n        code_paragraph,\r\n        CODE_PARAGRAPHS,\r\n        LAW_LINKS,\r\n    );\r\n    return (\r\n        <View>\r\n            <Text>{helpText}</Text>\r\n            <Text>{legalReferenceText}</Text>\r\n        </View>\r\n    );\r\n};\r\n\r\n// const genealogy_inheritance_text = (value: InheritanceCalculation) => {\r\n//     const finalGenealogyInheritanceText = [];\r\n//     for (const obj of value.genealogy_inheritance) {\r\n//         finalGenealogyInheritanceText.push(\r\n//             <Text>\r\n//                 Person med person-id <Bold>{obj.person}</Bold> arver totalt{' '}\r\n//                 <Bold>{currencyFormatNO(obj.frac)} </Bold>\r\n//                 {unravel_chains_to_string([obj.chains])}.{'\\n'}\r\n//             </Text>,\r\n//         );\r\n//     }\r\n//     return finalGenealogyInheritanceText;\r\n// };\r\n\r\nexport default GenealogyUtils;\r\n","import { Text, View } from '@react-pdf/renderer';\r\nimport InheritanceConstants from '../../../../../ChatbotComponent/Helper/Methods/InheritanceConstants';\r\nimport { PliktdelsarvCalculation } from '../../../../PliktdelsarvCalculation';\r\nimport { styles } from '../../../styles';\r\nimport {\r\n    add_legal_reference,\r\n    currencyFormatNO,\r\n    unravel_chains_to_string,\r\n} from '../../../../pdf_utils';\r\nimport { Bold } from '../text-styles/Bold';\r\nimport { getGenealogyInheritanceText } from './CommonMethods';\r\n\r\nconst GenealogyPliktUtils = (value: PliktdelsarvCalculation) => {\r\n    const genealogy_inheritance_sum = value.genealogy_inheritance_sum;\r\n    const genealogyText = getGenealogyText(genealogy_inheritance_sum, value);\r\n\r\n    return (\r\n        <Text>\r\n            <Text>{genealogyText}</Text>\r\n        </Text>\r\n    );\r\n};\r\n\r\n// add_inheritance_calculation_relatives\r\nconst getGenealogyText = (\r\n    genealogyInheritanceSum: number,\r\n    value: PliktdelsarvCalculation,\r\n) => {\r\n    const genealogy_inheritance_sum = currencyFormatNO(genealogyInheritanceSum);\r\n    const code_paragraph = '50 frste ledd';\r\n    const legal_reference_text = add_legal_reference(\r\n        code_paragraph,\r\n        InheritanceConstants.CODE_PARAGRAPHS,\r\n        InheritanceConstants.LAW_LINKS,\r\n    );\r\n    const genealogyInheritanceText = getGenealogyInheritanceText(value);\r\n    if (value.genealogy_inheritance_sum === 0) {\r\n        return (\r\n            <Text style={styles.paragraph}>\r\n                Det er ingen slektsarv igjen  fordele.\r\n            </Text>\r\n        );\r\n    } else {\r\n        return (\r\n            <Text style={styles.paragraph}>\r\n                <Bold>{genealogy_inheritance_sum}</Bold>{' '}\r\n                <Text style={styles.paragraph}>\r\n                    fordeles p livsarvingene slik at det blir likt p hver\r\n                    gren. (livsarvinger/etterkommere av arvelater).\r\n                </Text>\r\n                <Text style={styles.paragraph}>{legal_reference_text}</Text>\r\n                {'\\n\\n'}\r\n                <Text style={styles.paragraph}>{genealogyInheritanceText}</Text>\r\n            </Text>\r\n        );\r\n    }\r\n};\r\n\r\nconst getParagraph = (\r\n    class_closest: number,\r\n    CODE_PARAGRAPHS: any,\r\n    LAW_LINKS: any,\r\n) => {\r\n    let code_paragraph = '';\r\n    let helpText = '';\r\n    if (class_closest === 1) {\r\n        code_paragraph = '4 frste og annet ledd';\r\n        helpText = ' (livsarvinger/etterkommere av arvelater).';\r\n    } else if (class_closest === 2) {\r\n        code_paragraph = '5 frste, andre og tredje ledd';\r\n        helpText = ' (arvelaters foreldre og deres etterkommere).';\r\n    } else if (class_closest === 3) {\r\n        code_paragraph = '6 frste og annet ledd';\r\n        helpText = ' (arvelaters besteforeldre og deres etterkommere).';\r\n    } else {\r\n        console.log('check for error');\r\n    }\r\n    const legalReferenceText = add_legal_reference(\r\n        code_paragraph,\r\n        CODE_PARAGRAPHS,\r\n        LAW_LINKS,\r\n    );\r\n    return (\r\n        <Text>\r\n            <Text>{helpText}</Text>\r\n            <Text>{legalReferenceText}</Text>\r\n        </Text>\r\n    );\r\n};\r\n\r\nexport default GenealogyPliktUtils;\r\n","import { Text, View } from \"@react-pdf/renderer\";\r\nimport { useContext } from \"react\";\r\nimport { UserContext } from \"../../../FinalDocument\";\r\nimport { styles } from \"../../../styles\";\r\nimport GenealogyUtils from \"./Genealogy.utils\";\r\nimport GenealogyPliktUtils from \"./GenealogyPlikt.utils\";\r\n\r\nexport const Genealogy = (props: { inheritanceMode: boolean }): JSX.Element => {\r\n  if (props.inheritanceMode) {\r\n    const value = useContext(UserContext).inheritanceCalculation;\r\n    const genealogyParagraph = GenealogyUtils(value);\r\n\r\n    return (\r\n      <View style={styles.section} wrap={false}>\r\n        <Text style={styles.paragraphHeading}>Slektsarv</Text>\r\n        {genealogyParagraph}\r\n      </View>\r\n    );\r\n  } else {\r\n    const value = useContext(UserContext).pliktdelsarvCalculation;\r\n    const genealogyPliktParagraph = GenealogyPliktUtils(value);\r\n    return (\r\n      <View style={styles.section} wrap={false}>\r\n        <Text style={styles.paragraphHeading}>Slektsarv</Text>\r\n        {genealogyPliktParagraph}\r\n      </View>\r\n    );\r\n  }\r\n};\r\n","import { Text } from \"@react-pdf/renderer\";\r\nimport { getPerson } from \"../../../../../ChatbotComponent/ActionProviderMethods/OtherChatbotMethods\";\r\nimport { PliktdelsarvCalculation } from \"../../../../PliktdelsarvCalculation\";\r\nimport { styles } from \"../../../styles\";\r\nimport { currencyFormatNO } from \"../../../../pdf_utils\";\r\n\r\nexport const IntroductionPliktUtils = (value: PliktdelsarvCalculation) => {\r\n  return getPliktIntroString(value);\r\n};\r\n\r\nconst getPliktIntroString = (value: PliktdelsarvCalculation) => {\r\n  const person_name = getPerson(\r\n    value.person._id,\r\n    value.state.personsMap\r\n  )._personName;\r\n  const net_wealth_NOK = currencyFormatNO(value.state.netWealth);\r\n  const survivor_inheritance_sum = currencyFormatNO(\r\n    value.survivor_inheritance_sum\r\n  );\r\n  const genealogy_inheritance_sum = currencyFormatNO(\r\n    value.genealogy_inheritance_sum\r\n  );\r\n  const available_for_will = currencyFormatNO(\r\n    value.netWealth -\r\n      value.survivor_inheritance_sum -\r\n      value.genealogy_inheritance_sum\r\n  );\r\n  return (\r\n    <Text style={styles.paragraph}>\r\n      <Text>\r\n        Denne delen inneholder en beregning av pliktdelsarv etter arvelater med\r\n        person-id\r\n      </Text>{\" \"}\r\n      <Text style={styles.boldValue}>{person_name}</Text>{\" \"}\r\n      <Text style={styles.paragraph}>som etterlater seg en nettoarv p</Text>{\" \"}\r\n      <Text style={styles.boldValue}>{net_wealth_NOK}</Text>\r\n      {\".\\n\\n \"}\r\n      <Text style={styles.boldValue}>{survivor_inheritance_sum}</Text>{\" \"}\r\n      <Text style={styles.paragraph}>gr til etterlatte, mens</Text>{\" \"}\r\n      <Text style={styles.boldValue}>{genealogy_inheritance_sum}</Text>{\" \"}\r\n      <Text style={styles.paragraph}>gr til livsarvinger. Det betyr at</Text>{\" \"}\r\n      <Text style={styles.boldValue}>{available_for_will}</Text>{\" \"}\r\n      <Text style={styles.paragraph}>fritt kan testamenteres bort.</Text>\r\n    </Text>\r\n  );\r\n};\r\n","import { Text, View } from \"@react-pdf/renderer\";\r\nimport { styles } from \"../../../styles\";\r\nimport { useContext } from \"react\";\r\nimport { UserContext } from \"../../../FinalDocument\";\r\nimport { IntroductionUtils } from \"./Introduction.utils\";\r\nimport { Bold } from \"../text-styles/Bold\";\r\nimport { IntroductionPliktUtils } from \"./IntroductionPlikt.utils\";\r\n\r\nexport const IntroductionPage = (props: {\r\n  inheritanceMode: boolean;\r\n}): JSX.Element => {\r\n  if (props.inheritanceMode) {\r\n    const value = useContext(UserContext).inheritanceCalculation;\r\n    const calculatedValues = IntroductionUtils(value);\r\n    return (\r\n      <View style={[styles.section]} wrap={false}>\r\n        <Text style={[styles.heading, { textAlign: \"center\" }]}>\r\n          Beregning av arv\r\n        </Text>\r\n        <Text style={styles.paragraph}>\r\n          Dette dokumentet inneholder en beregning av arv etter arvelater med\r\n          person-id <Bold>{calculatedValues.testatorName}</Bold>. Boet har en\r\n          total verdi p <Bold>{calculatedValues.currencyFormatted}</Bold>.\r\n        </Text>\r\n      </View>\r\n    );\r\n  } else {\r\n    const value = useContext(UserContext).pliktdelsarvCalculation;\r\n    const pliktIntroText = IntroductionPliktUtils(value);\r\n    return <View wrap={false}>{pliktIntroText}</View>;\r\n  }\r\n};\r\n","import { getPerson } from \"../../../../../ChatbotComponent/ActionProviderMethods/OtherChatbotMethods\";\r\nimport { undividedOwnershipType } from \"../../../../../ChatbotComponent/Helper/Enums/ChatStepTypes\";\r\nimport { InheritanceCalculation } from \"../../../../InheritanceCalculation\";\r\nimport { currencyFormatNO } from \"../../../../pdf_utils\";\r\n\r\nconst undivided_estate_results = (value: InheritanceCalculation) => {\r\n  const finalresult = \"\";\r\n  const first_partly_separate = value.state.undividedEstate.temp_first;\r\n  const testator_name = getPerson(\r\n    value.state.testator._id,\r\n    value.state.personsMap\r\n  )._personName;\r\n  const second_partly_separate = value.state.undividedEstate.temp_last;\r\n  const undivided_spouse_name = getPerson(\r\n    value.state.undividedSpouseId,\r\n    value.state.personsMap\r\n  )._personName;\r\n  const testator_wealth = currencyFormatNO(value.state.netWealth);\r\n  const undivided_estate_separate_wealth = currencyFormatNO(\r\n    value.state.undividedEstate.undividedEstateSeparateWealth\r\n  );\r\n  if (value.state.undividedEstate.undividedEstateChoice) {\r\n    finalresult.concat(\"<Text>Arvelater satt i uskiftet bo. </Text\");\r\n    if (\r\n      value.state.undividedEstate.ownershipType ===\r\n      undividedOwnershipType.felleseie\r\n    ) {\r\n      finalresult.concat(\r\n        `<Text>Det uskiftede boet var utelukkende felleseie. Boet verdier fordeles likt p frstavddes og sistavddes arvinger, ${value.state.undividedEstate.undividedEstateSeparateWealth} p hver gruppe.</Text>`\r\n      );\r\n    } else if (\r\n      value.state.undividedEstate.ownershipType ===\r\n      undividedOwnershipType.delvis\r\n    ) {\r\n      finalresult.concat(\r\n        `<Text>Det uskiftede boet var delvis sreie. Frstavddes (${undivided_spouse_name}) sreie hadde en verdi p ${first_partly_separate}, mens sistavdedes (${testator_name}) sreie hadde en verdi p ${second_partly_separate}. Verdiene som fordeles blant frstavddes (${undivided_spouse_name}) arvinger er ${testator_wealth}, mens verdiene som fordeles blant sistavddes (${testator_name})  arvinger er ${undivided_estate_separate_wealth}.</Text>`\r\n      );\r\n    } else if (\r\n      value.state.undividedEstate.ownershipType === undividedOwnershipType.fullt\r\n    ) {\r\n      finalresult.concat(\r\n        `<Text>Det uskiftede boet var fullt sreie. Verdiene som fordeles blant frstavddes (${undivided_spouse_name})  arvinger er ${testator_wealth}, mens verdiene som fordeles blant sistavddes (${testator_name}) arvinger er ${undivided_estate_separate_wealth}.</Text>`\r\n      );\r\n    } else {\r\n      console.log(\"check for problem, untroduction.utils.ts\");\r\n    }\r\n  }\r\n  return finalresult;\r\n};\r\n\r\nexport const IntroductionUtils = (value: InheritanceCalculation) => {\r\n  const currencyFormatted = currencyFormatNO(value.state.netWealth);\r\n\r\n  const testatorName = getPerson(1, value.state.personsMap)._personName;\r\n  return {\r\n    currencyFormatted: currencyFormatted,\r\n    testatorName: testatorName,\r\n  };\r\n};\r\n","// import { TableContainer, Table, Paper } from \"@mui/material\";\r\nimport {\r\n  DataTableCell,\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHeader,\r\n} from \"@david.kucsai/react-pdf-table\";\r\nimport { styles } from \"../../../styles\";\r\nimport { summaryValueType } from \"../summary/Summary\";\r\n\r\nexport const TableElement = (props: {\r\n  summaryValue: Array<summaryValueType>;\r\n}) => {\r\n  const summaryVal = props.summaryValue;\r\n  return (\r\n    <Table data={summaryVal}>\r\n      <TableHeader>\r\n        <TableCell style={styles.tableHeaderRow}>Person-id</TableCell>\r\n        <TableCell style={styles.tableHeaderRow}>Type</TableCell>\r\n        <TableCell style={styles.tableHeaderRow}>Belp</TableCell>\r\n      </TableHeader>\r\n      <TableBody>\r\n        <DataTableCell\r\n          style={styles.tableDataRow}\r\n          getContent={(r) => r.survivorName}\r\n        />\r\n        <DataTableCell\r\n          style={styles.tableDataRow}\r\n          getContent={(r) => r.survivorType}\r\n        />\r\n        <DataTableCell\r\n          style={styles.tableDataRow}\r\n          getContent={(r) => r.belopAmount}\r\n        />\r\n      </TableBody>\r\n    </Table>\r\n  );\r\n};\r\n","import { TableElement } from \"../react-pdf-table/Table\";\r\nimport { currencyFormatNO } from \"../../../../pdf_utils\";\r\nimport { summaryValueType } from \"./Summary\";\r\nimport { InheritanceCalculation } from \"../../../../InheritanceCalculation\";\r\nimport { getPerson } from \"../../../../../ChatbotComponent/ActionProviderMethods/OtherChatbotMethods\";\r\nimport { styles } from \"../../../styles\";\r\nimport { Text } from \"@react-pdf/renderer\";\r\nimport { PliktdelsarvCalculation } from \"../../../../PliktdelsarvCalculation\";\r\n\r\nexport const SummaryUtils = (\r\n  value: InheritanceCalculation | PliktdelsarvCalculation\r\n): JSX.Element => {\r\n  const summaryValues = getSummaryValues(value);\r\n  const table = <TableElement summaryValue={summaryValues} />;\r\n  const emptyTableCase = (\r\n    <Text style={styles.paragraph}>Table not available</Text>\r\n  );\r\n  return summaryValues.length > 0 ? table : emptyTableCase;\r\n};\r\n\r\nexport const getSummaryValues = (\r\n  value: InheritanceCalculation | PliktdelsarvCalculation\r\n): Array<summaryValueType> => {\r\n  const summaryValue: Array<summaryValueType> = [];\r\n  if (value.survivor !== null) {\r\n    const survivor_name = getPerson(\r\n      value.survivor,\r\n      value.state.personsMap\r\n    )._personName;\r\n    const belopAmount = currencyFormatNO(value.survivor_inheritance_sum);\r\n    summaryValue[0] = {\r\n      survivorName: survivor_name,\r\n      survivorType: value.survivor_type,\r\n      belopAmount: belopAmount,\r\n    };\r\n  }\r\n  for (const gen_inherit of value.genealogy_inheritance) {\r\n    if (gen_inherit) {\r\n      const summaryCell = {\r\n        survivorName: gen_inherit.person,\r\n        survivorType: `Slekt i ${value.class_closest}. arvegangsklasse`,\r\n        belopAmount: currencyFormatNO(gen_inherit.frac),\r\n      };\r\n      summaryValue.push(summaryCell);\r\n    }\r\n  }\r\n  if (\r\n    value.genealogy_inheritance_sum > 0 &&\r\n    (value.class_closest === undefined ||\r\n      (value.class_closest === 3 &&\r\n        value.distance_closest &&\r\n        value.distance_closest > 2))\r\n  ) {\r\n    summaryValue[0] = {\r\n      survivorName: \"-\",\r\n      survivorType: \"Frivillig arbeid\",\r\n      belopAmount: currencyFormatNO(value.genealogy_inheritance_sum),\r\n    };\r\n  }\r\n  return summaryValue;\r\n};\r\n","import { Text, View } from \"@react-pdf/renderer\";\r\nimport { useContext } from \"react\";\r\nimport { UserContext } from \"../../../FinalDocument\";\r\nimport { styles } from \"../../../styles\";\r\nimport { SummaryUtils } from \"./Summary.utils\";\r\n\r\nexport type summaryValueType = {\r\n  survivorName: string;\r\n  survivorType: string;\r\n  belopAmount: string;\r\n};\r\n\r\nexport const initialSummaryValue = {\r\n  survivorName: \"\",\r\n  survivorType: \"\",\r\n  belopAmount: \"\",\r\n};\r\n\r\nexport const Summary = (props: { inheritanceMode: boolean }): JSX.Element => {\r\n  const value = useContext(UserContext).inheritanceCalculation;\r\n  if (props.inheritanceMode) {\r\n    const summaryTable = SummaryUtils(value);\r\n\r\n    return (\r\n      <View style={styles.section} wrap={false}>\r\n        <Text style={styles.paragraphHeading}>Sammendrag</Text>\r\n        <View style={styles.marginTop}>{summaryTable}</View>\r\n      </View>\r\n    );\r\n  } else {\r\n    const value = useContext(UserContext).pliktdelsarvCalculation;\r\n    const summaryPliktTable = SummaryUtils(value);\r\n    return (\r\n      <View style={styles.section} wrap={false}>\r\n        <Text style={styles.paragraphHeading}>Sammendrag</Text>\r\n        <View style={styles.marginTop}>{summaryPliktTable}</View>\r\n      </View>\r\n    );\r\n  }\r\n};\r\n","import { Text } from '@react-pdf/renderer';\r\nimport { getPerson } from '../../../../../ChatbotComponent/ActionProviderMethods/OtherChatbotMethods';\r\nimport InheritanceConstants from '../../../../../ChatbotComponent/Helper/Methods/InheritanceConstants';\r\nimport { InheritanceCalculation } from '../../../../InheritanceCalculation';\r\nimport { PliktdelsarvCalculation } from '../../../../PliktdelsarvCalculation';\r\nimport { styles } from '../../../styles';\r\nimport { add_legal_references, currencyFormatNO } from '../../../../pdf_utils';\r\nimport { Bold } from '../text-styles/Bold';\r\n\r\nconst SurvivingPartnerUtils = (\r\n    value: InheritanceCalculation | PliktdelsarvCalculation,\r\n) => {\r\n    let survivor_name = 'Fix error';\r\n    if (value.survivor) {\r\n        survivor_name = getPerson(\r\n            value.survivor,\r\n            value.state.personsMap,\r\n        )._personName;\r\n    }\r\n\r\n    const survivor_inheritance_sum = currencyFormatNO(\r\n        value.survivor_inheritance_sum,\r\n    );\r\n    const genealogy_inheritance_sum = currencyFormatNO(\r\n        value.genealogy_inheritance_sum,\r\n    );\r\n\r\n    const inheritanceDescriptiveText = getInheritanceDescriptiveText(\r\n        value.descriptive_text,\r\n        survivor_name,\r\n        survivor_inheritance_sum,\r\n        genealogy_inheritance_sum,\r\n        value instanceof InheritanceCalculation,\r\n    );\r\n    const legalReferenceTextArray = add_legal_references(\r\n        value.surviving_reference_paragraphs,\r\n        InheritanceConstants.CODE_PARAGRAPHS,\r\n        InheritanceConstants.LAW_LINKS,\r\n    );\r\n    const pliktSpecificText = (\r\n        <Text style={styles.paragraph}>\r\n            OBS! Nye regler for samboer - sjekk ut{'\\n\\n'}\r\n        </Text>\r\n    );\r\n\r\n    return (\r\n        <Text>\r\n            <Text style={styles.paragraphHeading}>\r\n                Gjenlevende ektefelle eller samboer {'\\n'}\r\n                {value instanceof InheritanceCalculation\r\n                    ? ''\r\n                    : pliktSpecificText}\r\n            </Text>\r\n            <Text style={styles.paragraph}>{inheritanceDescriptiveText}</Text>\r\n            {legalReferenceTextArray.map((legalReferenceText) => (\r\n                <Text\r\n                    key={legalReferenceTextArray.indexOf(legalReferenceText)}\r\n                    style={styles.paragraph}\r\n                >\r\n                    {legalReferenceText}\r\n                </Text>\r\n            ))}\r\n        </Text>\r\n    );\r\n};\r\n\r\nconst getInheritanceDescriptiveText = (\r\n    descriptive_text: string,\r\n    survivor_name: string,\r\n    survivor_inheritance_sum: string,\r\n    genealogy_inheritance_sum: string,\r\n    valueType: boolean,\r\n) => {\r\n    if (\r\n        [\r\n            InheritanceConstants.DESC_NO_SPOUSE_OR_COHABITANT,\r\n            InheritanceConstants.DESC_COHABITANT_WITHOUT_COMMON_CHILD,\r\n        ].includes(descriptive_text)\r\n    ) {\r\n        return <Text style={styles.paragraph}>{descriptive_text}</Text>;\r\n    } else if (\r\n        [\r\n            InheritanceConstants.DESC_SPOUSE_NO_CLOSE_RELATIVES,\r\n            InheritanceConstants.DESC_SPOUSE_NO_CLOSE_RELATIVES_2,\r\n            InheritanceConstants.DESC_COHABITANT_NO_CLOSE_RELATIVES,\r\n            InheritanceConstants.DESC_COHABITANT_NO_CLOSE_RELATIVES_2,\r\n        ].includes(descriptive_text)\r\n    ) {\r\n        const inheritanceSpecificTextIf = (\r\n            <Text style={styles.paragraph}>\r\n                {descriptive_text} Den etterlatte har person-id{' '}\r\n                <Bold>{survivor_name}</Bold>. Arv til gjenlevende er{' '}\r\n                {survivor_inheritance_sum}.\r\n            </Text>\r\n        );\r\n\r\n        const pliktSpecificTextIf = (\r\n            <Text>\r\n                {descriptive_text} Den etterlatte har person-id{' '}\r\n                <Bold>{survivor_name}</Bold>. Minstearv til gjenlevende er{' '}\r\n                {survivor_inheritance_sum}.\r\n            </Text>\r\n        );\r\n        return valueType ? inheritanceSpecificTextIf : pliktSpecificTextIf;\r\n    } else {\r\n        const inheritanceSpecificTextElse = (\r\n            <Text style={styles.paragraph}>\r\n                {' '}\r\n                {descriptive_text} Den etterlatte har person-id{' '}\r\n                <Bold>{survivor_name}</Bold>. Arv til gjenlevende er{' '}\r\n                <Bold>{survivor_inheritance_sum}</Bold>, og de resterende{' '}\r\n                <Bold>{genealogy_inheritance_sum}</Bold> gr til slekten.\r\n            </Text>\r\n        );\r\n        const pliktSpecificTextElse = (\r\n            <Text style={styles.paragraph}>\r\n                {' '}\r\n                {descriptive_text} Den etterlatte har person-id{' '}\r\n                <Bold>{survivor_name}</Bold>. Minstearv til gjenlevende er{' '}\r\n                <Bold>{survivor_inheritance_sum}</Bold>.\r\n            </Text>\r\n        );\r\n        return valueType ? inheritanceSpecificTextElse : pliktSpecificTextElse;\r\n    }\r\n};\r\n\r\nexport default SurvivingPartnerUtils;\r\n","import { View } from \"@react-pdf/renderer\";\r\nimport { useContext } from \"react\";\r\nimport { UserContext } from \"../../../FinalDocument\";\r\nimport { styles } from \"../../../styles\";\r\nimport SurvivingPartnerUtils from \"./SurvivingPartner.utils\";\r\n\r\nexport const SurvivingPartner = (props: {\r\n  inheritanceMode: boolean;\r\n}): JSX.Element => {\r\n  if (props.inheritanceMode) {\r\n    const value = useContext(UserContext).inheritanceCalculation;\r\n\r\n    const survivingPartnerParagraph = SurvivingPartnerUtils(value);\r\n\r\n    return (\r\n      <View style={styles.section} wrap={false}>\r\n        {survivingPartnerParagraph}\r\n      </View>\r\n    );\r\n  } else {\r\n    const value = useContext(UserContext).pliktdelsarvCalculation;\r\n    const survivingPartnerParagraph = SurvivingPartnerUtils(value);\r\n    return (\r\n      <View style={styles.section} wrap={false}>\r\n        {survivingPartnerParagraph}\r\n      </View>\r\n    );\r\n  }\r\n};\r\n","import { Text, View } from \"@react-pdf/renderer\";\r\nimport { styles } from \"../../styles\";\r\nimport { Genealogy } from \"../common/genealogy/Genealogy\";\r\nimport { IntroductionPage } from \"../common/introSection/IntroductionPage\";\r\nimport { Summary } from \"../common/summary/Summary\";\r\nimport { SurvivingPartner } from \"../common/survivingPartner/SurvivingPartner\";\r\n\r\n/* SurvivingPartner -> Gjenlevende ektefelle eller samboer\r\n   Genealogy -> Slektsarv\r\n   Summary -> Sammendrag\r\n*/\r\n\r\nexport const FirstSection = (): JSX.Element => {\r\n  return (\r\n    <View style={styles.section}>\r\n      <IntroductionPage inheritanceMode />\r\n      <Text style={styles.subheading}>Beregnet arv i fravr av testament</Text>\r\n      <SurvivingPartner inheritanceMode />\r\n      <Genealogy inheritanceMode />\r\n      <Summary inheritanceMode />\r\n    </View>\r\n  );\r\n};\r\n","import { Text } from \"@react-pdf/renderer\";\r\nimport { getPerson } from \"../../../../../ChatbotComponent/ActionProviderMethods/OtherChatbotMethods\";\r\nimport InheritanceConstants from \"../../../../../ChatbotComponent/Helper/Methods/InheritanceConstants\";\r\nimport { UndividedCalculation } from \"../../../../UndividedCalculation\";\r\nimport { styles } from \"../../../styles\";\r\nimport {\r\n  add_legal_reference,\r\n  currencyFormatNO,\r\n  unravel_chains_to_string,\r\n} from \"../../../../pdf_utils\";\r\nimport { TableElement } from \"../../common/react-pdf-table/Table\";\r\nimport { summaryValueType } from \"../../common/summary/Summary\";\r\nimport { Bold } from \"../../common/text-styles/Bold\";\r\n\r\nexport const getUndividedRelativeText = (\r\n  value: UndividedCalculation\r\n): JSX.Element => {\r\n  let returnValue;\r\n  if (value.genealogy_inheritance_sum === 0) {\r\n    returnValue = <Text>Det er ingen slektsarv igjen  fordele.</Text>;\r\n  } else if (\r\n    value.class_closest === undefined ||\r\n    (value.class_closest === 3 &&\r\n      value.distance_closest &&\r\n      value.distance_closest > 2)\r\n  ) {\r\n    const code_paragraph1 = \"6 frste ledd, andre punktum\";\r\n    const code_paragraph2 = \"76 frste ledd, frste punktum\";\r\n    const legalReference1 = add_legal_reference(\r\n      code_paragraph1,\r\n      InheritanceConstants.CODE_PARAGRAPHS,\r\n      InheritanceConstants.LAW_LINKS\r\n    );\r\n    const legalReference2 = add_legal_reference(\r\n      code_paragraph2,\r\n      InheritanceConstants.CODE_PARAGRAPHS,\r\n      InheritanceConstants.LAW_LINKS\r\n    );\r\n\r\n    returnValue = (\r\n      <Text>\r\n        <Text>Testator har ingen nre slektninger.</Text>\r\n        <Text>{legalReference1}</Text>\r\n        <Text style={styles.paragraphHeading}>Frivillig arbeid</Text>\r\n        <Text>\r\n          <Bold>${currencyFormatNO(value.genealogy_inheritance_sum)}</Bold>{\" \"}\r\n          <Text>vil g til frivillig arbeid til fordel for barn og unge.</Text>\r\n          <Text>{legalReference2}</Text>\r\n        </Text>\r\n      </Text>\r\n    );\r\n  } else {\r\n    let code_paragraph = \"\";\r\n    let endSentence = \"\";\r\n    if (value.class_closest === 1) {\r\n      code_paragraph = \"4 frste og annet ledd\";\r\n      endSentence = \" (livsarvinger/etterkommere av arvelater).\";\r\n    } else if (value.class_closest === 2) {\r\n      code_paragraph = \"5 frste, andre og tredje ledd\";\r\n      endSentence = \" (arvelaters foreldre og deres etterkommere).\";\r\n    } else if (value.class_closest === 3) {\r\n      code_paragraph = \"6 frste og annet ledd\";\r\n      endSentence = \" (arvelaters besteforeldre og deres etterkommere).\";\r\n    } else {\r\n      throw new Error(\"wrong class_closest value\");\r\n    }\r\n    const legalReferenceText = add_legal_reference(\r\n      code_paragraph,\r\n      InheritanceConstants.CODE_PARAGRAPHS,\r\n      InheritanceConstants.LAW_LINKS\r\n    );\r\n\r\n    const unraveledText = value.genealogy_inheritance.map(\r\n      (genealogy_inheritance_unit) => {\r\n        <Text>\r\n          <Text>Person med person-id</Text>\r\n          <Bold>{genealogy_inheritance_unit.person}</Bold>{\" \"}\r\n          <Text>arver totalt</Text>{\" \"}\r\n          <Bold>{genealogy_inheritance_unit.frac}</Bold>\r\n          <Text>\r\n            `${unravel_chains_to_string([genealogy_inheritance_unit.chains])}\r\n            .\\n`\r\n          </Text>\r\n        </Text>;\r\n      }\r\n    );\r\n\r\n    returnValue = (\r\n      <Text>\r\n        <Text>De gjenvrende</Text>{\" \"}\r\n        <Bold>{currencyFormatNO(value.genealogy_inheritance_sum)}</Bold>{\" \"}\r\n        <Text>\r\n          fordeles p slekten slik at det blir likt p hver gren i den aktuelle\r\n          arvegangsklasse.\r\n        </Text>{\" \"}\r\n        <Text>\r\n          `Nrmeste levende slektning er i arvegangsklasse $\r\n          {value.class_closest} ${endSentence}`\r\n        </Text>\r\n        <Text>{legalReferenceText}</Text>\r\n        <Text>{unraveledText}</Text>\r\n      </Text>\r\n    );\r\n  }\r\n  return returnValue;\r\n};\r\n\r\nexport const getUndividedSummaryTable = (\r\n  value: UndividedCalculation\r\n): JSX.Element => {\r\n  const summaryValues = getSummaryValues(value);\r\n  const table = <TableElement summaryValue={summaryValues} />;\r\n  return table;\r\n};\r\n\r\nconst getSummaryValues = (\r\n  value: UndividedCalculation\r\n): Array<summaryValueType> => {\r\n  const summaryValue: Array<summaryValueType> = [];\r\n  let survivor_name = \"\";\r\n  let survivor_type = \"\";\r\n  let belop_amount = \"\";\r\n  if (value.survivor) {\r\n    survivor_name = getPerson(\r\n      value.survivor,\r\n      value.state.personsMap\r\n    )._personName;\r\n\r\n    survivor_type = value.survivor_type;\r\n    belop_amount = currencyFormatNO(value.genealogy_inheritance_sum);\r\n  }\r\n  summaryValue.push({\r\n    survivorName: survivor_name,\r\n    survivorType: survivor_type,\r\n    belopAmount: belop_amount,\r\n  });\r\n\r\n  value.genealogy_inheritance.map((gen_inherit) => {\r\n    summaryValue.push({\r\n      survivorName: gen_inherit.person,\r\n      survivorType: `Slekt i ${value.class_closest}. arvegangsklasse`,\r\n      belopAmount: currencyFormatNO(gen_inherit.frac),\r\n    });\r\n  });\r\n\r\n  if (\r\n    value.genealogy_inheritance_sum > 0 &&\r\n    (value.class_closest === undefined ||\r\n      (value.class_closest === 3 &&\r\n        value.distance_closest &&\r\n        value.distance_closest > 2))\r\n  ) {\r\n    summaryValue.push({\r\n      survivorName: `-`,\r\n      survivorType: `Frivillig arbeid`,\r\n      belopAmount: currencyFormatNO(value.genealogy_inheritance_sum),\r\n    });\r\n  }\r\n  return summaryValue;\r\n};\r\n","import { Text, View } from \"@react-pdf/renderer\";\r\nimport { useContext } from \"react\";\r\nimport { styles } from \"../../../styles\";\r\nimport { UserContext } from \"../../../FinalDocument\";\r\nimport {\r\n  getUndividedRelativeText,\r\n  getUndividedSummaryTable,\r\n} from \"./UndividedEstateCalculationUtils\";\r\nimport { UndividedCalculation } from \"../../../../UndividedCalculation\";\r\n\r\nexport const UndividedEstateCalculation = (): JSX.Element => {\r\n  const value = useContext(UserContext).undividedCalculation;\r\n  let undividedResult: JSX.Element;\r\n  if (value.state.undividedEstate.undividedEstateChoice) {\r\n    const addUndividedEstateRelatives = add_undivided_estate_relatives(value);\r\n    const addUndividedEstateSummary = add_undivided_estate_summary(value);\r\n    undividedResult = (\r\n      <Text>\r\n        <Text>{addUndividedEstateRelatives}</Text>\r\n        {\"\\n\"}\r\n        <Text>{addUndividedEstateSummary}</Text>\r\n      </Text>\r\n    );\r\n  } else {\r\n    undividedResult = (\r\n      <Text style={styles.paragraph}>Ingen uskiftesituasjon</Text>\r\n    );\r\n  }\r\n  return (\r\n    <View style={styles.section} break>\r\n      <Text style={styles.subheading}>Legg til introduksjon her</Text>\r\n      <Text style={styles.paragraph}>{undividedResult}</Text>\r\n    </View>\r\n  );\r\n};\r\n\r\nconst add_undivided_estate_relatives = (\r\n  value: UndividedCalculation\r\n): JSX.Element => {\r\n  const UndividedRelativeText = getUndividedRelativeText(value);\r\n  return (\r\n    <Text style={styles.paragraph}>\r\n      <Text style={styles.paragraphHeading}>Slektsarv</Text>\r\n      {\"\\n\"}\r\n      <Text>{UndividedRelativeText}</Text>\r\n    </Text>\r\n  );\r\n};\r\n\r\nconst add_undivided_estate_summary = (\r\n  value: UndividedCalculation\r\n): JSX.Element => {\r\n  const UndividedSummaryTable = getUndividedSummaryTable(value);\r\n  return (\r\n    <Text style={styles.paragraph}>\r\n      <Text style={styles.paragraphHeading}>Sammendrag</Text>\r\n      {\"\\n\"}\r\n      <Text>{UndividedSummaryTable}</Text>\r\n    </Text>\r\n  );\r\n};\r\n","import { Text, View } from \"@react-pdf/renderer\";\r\nimport { styles } from \"../../styles\";\r\nimport { UndividedEstateCalculation } from \"./UndividedEstateCalculation/UndividedEstateCalculation\";\r\nimport { useContext } from \"react\";\r\nimport { UserContext } from \"../../FinalDocument\";\r\nexport const SecondSection = () => {\r\n  const value = useContext(UserContext).inheritanceCalculation;\r\n\r\n  const undividedStateElement = (\r\n    <View style={styles.section} wrap={false}>\r\n      <Text style={styles.subheading}>Uskiftearv</Text>\r\n      <UndividedEstateCalculation />\r\n    </View>\r\n  );\r\n  {\r\n    const secondSectionElement = value.state.undividedEstate\r\n      .undividedEstateChoice ? (\r\n      undividedStateElement\r\n    ) : (\r\n      <Text></Text>\r\n    );\r\n    return secondSectionElement;\r\n  }\r\n};\r\n","import { Text, View } from \"@react-pdf/renderer\";\r\nimport { styles } from \"../../styles\";\r\nimport { Genealogy } from \"../common/genealogy/Genealogy\";\r\nimport { IntroductionPage } from \"../common/introSection/IntroductionPage\";\r\nimport { Summary } from \"../common/summary/Summary\";\r\nimport { SurvivingPartner } from \"../common/survivingPartner/SurvivingPartner\";\r\n\r\n/* SurvivingPartner -> Gjenlevende ektefelle eller samboer\r\n   Genealogy -> Slektsarv\r\n   Summary -> Sammendrag\r\n*/\r\n\r\nexport const ThirdSection = (): JSX.Element => {\r\n  return (\r\n    <View style={styles.section}>\r\n      <Text style={styles.subheading}>Pliktdelsarv</Text>\r\n      <IntroductionPage inheritanceMode={false} />\r\n      <SurvivingPartner inheritanceMode={false} />\r\n      <Genealogy inheritanceMode={false} />\r\n      <Summary inheritanceMode={false} />\r\n    </View>\r\n  );\r\n};\r\n","import { Text } from \"@react-pdf/renderer\";\r\nimport InheritanceConstants from \"../../../../../ChatbotComponent/Helper/Methods/InheritanceConstants\";\r\nimport { styles } from \"../../../styles\";\r\nimport { addLovdataLink } from \"../../../../pdf_utils\";\r\n\r\nconst generalReservationsUtils = () => {\r\n  return {\r\n    uskifteText: getUskifteText(),\r\n    testamentText: getTestamentText(),\r\n    avkortingText: getavkortingText(),\r\n    barnText: getBarnText(),\r\n  };\r\n};\r\n\r\nconst getUskifteText = () => (\r\n  <Text style={styles.paragraph}>\r\n    <Text style={styles.paragraphHeading}>Uskifte</Text>\r\n    {\"\\n\"}\r\n    <Text>Beregningene forutsetter at avdde ikke sitter i uskiftet bo.</Text>\r\n  </Text>\r\n);\r\n\r\nconst getTestamentText = () => (\r\n  <Text style={styles.paragraph}>\r\n    <Text style={styles.paragraphHeading}>Testament</Text>\r\n    {\"\\n\"}\r\n    <Text>\r\n      Beregningene forutsetter at avdde ikke etterlater seg testament.\r\n    </Text>\r\n  </Text>\r\n);\r\n\r\nconst getavkortingText = () => {\r\n  const code_paragraph = \"75 frste ledd\";\r\n  const lovdata_link = addLovdataLink(\r\n    code_paragraph,\r\n    InheritanceConstants.LAW_LINKS\r\n  );\r\n  return (\r\n    <Text style={styles.paragraph}>\r\n      <Text style={styles.paragraphHeading}>Avkorting i arv</Text>\r\n      {\"\\n\"}\r\n      <Text>\r\n        Bestemmelsene om avkorting i arvelovens  75 er ikke tatt hensyn til i\r\n        bergningene.\r\n      </Text>\r\n      {\"\\n\"}\r\n      <Text style={styles.redText}>\r\n        Det er srlig viktig  vre OBS p mulig avkorting dersom det har blitt\r\n        gitt forskudd p arv.{\"\\n\"}\r\n      </Text>\r\n      <Text>{lovdata_link}</Text>\r\n    </Text>\r\n  );\r\n};\r\n\r\nconst getBarnText = () => {\r\n  const code_paragraph = \"7\";\r\n  return (\r\n    <Text style={styles.paragraph}>\r\n      <Text style={styles.paragraphHeading}>Barn</Text>\r\n      {\"\\n\"}\r\n      <Text>Vr obs p de srskilte bestemmelsene i arveloven  7.</Text>\r\n      <Text>\r\n        {addLovdataLink(code_paragraph, InheritanceConstants.LAW_LINKS)}\r\n      </Text>\r\n    </Text>\r\n  );\r\n};\r\n\r\nexport default generalReservationsUtils;\r\n","import { Text, View } from '@react-pdf/renderer';\r\nimport { styles } from '../../../styles';\r\nimport generalReservationsUtils from './GeneralReservationsUtils';\r\n\r\nexport const GeneralReservations = (): JSX.Element => {\r\n    const generalReservationsText = generalReservationsUtils();\r\n    return (\r\n        <View style={styles.section} wrap={false}>\r\n            <Text>\r\n                {generalReservationsText.uskifteText}\r\n                {'\\n\\n'}\r\n            </Text>\r\n            <Text>\r\n                {generalReservationsText.testamentText}\r\n                {'\\n\\n'}\r\n            </Text>\r\n            <Text>\r\n                {generalReservationsText.avkortingText}\r\n                {'\\n\\n'}\r\n            </Text>\r\n            <Text>\r\n                {generalReservationsText.barnText}\r\n                {'\\n\\n'}\r\n            </Text>\r\n        </View>\r\n    );\r\n};\r\n","import { Text, View } from \"@react-pdf/renderer\";\r\nimport { useContext } from \"react\";\r\nimport InheritanceConstants from \"../../../../../ChatbotComponent/Helper/Methods/InheritanceConstants\";\r\nimport { UserContext } from \"../../../FinalDocument\";\r\nimport { styles } from \"../../../styles\";\r\nimport { currencyFormatNO } from \"../../../../pdf_utils\";\r\nimport { Bold } from \"../../common/text-styles/Bold\";\r\n\r\nexport const NationalInsurance = (): JSX.Element => {\r\n  const NationalInsuranceText = getNationalInsuranceString();\r\n  return (\r\n    <View style={styles.section} wrap={false}>\r\n      <Text style={styles.paragraphHeading}>Folketrygdens grunnbelp</Text>\r\n      <Text style={styles.paragraph}>{NationalInsuranceText}</Text>\r\n    </View>\r\n  );\r\n};\r\n\r\nconst getNationalInsuranceString = () => {\r\n  // const value = useContext(UserContext).inheritanceCalculation;\r\n  return (\r\n    <Text wrap={false}>\r\n      <Text>\r\n        Enkelte terskelverdier beregnes utfra det til enhver tid gjeldende\r\n        grunnbelp i folketrygden. I beregningene er det forutsatt at\r\n        grunnbelpet i folketrygden er p{\" \"}\r\n      </Text>\r\n      <Bold>{currencyFormatNO(InheritanceConstants.G)}</Bold>.\r\n    </Text>\r\n  );\r\n};\r\n","import { Text, View } from '@react-pdf/renderer';\r\nimport { styles } from '../../styles';\r\nimport { GeneralReservations } from './generalReservations/GeneralReservations';\r\nimport { NationalInsurance } from './nationalInsurance/NationalInsurance';\r\n\r\nexport const FourthSection = (): JSX.Element => {\r\n    return (\r\n        <View style={styles.section}>\r\n            <Text style={styles.subheading}>\r\n                Generelle merknader og forbehold{'\\n\\n'}\r\n            </Text>\r\n            <NationalInsurance />\r\n            <GeneralReservations />\r\n        </View>\r\n    );\r\n};\r\n","import { Text } from \"@react-pdf/renderer\";\r\nimport { styles } from \"../../../styles\";\r\n\r\nexport const Footer = (): JSX.Element => {\r\n  return (\r\n    <Text\r\n      style={styles.pageNumber}\r\n      render={({ pageNumber, totalPages }) => `${pageNumber} / ${totalPages}`}\r\n      fixed\r\n    />\r\n  );\r\n};\r\n","import { Text } from \"@react-pdf/renderer\";\r\nimport { styles } from \"../../../styles\";\r\n\r\nexport const Header = (): JSX.Element => {\r\n  return (\r\n    <Text style={styles.header} fixed>\r\n      Arvebot\r\n    </Text>\r\n  );\r\n};\r\n","import { Image, View } from \"@react-pdf/renderer\";\r\nimport { styles } from \"../../styles\";\r\nimport domtoimage from \"dom-to-image\";\r\nimport { useState } from \"react\";\r\n\r\nexport const FifthSection = (): JSX.Element => {\r\n  const [url, setUrl] = useState(\"src/assets/images/arvebot-logo.png\");\r\n  const node = document.querySelector(\".react-flow\") as Node;\r\n  domtoimage\r\n    .toPng(node, {\r\n      filter: (node: Node): boolean => {\r\n        // we don't want to add the minimap and the controls to the image\r\n\r\n        if (\r\n          (node as HTMLElement)?.classList?.contains(\"react-flow__minimap\") ||\r\n          (node as HTMLElement)?.classList?.contains(\"react-flow__controls\")\r\n        ) {\r\n          return false;\r\n        }\r\n        return true;\r\n      },\r\n    })\r\n    .then(function (dataUrl: any) {\r\n      setUrl(dataUrl);\r\n    })\r\n    .catch(function (error: any) {\r\n      console.error(\"oops, something went wrong!\", error);\r\n    });\r\n  return (\r\n    <View style={styles.imageView} wrap={false}>\r\n      <Image style={styles.image} src={url} />\r\n    </View>\r\n  );\r\n};\r\n","import { Document, Page } from '@react-pdf/renderer';\r\nimport { FirstSection } from './Sections/firstSection/FirstSection';\r\nimport { SecondSection } from './Sections/secondSection/SecondSection';\r\nimport { ThirdSection } from './Sections/thirdSection/ThirdSection';\r\nimport { FourthSection } from './Sections/fourthSection/FourthSection';\r\nimport { styles } from './styles';\r\nimport { Footer } from './Sections/common/fixedSection/Footer';\r\nimport { Header } from './Sections/common/fixedSection/Header';\r\nimport { createContext } from 'react';\r\nimport { InheritanceCalculation } from '../InheritanceCalculation';\r\nimport 'react-pdf/dist/umd/Page/AnnotationLayer.css';\r\nimport { PliktdelsarvCalculation } from '../PliktdelsarvCalculation';\r\nimport { UndividedCalculation } from '../UndividedCalculation';\r\nimport { FifthSection } from './Sections/fifthSection/fifthSection';\r\n\r\ninterface FinalObjectInput {\r\n    inheritanceCalculation: InheritanceCalculation;\r\n    pliktdelsarvCalculation: PliktdelsarvCalculation;\r\n    undividedCalculation: UndividedCalculation;\r\n}\r\n\r\nexport const UserContext = createContext(\r\n    {} as {\r\n        inheritanceCalculation: InheritanceCalculation;\r\n        pliktdelsarvCalculation: PliktdelsarvCalculation;\r\n        undividedCalculation: UndividedCalculation;\r\n    },\r\n);\r\n// First Section - Introduction, Inheritance\r\n// Second Section - Uskiftearv\r\n// Third Section - Pliktdelsarv\r\n// Fourth Section - Merknader og forbehold\r\nconst FinalDocument = (props: { inputData: FinalObjectInput }): JSX.Element => {\r\n    return (\r\n        <Document>\r\n            <Page size=\"A4\" style={styles.page} wrap>\r\n                <UserContext.Provider\r\n                    value={{\r\n                        inheritanceCalculation:\r\n                            props.inputData.inheritanceCalculation,\r\n                        pliktdelsarvCalculation:\r\n                            props.inputData.pliktdelsarvCalculation,\r\n                        undividedCalculation:\r\n                            props.inputData.undividedCalculation,\r\n                    }}\r\n                >\r\n                    <Header />\r\n                    <FirstSection />\r\n                    <SecondSection />\r\n                    <ThirdSection />\r\n                    <FourthSection />\r\n                    <FifthSection />\r\n                    <Footer />\r\n                </UserContext.Provider>\r\n            </Page>\r\n        </Document>\r\n    );\r\n};\r\nexport default FinalDocument;\r\n","import { ChatbotInterface } from \"../ChatbotComponent/Generics\";\r\nimport { NodeEntity } from \"../ChatbotComponent/Helper/Classes/NodeEntity\";\r\nimport Norsk from \"../../../languages/translationNO.json\";\r\nimport { createIntl, createIntlCache } from \"react-intl\";\r\nimport InheritanceConstants from \"../ChatbotComponent/Helper/Methods/InheritanceConstants\";\r\nimport ActionProvider from \"../ChatbotComponent/ActionProvider\";\r\nimport { ReportCalculationBase } from \"./ReportCalculationBase\";\r\nimport { getNode } from \"../ChatbotComponent/ActionProviderMethods/OtherChatbotMethods\";\r\nconst cache = createIntlCache();\r\nconst intl = createIntl({ locale: \"nb-NO\", messages: Norsk }, cache);\r\n\r\nexport class PliktdelsarvCalculation extends ReportCalculationBase {\r\n  state: ChatbotInterface;\r\n  actionProvider: ActionProvider;\r\n  person: NodeEntity;\r\n  constructor(\r\n    person: NodeEntity,\r\n    actionProvider: ActionProvider,\r\n    state: ChatbotInterface,\r\n    will = undefined\r\n  ) {\r\n    super(person, actionProvider, state, 3, will);\r\n    this.state = state;\r\n    this.actionProvider = actionProvider;\r\n    this.person = getNode(person._id, this.state.nodeMap);\r\n    this.will = will;\r\n  }\r\n\r\n  // computeInheritance = () => {\r\n  //   //\r\n  // };\r\n\r\n  // computeGenealogyInheritance = (person_id: number) => {\r\n  //   this.survivor_inheritance_sum = Math.min(\r\n  //     this.state.netWealth,\r\n  //     this.minimum_surviving_inheritance\r\n  //   );\r\n\r\n  //   this.genealogy_inheritance_sum = Math.min(\r\n  //     this.state.netWealth - this.survivor_inheritance_sum,\r\n  //     this.state.netWealth * InheritanceConstants.FRACTION_PLIKTDEL,\r\n  //     InheritanceConstants.LINE_MAXIMUM_PLIKTDEL *\r\n  //       this.state.testator._children.length\r\n  //   );\r\n  //   if (this.genealogy_inheritance_sum !== 0) {\r\n  //     this.splits_with_chains = this.reportUtils.split_evenly_between_lines(\r\n  //       this.state.testator._children\r\n  //     );\r\n\r\n  //     const genealogy_splits = this.reportUtils.combine_duplicates(\r\n  //       this.splits_with_chains\r\n  //     );\r\n\r\n  //     genealogy_splits.map((genealogy_split: any) => {\r\n  //       return this.genealogy_inheritance.push({\r\n  //         person: genealogy_split.person,\r\n  //         frac: genealogy_split.frac * this.genealogy_inheritance_sum,\r\n  //         chains: genealogy_split.chains,\r\n  //       });\r\n  //     });\r\n  //   } else {\r\n  //     this.splits_with_chains = [];\r\n  //     this.genealogy_splits = splits_initial;\r\n  //     this.genealogy_inheritance = [splits_initial];\r\n  //   }\r\n  //   return this.genealogy_inheritance;\r\n  // };\r\n}\r\n","import { ChatbotInterface } from \"../ChatbotComponent/Generics\";\r\nimport { NodeEntity } from \"../ChatbotComponent/Helper/Classes/NodeEntity\";\r\nimport Norsk from \"../../../languages/translationNO.json\";\r\nimport { createIntl, createIntlCache } from \"react-intl\";\r\nimport InheritanceConstants from \"../ChatbotComponent/Helper/Methods/InheritanceConstants\";\r\nimport ActionProvider from \"../ChatbotComponent/ActionProvider\";\r\nimport { ReportCalculationBase } from \"./ReportCalculationBase\";\r\nimport {\r\n  getNode,\r\n  get_class_and_distance_closest_surviving_relative,\r\n} from \"../ChatbotComponent/ActionProviderMethods/OtherChatbotMethods\";\r\nconst cache = createIntlCache();\r\nconst intl = createIntl({ locale: \"nb-NO\", messages: Norsk }, cache);\r\nexport class UndividedCalculation extends ReportCalculationBase {\r\n  survivor: number | null = null;\r\n\r\n  constructor(\r\n    person: NodeEntity,\r\n    actionProvider: ActionProvider,\r\n    state: ChatbotInterface\r\n  ) {\r\n    super(person, actionProvider, state, 2);\r\n    this.state = state;\r\n    this.actionProvider = actionProvider;\r\n    this.person = getNode(person._id, this.state.nodeMap);\r\n  }\r\n\r\n  // computeGenealogyInheritance = () => {\r\n  //   this.survivor_inheritance_sum = Math.min(\r\n  //     this.state.netWealth,\r\n  //     Math.max(\r\n  //       this.minimum_surviving_inheritance,\r\n  //       this.surviving_fraction * this.state.netWealth\r\n  //     )\r\n  //   );\r\n  //   this.genealogy_inheritance_sum =\r\n  //     this.state.netWealth - this.survivor_inheritance_sum;\r\n  //   if (this.genealogy_inheritance_sum !== 0) {\r\n  //     this.splits_with_chains =\r\n  //       this.reportUtils.compute_default_genealogy_splits_with_chains(\r\n  //         this.person\r\n  //       );\r\n\r\n  //     const genealogy_splits = this.reportUtils.combine_duplicates(\r\n  //       this.splits_with_chains\r\n  //     );\r\n  //   } else {\r\n  //     this.splits_with_chains = [];\r\n  //     this.genealogy_inheritance = [];\r\n  //   }\r\n  //   return this.genealogy_inheritance;\r\n  // };\r\n}\r\n","export default class Person {\r\n  _id: number;\r\n  _personName = \"\";\r\n  _undividedEstateSpouse: Person | undefined;\r\n  _deceased = false;\r\n  _spouse: Person | undefined;\r\n  _cohabitant: Person | undefined;\r\n  _childrenRearing: boolean | undefined;\r\n  _underAge: boolean | undefined;\r\n\r\n  constructor(personid: string, id = 1) {\r\n    this._personName = personid;\r\n    this._id = id;\r\n  }\r\n\r\n  get person_id(): string {\r\n    return this._personName;\r\n  }\r\n\r\n  set person_id(value: string) {\r\n    this._personName = value;\r\n  }\r\n\r\n  get deceased(): boolean {\r\n    return this._deceased;\r\n  }\r\n\r\n  set deceased(value: boolean) {\r\n    this._deceased = value;\r\n  }\r\n\r\n  get undividedEstateSpouse(): Person | undefined {\r\n    return this._undividedEstateSpouse;\r\n  }\r\n\r\n  set undividedEstateSpouse(value: Person | undefined) {\r\n    this._undividedEstateSpouse = value;\r\n  }\r\n\r\n  get spouse(): Person | undefined {\r\n    return this._spouse;\r\n  }\r\n\r\n  set_spouse = (spouse: Person, add_for_both = true): void => {\r\n    if (!this._spouse) console.log(this._spouse == spouse);\r\n    else this._spouse = spouse;\r\n    if (add_for_both) spouse.set_spouse(this, false);\r\n  };\r\n\r\n  hasSurvivingSpouse = (): boolean => {\r\n    if (this._spouse !== undefined && !this._spouse._deceased) return true;\r\n    else return false;\r\n  };\r\n\r\n  get cohabitant(): Person | undefined {\r\n    return this._cohabitant;\r\n  }\r\n\r\n  set_cohabitant = (cohabitant: Person, add_for_both = true): void => {\r\n    if (!this._cohabitant) console.log(this._cohabitant == cohabitant);\r\n    else this._cohabitant = cohabitant;\r\n    if (add_for_both) cohabitant.set_cohabitant(this, false);\r\n  };\r\n\r\n  static getPerson = (id: number, personMap: Map<number, Person>) => {\r\n    const person: Person | undefined = personMap.get(id);\r\n    if (person == undefined) {\r\n      throw new Error(\"Person not found with given id:\" + id);\r\n    }\r\n    return person;\r\n  };\r\n\r\n  has_surviving_cohabitant(): boolean {\r\n    if (this._cohabitant && !this._cohabitant._deceased) return true;\r\n    else return false;\r\n  }\r\n}\r\n","import ActionProvider from '../ActionProvider';\r\nimport { ChatbotInterface } from '../Generics';\r\nimport { NodeEntity } from '../Helper/Classes/NodeEntity';\r\nimport Person from '../Helper/Classes/Person';\r\nimport { ChatStepTypes, QuestionType } from '../Helper/Enums/ChatStepTypes';\r\nimport QuestionConstants from '../Helper/Methods/QuestionConstants';\r\nimport {\r\n    add_parent,\r\n    askFinalQuestion,\r\n    createEmptyNode,\r\n    createNewPerson,\r\n    getNode,\r\n    getParentChildrenIDStrings,\r\n    getPerson,\r\n    get_class_and_distance_closest_surviving_relative,\r\n    handleClosingStep,\r\n} from './OtherChatbotMethods';\r\nimport _ from 'lodash';\r\nimport { ParentChildSelector } from '../Helper/Enums/ParentChildSelector';\r\n\r\nexport const handleSuccessorCnt = (\r\n    res: string,\r\n    state: any,\r\n    actionProvider: ActionProvider,\r\n) => {\r\n    const successorCount = parseInt(res);\r\n    state.temp_person._childCount = successorCount;\r\n    if (successorCount === 0) {\r\n        const parentID = state.temp_person.getParentId(state.nodeMap);\r\n        if (parentID) {\r\n            const parent = getNode(parentID, state.nodeMap);\r\n            state.temp_person = parent;\r\n            const successorProcessArray = state.successorProcessArray;\r\n            state = handleNoSuccessorCase(\r\n                state,\r\n                successorProcessArray,\r\n                actionProvider,\r\n            );\r\n        } else {\r\n            state = handleClosingStep(state, actionProvider);\r\n        }\r\n        return state;\r\n    }\r\n\r\n    const questionType = state.temp_person._children.length === 0;\r\n    let itr_id = state.id;\r\n    for (let i = 0; i < state.temp_person._childCount; i++) {\r\n        const child = createEmptyNode(state, itr_id++);\r\n        state.temp_person.add_child(child, true);\r\n        if (state.temp_person._partnerNode !== null) {\r\n            const currentPartnerNode = getNode(\r\n                state.temp_person._partnerNode,\r\n                state.nodeMap,\r\n            );\r\n            currentPartnerNode.add_child(child, true, true);\r\n            currentPartnerNode.updateProcessChildNodePos();\r\n        }\r\n    }\r\n    state.id = itr_id;\r\n    if (\r\n        state.successorProcessArray.filter(\r\n            (t: any) => t[0] === state.temp_person._level,\r\n        ).length === 0\r\n    ) {\r\n        state.successorProcessArray.push([state.temp_person._level, 1]);\r\n    }\r\n\r\n    state.successor_flag = QuestionType.part1;\r\n    const personName = getPerson(\r\n        state.temp_person._id,\r\n        state.personsMap,\r\n    )._personName;\r\n    if (questionType) {\r\n        const newSuccessorQuestion = actionProvider.createChatBotMessage(\r\n            QuestionConstants.addSuccessorQuestion1(personName),\r\n        );\r\n        state = actionProvider.addMessageToBotState(\r\n            newSuccessorQuestion,\r\n            state,\r\n        );\r\n    } else {\r\n        const allChildrenID = getParentChildrenIDStrings(\r\n            state.temp_person._children,\r\n            state,\r\n        );\r\n        const newSuccessorQuestion = actionProvider.createChatBotMessage(\r\n            QuestionConstants.addSuccessorQuestion2(personName, allChildrenID),\r\n        );\r\n        state = actionProvider.addMessageToBotState(\r\n            newSuccessorQuestion,\r\n            state,\r\n        );\r\n    }\r\n    return state;\r\n};\r\n\r\nexport const handleSuccessorInput = (\r\n    res: string,\r\n    state: any,\r\n    actionProvider: ActionProvider,\r\n) => {\r\n    const childID = state.temp_person.getChildUnprocessedNode();\r\n    if (childID) {\r\n        const child = getNode(childID, state.nodeMap);\r\n        const childDetail = getPerson(childID, state.personsMap);\r\n        childDetail._personName = res;\r\n        state = {\r\n            ...state,\r\n            successor_flag: QuestionType.part2,\r\n            temp_child: child,\r\n        };\r\n\r\n        const personId: any = Person.getPerson(\r\n            child._id,\r\n            state.personsMap,\r\n        )?._personName;\r\n        const aliveQuestion = actionProvider.createChatBotMessage(\r\n            QuestionConstants.AliveQuestion(personId),\r\n            QuestionConstants.YesNoWidgetOptions,\r\n        );\r\n        state = actionProvider.addMessageToBotState(aliveQuestion, state);\r\n        // }\r\n    } else {\r\n        // error case\r\n        console.log('Count of children exceeded');\r\n    }\r\n    return state;\r\n};\r\n\r\nconst handleNoSuccessorCase = (\r\n    state: any,\r\n    successorProcessArray: Array<[number, number]>,\r\n    actionProvider: ActionProvider,\r\n) => {\r\n    const childItrPos =\r\n        successorProcessArray[successorProcessArray.length - 1][1];\r\n    if (childItrPos) {\r\n        if (state.temp_person._childCount > childItrPos) {\r\n            successorProcessArray[successorProcessArray.length - 1][1] =\r\n                childItrPos + 1;\r\n            // ask childid question\r\n            state.successor_flag = QuestionType.part1;\r\n            const allChildrenID = getParentChildrenIDStrings(\r\n                state.temp_person._children,\r\n                state,\r\n            );\r\n            const newSuccessorQuestion = actionProvider.createChatBotMessage(\r\n                QuestionConstants.addSuccessorQuestion2(\r\n                    getPerson(state.temp_person._id, state.personsMap)\r\n                        ._personName,\r\n                    allChildrenID,\r\n                ),\r\n            );\r\n            state = actionProvider.addMessageToBotState(\r\n                newSuccessorQuestion,\r\n                state,\r\n            );\r\n        } else if (state.temp_person._childCount === childItrPos) {\r\n            let currentParentID = state.temp_person._id;\r\n            let currentParent = NodeEntity.getNode(\r\n                currentParentID,\r\n                state.nodeMap,\r\n            );\r\n\r\n            let isCurrentParentID = true;\r\n            while (\r\n                successorProcessArray[successorProcessArray.length - 1][1] ===\r\n                currentParent._childCount\r\n            ) {\r\n                successorProcessArray.pop();\r\n                // current parent update\r\n                const currentId = currentParent.getParentId(state.nodeMap);\r\n                if (currentId) {\r\n                    currentParentID = currentId;\r\n                    currentParent = NodeEntity.getNode(\r\n                        currentParentID,\r\n                        state.nodeMap,\r\n                    );\r\n                } else {\r\n                    isCurrentParentID = false;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if (!isCurrentParentID) {\r\n                // exit case\r\n                return handleClosingStep(state, actionProvider);\r\n            } else {\r\n                successorProcessArray[successorProcessArray.length - 1][1] =\r\n                    successorProcessArray[successorProcessArray.length - 1][1] +\r\n                    1;\r\n                // ask childid question\r\n                state.temp_person = currentParent;\r\n                const currentParentDetail = getPerson(\r\n                    currentParentID,\r\n                    state.personsMap,\r\n                );\r\n                state.successor_flag = QuestionType.part1;\r\n                const allChildrenID = getParentChildrenIDStrings(\r\n                    currentParent._children,\r\n                    state,\r\n                );\r\n                const newSuccessorQuestion =\r\n                    actionProvider.createChatBotMessage(\r\n                        QuestionConstants.addSuccessorQuestion2(\r\n                            currentParentDetail._personName,\r\n                            allChildrenID,\r\n                        ),\r\n                    );\r\n                state = actionProvider.addMessageToBotState(\r\n                    newSuccessorQuestion,\r\n                    state,\r\n                );\r\n            }\r\n        } else {\r\n            throw new Error('state.temp_person._childCount < childItrPos case');\r\n        }\r\n    } else {\r\n        throw new Error('childItrPos is null');\r\n    }\r\n    return state;\r\n};\r\n\r\nexport const handleChildAliveOption = (\r\n    res: boolean,\r\n    state: any,\r\n    actionProvider: ActionProvider,\r\n) => {\r\n    const child = state.temp_child;\r\n    const childDetail = getPerson(child._id, state.personsMap);\r\n    // const temp_person: NodeEntity = state.temp_person\r\n    const successorProcessArray = state.successorProcessArray;\r\n    if (res) {\r\n        childDetail._deceased = false;\r\n        state = handleNoSuccessorCase(\r\n            state,\r\n            successorProcessArray,\r\n            actionProvider,\r\n        );\r\n    } else {\r\n        // not alive\r\n        childDetail._deceased = true;\r\n        if (state.stepID === ChatStepTypes.grandParentStep) {\r\n            const generationCount = child.getGenerationCount();\r\n            if (generationCount === 2) {\r\n                state = handleNoSuccessorCase(\r\n                    state,\r\n                    successorProcessArray,\r\n                    actionProvider,\r\n                );\r\n                return state;\r\n            }\r\n        }\r\n        state = {\r\n            ...state,\r\n            successor_flag: QuestionType.part3,\r\n            temp_person: child,\r\n        };\r\n        const newSuccessorQuestion = actionProvider.createChatBotMessage(\r\n            QuestionConstants.addSuccessorCount(childDetail._personName),\r\n        );\r\n        state = actionProvider.addMessageToBotState(\r\n            newSuccessorQuestion,\r\n            state,\r\n        );\r\n    }\r\n    return state;\r\n};\r\n\r\nexport const handleSecondParentExists = (\r\n    res: boolean,\r\n    state: any,\r\n    actionProvider: ActionProvider,\r\n) => {\r\n    if (res) {\r\n        const temp_person = state.temp_person;\r\n        state = {\r\n            ...state,\r\n            parent_flag: QuestionType.part1,\r\n        };\r\n        const allParentsID = getParentChildrenIDStrings(\r\n            temp_person._parents,\r\n            state,\r\n        );\r\n        const temp_person_detail = getPerson(temp_person._id, state.personsMap);\r\n        const newParentQuestion = actionProvider.createChatBotMessage(\r\n            QuestionConstants.addParentsQuestion2(\r\n                temp_person_detail._personName,\r\n                allParentsID,\r\n            ),\r\n        );\r\n        state = actionProvider.addMessageToBotState(newParentQuestion, state);\r\n    } else {\r\n        state = handleClosingStep(state, actionProvider, false);\r\n        // if (state.stepID !== ChatStepTypes.grandParentStep) {\r\n        //   actionProvider.closestSurvivingRelativeParents(false);\r\n        // } else {\r\n        //   actionProvider.closestSurvivingRelativeGrandParents(false);\r\n        // }\r\n    }\r\n    return state;\r\n};\r\n\r\nexport const handleParentsInput = (\r\n    res: string,\r\n    state: any,\r\n    actionProvider: ActionProvider,\r\n) => {\r\n    const predecessor_id = res;\r\n    const predecessor = createNewPerson(predecessor_id, state, actionProvider);\r\n\r\n    state = {\r\n        ...state,\r\n        parent_flag: QuestionType.part2,\r\n        temp_parent: predecessor,\r\n    };\r\n    state = { ...state };\r\n    const temp_person = state.temp_person;\r\n    // temp_person.add_parent(predecessor, true);\r\n    state = add_parent(predecessor, state, true);\r\n    state = { ...state };\r\n    const aliveQuestion = actionProvider.createChatBotMessage(\r\n        QuestionConstants.AliveQuestion(\r\n            Person.getPerson(predecessor._id, state.personsMap)._personName,\r\n        ),\r\n        QuestionConstants.YesNoWidgetOptions,\r\n    );\r\n    state = actionProvider.addMessageToBotState(aliveQuestion, state);\r\n\r\n    return state;\r\n};\r\n\r\nexport const handleParentAliveOption = (\r\n    res: boolean,\r\n    state: any,\r\n    actionProvider: ActionProvider,\r\n) => {\r\n    const temp_parent = state.temp_parent;\r\n    const temp_parent_detail = Person.getPerson(\r\n        temp_parent._id,\r\n        state.personsMap,\r\n    );\r\n    if (!res) {\r\n        temp_parent_detail._deceased = true;\r\n        state = {\r\n            ...state,\r\n            temp_person: temp_parent,\r\n            successor_flag: QuestionType.part3,\r\n        };\r\n        temp_parent._processChildNodePos += 1;\r\n        const allChildrenID = getParentChildrenIDStrings(\r\n            temp_parent._children,\r\n            state,\r\n        );\r\n        const newSuccessorQuestion = actionProvider.createChatBotMessage(\r\n            QuestionConstants.addSuccessorOfParentCount(\r\n                temp_parent_detail._personName,\r\n                allChildrenID,\r\n            ),\r\n        );\r\n        state = actionProvider.addMessageToBotState(\r\n            newSuccessorQuestion,\r\n            state,\r\n        );\r\n        // return state;\r\n    } else {\r\n        temp_parent_detail._deceased = false;\r\n        state = handleClosingStep(state, actionProvider);\r\n        // if (state.stepID !== ChatStepTypes.grandParentStep) {\r\n        //   actionProvider.closestSurvivingRelativeParents();\r\n        // } else {\r\n        //   actionProvider.closestSurvivingRelativeGrandParents();\r\n        // }\r\n    }\r\n    return state;\r\n};\r\n\r\nexport const handleGrandParentFirst = (\r\n    state: any,\r\n    actionProvider: ActionProvider,\r\n) => {\r\n    const testatorNode = NodeEntity.getNode(state.person._id, state.nodeMap);\r\n    if (!state.deceasedParentsArray) state.deceasedParentsArray = [];\r\n\r\n    for (const parent_id of testatorNode._parents) {\r\n        if (Person.getPerson(parent_id, state.personsMap)._deceased) {\r\n            const temp_class =\r\n                get_class_and_distance_closest_surviving_relative(\r\n                    NodeEntity.getNode(parent_id, state.nodeMap),\r\n                    state,\r\n                )[0];\r\n            if (temp_class !== 1) {\r\n                if (!state.deceasedParentsArray.includes(parent_id))\r\n                    state.deceasedParentsArray.push(parent_id);\r\n            }\r\n        }\r\n    }\r\n    if (state.deceasedParentsArray.length !== 0) {\r\n        const temp_person = getNode(\r\n            state.deceasedParentsArray[0],\r\n            state.nodeMap,\r\n        );\r\n        const temp_person_detail = getPerson(\r\n            state.deceasedParentsArray[0],\r\n            state.personsMap,\r\n        );\r\n        state = {\r\n            ...state,\r\n            stepID: ChatStepTypes.grandParentStep,\r\n            parent_flag: QuestionType.part1,\r\n            temp_person: temp_person,\r\n            successor_flag: QuestionType.initialQuestion,\r\n        };\r\n        const newParentQuestion = actionProvider.createChatBotMessage(\r\n            QuestionConstants.addParentsQuestion1(\r\n                temp_person_detail._personName,\r\n            ),\r\n        );\r\n        state = actionProvider.addMessageToBotState(newParentQuestion, state);\r\n    } else {\r\n        console.log('check situation if it arrives here');\r\n        state = askFinalQuestion(state, actionProvider);\r\n    }\r\n    return state;\r\n};\r\n\r\nexport const handleAskForNextGrandParent = (\r\n    state: any,\r\n    actionProvider: ActionProvider,\r\n) => {\r\n    if (state.deceasedParentsArray.length !== 0) {\r\n        const temp_person = getNode(\r\n            state.deceasedParentsArray[0],\r\n            state.nodeMap,\r\n        );\r\n        const temp_person_detail = getPerson(\r\n            state.deceasedParentsArray[0],\r\n            state.personsMap,\r\n        );\r\n        state = {\r\n            ...state,\r\n            stepID: ChatStepTypes.grandParentStep,\r\n            parent_flag: QuestionType.part1,\r\n            temp_person: temp_person,\r\n            successor_flag: QuestionType.initialQuestion,\r\n        };\r\n        const newParentQuestion = actionProvider.createChatBotMessage(\r\n            QuestionConstants.addParentsQuestion1(\r\n                temp_person_detail._personName,\r\n            ),\r\n        );\r\n        state = actionProvider.addMessageToBotState(newParentQuestion, state);\r\n    } else {\r\n        state = askFinalQuestion(state, actionProvider);\r\n    }\r\n    return state;\r\n};\r\n\r\nexport const handleMarriedParents = (\r\n    res: boolean,\r\n    state: any,\r\n    actionProvider: ActionProvider,\r\n) => {\r\n    if (res) {\r\n        actionProvider.set_spouse(\r\n            state.person._parents[0],\r\n            state.person._parents[1],\r\n            true,\r\n            state,\r\n        );\r\n        state = askFinalQuestion(state, actionProvider);\r\n    } else {\r\n        state = askFinalQuestion(state, actionProvider);\r\n    }\r\n    return state;\r\n};\r\n","import ActionProvider from '../ActionProvider';\r\nimport Person from '../Helper/Classes/Person';\r\nimport {\r\n    ChatStepTypes,\r\n    QuestionType,\r\n    undividedOwnershipType,\r\n} from '../Helper/Enums/ChatStepTypes';\r\nimport { ParentChildSelector } from '../Helper/Enums/ParentChildSelector';\r\nimport {\r\n    CurrencyOutput,\r\n    ParseCurrencyStringForOutput,\r\n} from '../Helper/Methods/HandleCurrency';\r\nimport QuestionConstants from '../Helper/Methods/QuestionConstants';\r\nimport {\r\n    askFinalQuestion,\r\n    createNewPerson,\r\n    getNode,\r\n    getPerson,\r\n    get_class_and_distance_closest_surviving_relative,\r\n} from './OtherChatbotMethods';\r\n\r\nexport const undividedEstateChoice = (\r\n    undividedEstateChoiceResponse: boolean,\r\n    state: any,\r\n    actionProvider: ActionProvider,\r\n) => {\r\n    if (undividedEstateChoiceResponse) {\r\n        state = {\r\n            ...state,\r\n            stepID: ChatStepTypes.undividedEstateStep,\r\n            undividedEstate: {\r\n                ...state.undividedEstate,\r\n                undivided_flag: QuestionType.part1,\r\n                undividedEstateChoice: undividedEstateChoiceResponse,\r\n            },\r\n        };\r\n        const totalEstateNetValueQuestion = actionProvider.createChatBotMessage(\r\n            QuestionConstants.TotalEstateNetValueQuestion,\r\n        );\r\n        state = actionProvider.addMessageToBotState(\r\n            totalEstateNetValueQuestion,\r\n            state,\r\n        );\r\n    } else {\r\n        state = {\r\n            ...state,\r\n            stepID: ChatStepTypes.netWealthStep,\r\n            undividedEstate: {\r\n                ...state.undividedEstate,\r\n                undivided_flag: 'none',\r\n                undividedEstateChoice: undividedEstateChoiceResponse,\r\n            },\r\n        };\r\n        const netWealthQuestion = actionProvider.createChatBotMessage(\r\n            QuestionConstants.NetWealthQuestion,\r\n        );\r\n        state = actionProvider.addMessageToBotState(netWealthQuestion, state);\r\n    }\r\n    return state;\r\n};\r\n\r\nexport const totalEstateValue = (\r\n    totalEstateValueResponse: string,\r\n    state: any,\r\n    actionProvider: ActionProvider,\r\n) => {\r\n    const totalEstateValueQuestion = actionProvider.createChatBotMessage(\r\n        QuestionConstants.TotalEstateNetValueQuestion,\r\n    );\r\n    const currencyIntResponse = CurrencyOutput(totalEstateValueResponse);\r\n    const currencyStringResponse = ParseCurrencyStringForOutput(\r\n        currencyIntResponse[1],\r\n    );\r\n    const currencyJSX = <div>{currencyStringResponse}</div>;\r\n    if (currencyIntResponse[0] === 5) {\r\n        const ownershipTypeQuestion = actionProvider.createChatBotMessage(\r\n            QuestionConstants.OwnershipTypeQuestion,\r\n            QuestionConstants.OwnershipQuestionWidgetOptions,\r\n        );\r\n        state = {\r\n            ...state,\r\n            undividedEstate: {\r\n                ...state.undividedEstate,\r\n                undivided_flag: QuestionType.part2,\r\n                totalEstateValue: parseInt(currencyIntResponse[1]),\r\n            },\r\n        };\r\n        state.messages.pop();\r\n        const currencyCustom = actionProvider.createClientMessage(currencyJSX);\r\n        state = actionProvider.addMessageToBotState(currencyCustom, state);\r\n        state = actionProvider.addMessageToBotState(\r\n            ownershipTypeQuestion,\r\n            state,\r\n        );\r\n    } else {\r\n        const totalEstateWarning = actionProvider.createChatBotMessage(\r\n            QuestionConstants.TotalEstateNetValueWarning,\r\n        );\r\n\r\n        state = actionProvider.addMessageToBotState(totalEstateWarning, state);\r\n        state = actionProvider.addMessageToBotState(\r\n            totalEstateValueQuestion,\r\n            state,\r\n        );\r\n    }\r\n    return state;\r\n};\r\n\r\nexport const undividedOwnershipResponse = (\r\n    ownershipResponse: string,\r\n    state: any,\r\n    actionProvider: ActionProvider,\r\n) => {\r\n    if (ownershipResponse === undividedOwnershipType.felleseie) {\r\n        state = {\r\n            ...state,\r\n            undividedEstate: {\r\n                ...state.undividedEstate,\r\n                undivided_flag: QuestionType.part6,\r\n                undividedEstateSeparateWealth:\r\n                    state.undividedEstate.totalEstateValue / 2,\r\n                ownershipType: undividedOwnershipType.felleseie,\r\n            },\r\n\r\n            netWealth: state.undividedEstate.totalEstateValue / 2,\r\n        };\r\n        if (state.undividedEstate.undividedEstateSeparateWealth > 0) {\r\n            const undividedEstateSpouseQuestion =\r\n                actionProvider.createChatBotMessage(\r\n                    QuestionConstants.UndividedEstateSpouseQuestion,\r\n                );\r\n            state = actionProvider.addMessageToBotState(\r\n                undividedEstateSpouseQuestion,\r\n                state,\r\n            );\r\n        } else {\r\n            if (\r\n                state.person !== state.testator &&\r\n                state.person._undividedEstateSpouse\r\n            ) {\r\n                const temp_class_undivided_spouse =\r\n                    get_class_and_distance_closest_surviving_relative(\r\n                        getNode(\r\n                            state.person._undividedEstateSpouse,\r\n                            state.nodeMap,\r\n                        ),\r\n                        state,\r\n                    )[0];\r\n                if (temp_class_undivided_spouse === undefined) {\r\n                    state.netWealth =\r\n                        state.netWealth +\r\n                        state.undividedEstate.undividedEstateSeparateWealth;\r\n                    state.undividedEstate.undividedEstateSeparateWealth = 0;\r\n                }\r\n\r\n                if (state.netWealth <= 0) {\r\n                    state = askFinalQuestion(state, actionProvider);\r\n                } else {\r\n                    state = {\r\n                        ...state,\r\n                        stepID: ChatStepTypes.underAgeStep,\r\n                    };\r\n\r\n                    const underAgeQuestion =\r\n                        actionProvider.createChatBotMessage(\r\n                            QuestionConstants.UnderAgeQuestion,\r\n                            QuestionConstants.YesNoWidgetOptions,\r\n                        );\r\n                    state = actionProvider.addMessageToBotState(\r\n                        underAgeQuestion,\r\n                        state,\r\n                    );\r\n                    return state;\r\n                }\r\n            }\r\n        }\r\n    } else if (ownershipResponse === 'DELVIS SREIE') {\r\n        state = {\r\n            ...state,\r\n            undividedEstate: {\r\n                ...state.undividedEstate,\r\n                undivided_flag: QuestionType.part3,\r\n            },\r\n        };\r\n        const delvisFirstQuestion = actionProvider.createChatBotMessage(\r\n            QuestionConstants.DelvisFirstQuestion,\r\n        );\r\n        state = actionProvider.addMessageToBotState(delvisFirstQuestion, state);\r\n    } else if (ownershipResponse === 'FULLT SREIE') {\r\n        state = {\r\n            ...state,\r\n            undividedEstate: {\r\n                ...state.undividedEstate,\r\n                undivided_flag: QuestionType.part5,\r\n            },\r\n        };\r\n        const fulltSaereieQuestion = actionProvider.createChatBotMessage(\r\n            QuestionConstants.FulltSaereieQuestion,\r\n        );\r\n        state = actionProvider.addMessageToBotState(\r\n            fulltSaereieQuestion,\r\n            state,\r\n        );\r\n    } else {\r\n        const ownershipTypeWarning = actionProvider.createChatBotMessage(\r\n            QuestionConstants.OwnershipTypeWarning,\r\n        );\r\n        const ownershipTypeQuestion = actionProvider.createChatBotMessage(\r\n            QuestionConstants.OwnershipTypeQuestion,\r\n            QuestionConstants.OwnershipQuestionWidgetOptions,\r\n        );\r\n        state = actionProvider.addMessageToBotState(\r\n            ownershipTypeWarning,\r\n            state,\r\n        );\r\n        state = actionProvider.addMessageToBotState(\r\n            ownershipTypeQuestion,\r\n            state,\r\n        );\r\n    }\r\n    return state;\r\n};\r\n\r\nexport const delvisFirstResponse = (\r\n    response: string,\r\n    state: any,\r\n    actionProvider: ActionProvider,\r\n) => {\r\n    const currencyIntResponse = CurrencyOutput(response);\r\n    const currencyStringResponse = ParseCurrencyStringForOutput(\r\n        currencyIntResponse[1],\r\n    );\r\n    const currencyJSX = <div>{currencyStringResponse}</div>;\r\n    if (currencyIntResponse[0] === 5) {\r\n        state.messages.pop();\r\n        const currencyCustom = actionProvider.createClientMessage(currencyJSX);\r\n        state = actionProvider.addMessageToBotState(currencyCustom, state);\r\n        state = {\r\n            ...state,\r\n            undividedEstate: {\r\n                ...state.undividedEstate,\r\n                undivided_flag: QuestionType.part4,\r\n                temp_first: parseInt(currencyIntResponse[1]),\r\n            },\r\n        };\r\n        const delvisSecondQuestion = actionProvider.createChatBotMessage(\r\n            QuestionConstants.DelvisSecondQuestion,\r\n        );\r\n        state = actionProvider.addMessageToBotState(\r\n            delvisSecondQuestion,\r\n            state,\r\n        );\r\n    } else {\r\n        const netWealthWarning = actionProvider.createChatBotMessage(\r\n            QuestionConstants.NetWealthWarning,\r\n        );\r\n        const delvisFirstQuestion = actionProvider.createChatBotMessage(\r\n            QuestionConstants.DelvisFirstQuestion,\r\n        );\r\n        state = actionProvider.addMessageToBotState(netWealthWarning, state);\r\n        state = actionProvider.addMessageToBotState(delvisFirstQuestion, state);\r\n    }\r\n    return state;\r\n};\r\n\r\nexport const delvisSecondResponse = (\r\n    res: string,\r\n    state: any,\r\n    actionProvider: ActionProvider,\r\n) => {\r\n    const currencyIntResponse = CurrencyOutput(res);\r\n    const currencyStringResponse = ParseCurrencyStringForOutput(\r\n        currencyIntResponse[1],\r\n    );\r\n    const currencyJSX = <div>{currencyStringResponse}</div>;\r\n    if (currencyIntResponse[0] === 5) {\r\n        state.messages.pop();\r\n        const currencyCustom = actionProvider.createClientMessage(currencyJSX);\r\n        state = actionProvider.addMessageToBotState(currencyCustom, state);\r\n        state.undividedEstate.temp_last = parseInt(currencyIntResponse[1]);\r\n        state = {\r\n            ...state,\r\n            undividedEstate: {\r\n                ...state.undividedEstate,\r\n                undivided_flag: QuestionType.part6,\r\n                undividedEstateSeparateWealth:\r\n                    (state.undividedEstate.totalEstateValue -\r\n                        state.undividedEstate.temp_last -\r\n                        state.undividedEstate.temp_first) /\r\n                        2 +\r\n                    state.undividedEstate.temp_first,\r\n            },\r\n            netWealth:\r\n                (state.undividedEstate.totalEstateValue -\r\n                    state.undividedEstate.temp_last -\r\n                    state.undividedEstate.temp_first) /\r\n                    2 +\r\n                state.undividedEstate.temp_last,\r\n        };\r\n        const undividedEstateSpouseQuestion =\r\n            actionProvider.createChatBotMessage(\r\n                QuestionConstants.UndividedEstateSpouseQuestion,\r\n            );\r\n        state = actionProvider.addMessageToBotState(\r\n            undividedEstateSpouseQuestion,\r\n            state,\r\n        );\r\n    } else {\r\n        const netWealthWarning = actionProvider.createChatBotMessage(\r\n            QuestionConstants.NetWealthWarning,\r\n        );\r\n        const delvisSecondQuestion = actionProvider.createChatBotMessage(\r\n            QuestionConstants.DelvisSecondQuestion,\r\n        );\r\n        state = actionProvider.addMessageToBotState(netWealthWarning, state);\r\n        state = actionProvider.addMessageToBotState(\r\n            delvisSecondQuestion,\r\n            state,\r\n        );\r\n    }\r\n    return state;\r\n};\r\n\r\nexport const delvisFulltResponse = (\r\n    res: string,\r\n    state: any,\r\n    actionProvider: ActionProvider,\r\n) => {\r\n    const currencyIntResponse = CurrencyOutput(res);\r\n    const currencyStringResponse = ParseCurrencyStringForOutput(\r\n        currencyIntResponse[1],\r\n    );\r\n    const currencyJSX = <div>{currencyStringResponse}</div>;\r\n    if (currencyIntResponse[0] === 5) {\r\n        state.messages.pop();\r\n        const currencyCustom = actionProvider.createClientMessage(currencyJSX);\r\n        state = actionProvider.addMessageToBotState(currencyCustom, state);\r\n        state = {\r\n            ...state,\r\n            undividedEstate: {\r\n                ...state.undividedEstate,\r\n                undivided_flag: QuestionType.part6,\r\n                undividedEstateSeparateWealth:\r\n                    state.undividedEstate.totalEstateValue - parseInt(res),\r\n            },\r\n            netWealth: parseInt(res),\r\n        };\r\n        if (state.undividedEstate.undividedEstateSeparateWealth > 0) {\r\n            const undividedEstateSpouseQuestion =\r\n                actionProvider.createChatBotMessage(\r\n                    QuestionConstants.UndividedEstateSpouseQuestion,\r\n                );\r\n            state = actionProvider.addMessageToBotState(\r\n                undividedEstateSpouseQuestion,\r\n                state,\r\n            );\r\n        }\r\n    } else {\r\n        const netWealthWarning = actionProvider.createChatBotMessage(\r\n            QuestionConstants.NetWealthWarning,\r\n        );\r\n        const fulltSaereieQuestion = actionProvider.createChatBotMessage(\r\n            QuestionConstants.FulltSaereieQuestion,\r\n        );\r\n        state = actionProvider.addMessageToBotState(netWealthWarning, state);\r\n        state = actionProvider.addMessageToBotState(\r\n            fulltSaereieQuestion,\r\n            state,\r\n        );\r\n    }\r\n    return state;\r\n};\r\n\r\nexport const undividedEstateSpouse = (\r\n    res: string,\r\n    state: any,\r\n    actionProvider: ActionProvider,\r\n) => {\r\n    const undividedSpouseID = res;\r\n\r\n    const newUndividedSpouse = createNewPerson(\r\n        undividedSpouseID,\r\n        state,\r\n        actionProvider,\r\n    );\r\n\r\n    state.person = newUndividedSpouse;\r\n    state.testator._undividedEstateSpouse = newUndividedSpouse._id;\r\n    state.testator.setPathforPartner(\r\n        ParentChildSelector.undividedSpouse,\r\n        newUndividedSpouse,\r\n    );\r\n    const newUndividedSpouseDetail = Person.getPerson(\r\n        newUndividedSpouse._id,\r\n        state.personsMap,\r\n    );\r\n    newUndividedSpouseDetail._deceased = true;\r\n    const textBeforeSucsrUndvdSpouse = actionProvider.createChatBotMessage(\r\n        QuestionConstants.TextBeforeSucsrUndvdSpouse,\r\n    );\r\n    state = actionProvider.addMessageToBotState(\r\n        textBeforeSucsrUndvdSpouse,\r\n        state,\r\n    );\r\n    state = {\r\n        ...state,\r\n        stepID: ChatStepTypes.undividedEstateStep,\r\n        successor_flag: QuestionType.part3,\r\n        temp_person: newUndividedSpouse,\r\n        undividedSpouseId: newUndividedSpouse._id,\r\n    };\r\n    newUndividedSpouse._partnerNode = state.testator._id;\r\n    const newSuccessorTogetherQuestion = actionProvider.createChatBotMessage(\r\n        QuestionConstants.undividedChildrenTogetherCount(),\r\n    );\r\n    state = actionProvider.addMessageToBotState(\r\n        newSuccessorTogetherQuestion,\r\n        state,\r\n    );\r\n    return state;\r\n};\r\nexport const handleUndividedStep = (\r\n    state: any,\r\n    actionProvider: ActionProvider,\r\n    isTwoParent: boolean,\r\n) => {\r\n    const testator = state.person;\r\n    const testatorDetail = Person.getPerson(testator._id, state.personsMap);\r\n    if (state.undividedEstate.undivided_flag === QuestionType.part6) {\r\n        state.undividedEstate.undivided_flag = QuestionType.part7;\r\n        state.person._partnerNode = null;\r\n        state.successor_flag = QuestionType.part3;\r\n        const newSuccessorUndvdSpouseQuestion =\r\n            actionProvider.createChatBotMessage(\r\n                QuestionConstants.undvdSpouseOtherSuccessorQuestion(),\r\n            );\r\n        state = actionProvider.addMessageToBotState(\r\n            newSuccessorUndvdSpouseQuestion,\r\n            state,\r\n        );\r\n    } else if (state.undividedEstate.undivided_flag === QuestionType.part7) {\r\n        const temp_class_undivided_spouse =\r\n            get_class_and_distance_closest_surviving_relative(\r\n                getNode(state.person._id, state.nodeMap),\r\n                state,\r\n            )[0];\r\n        if (temp_class_undivided_spouse !== 1) {\r\n            // ask parent of und spouse question\r\n            state.undividedEstate.undivided_flag = QuestionType.part8;\r\n            state.parent_flag = QuestionType.part1;\r\n            state.temp_person = state.person;\r\n            const newParentQuestion = actionProvider.createChatBotMessage(\r\n                QuestionConstants.addParentsQuestion1(\r\n                    testatorDetail._personName,\r\n                ),\r\n            );\r\n            state = actionProvider.addMessageToBotState(\r\n                newParentQuestion,\r\n                state,\r\n            );\r\n        } else {\r\n            state = askTestatorOtherChildrenQuestion(state, actionProvider);\r\n        }\r\n    } else {\r\n        if (isTwoParent && state.temp_person._parents.length < 2) {\r\n            state.successor_flag = QuestionType.initialQuestion;\r\n            state.parent_flag = QuestionType.part3;\r\n            const personName = getPerson(\r\n                state.temp_person._id,\r\n                state.personsMap,\r\n            )._personName;\r\n            const secondParentChoiceQuestion =\r\n                actionProvider.createChatBotMessage(\r\n                    QuestionConstants.askSecondParentChoiceQuestion(\r\n                        `${personName}`,\r\n                    ),\r\n                    QuestionConstants.YesNoWidgetOptions,\r\n                );\r\n            state = actionProvider.addMessageToBotState(\r\n                secondParentChoiceQuestion,\r\n                state,\r\n            );\r\n            return state;\r\n        }\r\n        if (state.testator._undividedEstateSpouse) {\r\n            const temp_class_undivided_spouse =\r\n                get_class_and_distance_closest_surviving_relative(\r\n                    getNode(\r\n                        state.testator._undividedEstateSpouse,\r\n                        state.nodeMap,\r\n                    ),\r\n                    state,\r\n                )[0];\r\n            if (temp_class_undivided_spouse === undefined) {\r\n                state.netWealth =\r\n                    state.netWealth +\r\n                    state.undividedEstate.undividedEstateSeparateWealth;\r\n                state.undividedEstate.undividedEstateSeparateWealth = 0;\r\n            }\r\n            if (state.netWealth <= 0) {\r\n                state = askFinalQuestion(state, actionProvider);\r\n                return state;\r\n            } else {\r\n                state = askTestatorOtherChildrenQuestion(state, actionProvider);\r\n            }\r\n        }\r\n    }\r\n    return state;\r\n};\r\n\r\nconst askTestatorOtherChildrenQuestion = (\r\n    state: any,\r\n    actionProvider: ActionProvider,\r\n) => {\r\n    state = {\r\n        ...state,\r\n        stepID: ChatStepTypes.testatorOtherChildStep,\r\n    };\r\n    state.successor_flag = QuestionType.part3;\r\n    state.person = state.testator;\r\n    state.temp_person = state.testator;\r\n    const testatorOtherSuccessorQuestion = actionProvider.createChatBotMessage(\r\n        QuestionConstants.testatorOtherSuccessorQuestion(),\r\n    );\r\n    state = actionProvider.addMessageToBotState(\r\n        testatorOtherSuccessorQuestion,\r\n        state,\r\n    );\r\n    return state;\r\n};\r\n","import { PDFDownloadLink } from '@react-pdf/renderer';\r\nimport { ReactElement } from 'react';\r\nimport { InheritanceCalculation } from '../../Reports/InheritanceCalculation';\r\nimport FinalDocument from '../../Reports/PDF/FinalDocument';\r\nimport { PliktdelsarvCalculation } from '../../Reports/PliktdelsarvCalculation';\r\nimport { UndividedCalculation } from '../../Reports/UndividedCalculation';\r\nimport ActionProvider from '../ActionProvider';\r\nimport { NodeEntity } from '../Helper/Classes/NodeEntity';\r\nimport Person from '../Helper/Classes/Person';\r\nimport { ChatStepTypes, QuestionType } from '../Helper/Enums/ChatStepTypes';\r\nimport { ParentChildSelector } from '../Helper/Enums/ParentChildSelector';\r\nimport InheritanceConstants from '../Helper/Methods/InheritanceConstants';\r\nimport QuestionConstants from '../Helper/Methods/QuestionConstants';\r\nimport { messageService } from '../services/ChatbotCommunicator';\r\nimport {\r\n    handleAskForNextGrandParent,\r\n    handleGrandParentFirst,\r\n} from './RelativeMethods';\r\nimport { handleAskUnderAgeQuestion } from './TestatorInformationMethods';\r\nimport { handleUndividedStep } from './UndividedEstateMethods';\r\nimport { createCustomMessage } from 'react-chatbot-kit';\r\n\r\nexport const handleFinalQuestion = (\r\n    state: any,\r\n    actionProvider: ActionProvider,\r\n) => {\r\n    const document = computeInheritances(state, actionProvider);\r\n    const pdfDownloadLink = (\r\n        <PDFDownloadLink\r\n            document={document}\r\n            fileName={\r\n                getPerson(state.testator._id, state.personsMap)._personName\r\n            }\r\n        >\r\n            {({ blob, url, loading, error }) =>\r\n                loading\r\n                    ? 'Loading document...'\r\n                    : error\r\n                    ? 'Error! Try again or contact us explaining your problem.'\r\n                    : 'Download Report!'\r\n            }\r\n        </PDFDownloadLink>\r\n    );\r\n\r\n    const message = createCustomMessage('', 'custom', {\r\n        payload: pdfDownloadLink,\r\n    });\r\n    state = actionProvider.addMessageToBotState(message, state);\r\n    blockInputAtFinalStep(state.stepID);\r\n    return state;\r\n};\r\n\r\nconst computeInheritances = (\r\n    state: any,\r\n    actionProvider: ActionProvider,\r\n): JSX.Element => {\r\n    const inheritanceCalculation = new InheritanceCalculation(\r\n        state.person,\r\n        actionProvider,\r\n        state,\r\n    );\r\n    inheritanceCalculation.computeMethod(1);\r\n    inheritanceCalculation.computeGenealogyInheritance(\r\n        state.testator._id,\r\n        state,\r\n    );\r\n\r\n    const pliktdelsarvCalculation = new PliktdelsarvCalculation(\r\n        state.person,\r\n        actionProvider,\r\n        state,\r\n    );\r\n    pliktdelsarvCalculation.computeMethod(2);\r\n    pliktdelsarvCalculation.computeGenealogyPliktInheritance(\r\n        state.testator._id,\r\n        state,\r\n    );\r\n\r\n    const undividedCalculation = new UndividedCalculation(\r\n        state.person,\r\n        actionProvider,\r\n        state,\r\n    );\r\n    undividedCalculation.computeMethod(3);\r\n    const document = (\r\n        <FinalDocument\r\n            inputData={{\r\n                inheritanceCalculation: inheritanceCalculation,\r\n                pliktdelsarvCalculation: pliktdelsarvCalculation,\r\n                undividedCalculation: undividedCalculation,\r\n            }}\r\n        />\r\n    );\r\n    return document;\r\n};\r\n\r\nexport const handleClosingStep = (\r\n    state: any,\r\n    actionProvider: ActionProvider,\r\n    isSecondParent = true,\r\n) => {\r\n    switch (state.stepID) {\r\n        case ChatStepTypes.successorStep:\r\n            state = handleClosestSurvivingRelativeChildren(\r\n                state,\r\n                actionProvider,\r\n            );\r\n            return state;\r\n        case ChatStepTypes.parentsStep:\r\n            state.temp_person = state.person;\r\n            state = handleClosestSurvivingRelativeParents(\r\n                isSecondParent,\r\n                state,\r\n                actionProvider,\r\n            );\r\n            return state;\r\n        case ChatStepTypes.undividedEstateStep:\r\n            state.temp_person = state.person;\r\n            state = handleUndividedStep(state, actionProvider, isSecondParent);\r\n            return state;\r\n        case ChatStepTypes.grandParentStep:\r\n            state.temp_person = getNode(\r\n                state.deceasedParentsArray[0],\r\n                state.nodeMap,\r\n            );\r\n            state = handleClosestSurvivingRelativeGrandParens(\r\n                isSecondParent,\r\n                state,\r\n                actionProvider,\r\n            );\r\n            return state;\r\n\r\n        case ChatStepTypes.testatorOtherChildStep:\r\n            state = handleAskUnderAgeQuestion(state, actionProvider);\r\n            return state;\r\n    }\r\n};\r\n\r\nexport const handleClosestSurvivingRelativeChildren = (\r\n    state: any,\r\n    actionProvider: ActionProvider,\r\n) => {\r\n    const testator = state.person;\r\n    const testatorDetail = Person.getPerson(testator._id, state.personsMap);\r\n    const temp_class_testator =\r\n        get_class_and_distance_closest_surviving_relative(\r\n            state.testator,\r\n            state,\r\n        )[0];\r\n\r\n    if (\r\n        state.person !== state.testator &&\r\n        state.testator._undividedEstateSpouse\r\n    ) {\r\n        if (!(temp_class_testator && temp_class_testator !== 1)) {\r\n            state = {\r\n                ...state,\r\n                parent_flag: QuestionType.part1,\r\n                successor_flag: QuestionType.initialQuestion,\r\n                isUndividedParent: true,\r\n            };\r\n            const newParentQuestion = actionProvider.createChatBotMessage(\r\n                QuestionConstants.addParentsQuestion1(\r\n                    testatorDetail._personName,\r\n                ),\r\n            );\r\n            state = actionProvider.addMessageToBotState(\r\n                newParentQuestion,\r\n                state,\r\n            );\r\n            return state;\r\n        }\r\n    }\r\n\r\n    if (temp_class_testator === 1) {\r\n        state = {\r\n            ...state,\r\n            stepID: ChatStepTypes.rearChildrenStep,\r\n        };\r\n\r\n        state = askFinalQuestion(state, actionProvider);\r\n        return state;\r\n    }\r\n\r\n    if (\r\n        testator._spouse !== null &&\r\n        state.netWealth <=\r\n            InheritanceConstants.MINIMUM_INHERITANCE_SPOUSE_VS_PARENTS\r\n    ) {\r\n        state = askFinalQuestion(state, actionProvider);\r\n        return state;\r\n    }\r\n\r\n    if (\r\n        testator._cohabitant !== null &&\r\n        state.netWealth <=\r\n            InheritanceConstants.MINIMUM_INHERITANCE_COHABITANT_VS_PARENTS\r\n    ) {\r\n        state = askFinalQuestion(state, actionProvider);\r\n        return state;\r\n    }\r\n    state = {\r\n        ...state,\r\n        stepID: ChatStepTypes.parentsStep,\r\n        parent_flag: QuestionType.part1,\r\n        temp_person: state.testator,\r\n        successor_flag: QuestionType.initialQuestion,\r\n    };\r\n    const newParentQuestion = actionProvider.createChatBotMessage(\r\n        QuestionConstants.addParentsQuestion1(testatorDetail._personName),\r\n    );\r\n    state = actionProvider.addMessageToBotState(newParentQuestion, state);\r\n    return state;\r\n};\r\n\r\nexport const handleClosestSurvivingRelativeParents = (\r\n    isSecondParent: boolean,\r\n    state: any,\r\n    actionProvider: ActionProvider,\r\n) => {\r\n    if (isSecondParent && state.temp_person._parents.length < 2) {\r\n        // TODO\r\n        state.successor_flag = QuestionType.initialQuestion;\r\n        state.parent_flag = QuestionType.part3;\r\n        const personName = getPerson(\r\n            state.temp_person._id,\r\n            state.personsMap,\r\n        )._personName;\r\n        const secondParentChoiceQuestion = actionProvider.createChatBotMessage(\r\n            QuestionConstants.askSecondParentChoiceQuestion(`${personName}`),\r\n            QuestionConstants.YesNoWidgetOptions,\r\n        );\r\n        state = actionProvider.addMessageToBotState(\r\n            secondParentChoiceQuestion,\r\n            state,\r\n        );\r\n        return state;\r\n    }\r\n\r\n    if (state.person._spouse !== null) {\r\n        state = askFinalQuestion(state, actionProvider);\r\n        return state;\r\n    }\r\n    const temp_class = get_class_and_distance_closest_surviving_relative(\r\n        state.person,\r\n        state,\r\n    )[0];\r\n    const eitherParentsDeceased =\r\n        state.person._parents.filter((p_id: any) => {\r\n            return Person.getPerson(p_id, state.personsMap)._deceased;\r\n        }).length !== 0;\r\n    const personDetail = Person.getPerson(state.person._id, state.personsMap);\r\n\r\n    if (\r\n        state.person._parents.length === 2 &&\r\n        eitherParentsDeceased &&\r\n        temp_class === 2\r\n    ) {\r\n        const parent1Detail = Person.getPerson(\r\n            state.person._parents[0],\r\n            state.personsMap,\r\n        );\r\n        const parent2Detail = Person.getPerson(\r\n            state.person._parents[1],\r\n            state.personsMap,\r\n        );\r\n        if (!personDetail._underAge) {\r\n            state = askFinalQuestion(state, actionProvider);\r\n            return state;\r\n        }\r\n        if (state.person._parents.length !== 2) {\r\n            state = askFinalQuestion(state, actionProvider);\r\n            return state;\r\n        }\r\n\r\n        if (parent1Detail._deceased) {\r\n            state = {\r\n                ...state,\r\n                stepID: ChatStepTypes.marriedParentsStep,\r\n            };\r\n            const marriedParentsQn = actionProvider.createChatBotMessage(\r\n                QuestionConstants.MarriedParents1(\r\n                    parent1Detail._personName,\r\n                    parent2Detail._personName,\r\n                ),\r\n            );\r\n            state = actionProvider.addMessageToBotState(\r\n                marriedParentsQn,\r\n                state,\r\n            );\r\n            return state;\r\n        } else {\r\n            state = {\r\n                ...state,\r\n                stepID: ChatStepTypes.marriedParentsStep,\r\n            };\r\n            const marriedParentsQn = actionProvider.createChatBotMessage(\r\n                QuestionConstants.MarriedParents2(\r\n                    parent1Detail._personName,\r\n                    parent2Detail._personName,\r\n                ),\r\n            );\r\n            state = actionProvider.addMessageToBotState(\r\n                marriedParentsQn,\r\n                state,\r\n            );\r\n            return state;\r\n        }\r\n    } else {\r\n        state = handleGrandParentFirst(state, actionProvider);\r\n        return state;\r\n    }\r\n};\r\n\r\nexport const handleClosestSurvivingRelativeGrandParens = (\r\n    isSecondParent: boolean,\r\n    state: any,\r\n    actionProvider: ActionProvider,\r\n) => {\r\n    if (isSecondParent && state.temp_person._parents.length < 2) {\r\n        // TODO\r\n        state.successor_flag = QuestionType.initialQuestion;\r\n        state.parent_flag = QuestionType.part3;\r\n        const grandparentName = getPerson(\r\n            state.temp_person._id,\r\n            state.personsMap,\r\n        );\r\n        const secondParentChoiceQuestion = actionProvider.createChatBotMessage(\r\n            QuestionConstants.askSecondParentChoiceQuestion(\r\n                `${grandparentName._personName}`,\r\n            ),\r\n            QuestionConstants.YesNoWidgetOptions,\r\n        );\r\n        state = actionProvider.addMessageToBotState(\r\n            secondParentChoiceQuestion,\r\n            state,\r\n        );\r\n        return state;\r\n    }\r\n    state.deceasedParentsArray = state.deceasedParentsArray.filter(\r\n        (item: any) => item !== state.deceasedParentsArray[0],\r\n    );\r\n    state = handleAskForNextGrandParent(state, actionProvider);\r\n    return state;\r\n};\r\n\r\nconst surviving_successor_distance = (\r\n    node: NodeEntity,\r\n    state: any,\r\n): number | undefined => {\r\n    const nodeDetail: Person = Person.getPerson(node._id, state.personsMap);\r\n\r\n    if (nodeDetail._deceased === false) return 0;\r\n    else if (node._children.length === 0) return undefined;\r\n    else {\r\n        const possible_distances: Array<number> = [];\r\n        for (const child_id of node._children) {\r\n            const temp = surviving_successor_distance(\r\n                NodeEntity.getNode(child_id, state.nodeMap),\r\n                state,\r\n            );\r\n            if (temp != undefined) {\r\n                possible_distances.push(1 + temp);\r\n            }\r\n        }\r\n        if (possible_distances.length === 0) return undefined;\r\n        else return Math.min(...possible_distances);\r\n    }\r\n};\r\n\r\nexport const get_class_and_distance_closest_surviving_relative = (\r\n    testatorNode: NodeEntity,\r\n    state: any,\r\n): [number | undefined, number | undefined] => {\r\n    const distance = surviving_successor_distance(testatorNode, state);\r\n    if (distance !== undefined) return [1, distance];\r\n    else if (testatorNode._parents.length == 0) return [undefined, undefined];\r\n    else {\r\n        const alternatives: Array<Array<number | undefined>> = [];\r\n        for (const parent_id of testatorNode._parents) {\r\n            alternatives.push(\r\n                get_class_and_distance_closest_surviving_relative(\r\n                    NodeEntity.getNode(parent_id, state.nodeMap),\r\n                    state,\r\n                ),\r\n            );\r\n        }\r\n\r\n        alternatives.sort((a, b) => {\r\n            if (a[0] != undefined && b[0] != undefined) return a[0] - b[0];\r\n            if (a[0] == undefined && b[0] != undefined) return 1;\r\n            return -1;\r\n        });\r\n        const [closest_alternative_class, closest_alternative_distance] =\r\n            alternatives[0];\r\n\r\n        if (closest_alternative_class == undefined) {\r\n            return [undefined, undefined];\r\n        }\r\n        return [closest_alternative_class + 1, closest_alternative_distance];\r\n    }\r\n};\r\n\r\nexport const createNewPerson = (\r\n    personID: string,\r\n    state: any,\r\n    actionProvider: ActionProvider,\r\n) => {\r\n    const newPerson = new Person(\r\n        personID,\r\n        actionProvider.generateNextID(state.id),\r\n    );\r\n    state.personsMap.set(newPerson._id, newPerson);\r\n    const newNode = new NodeEntity(newPerson._id, 0);\r\n    state.nodeMap.set(newNode._id, newNode);\r\n    return newNode;\r\n};\r\nexport const createEmptyNode = (state: any, id: number) => {\r\n    const newPerson = new Person('', id);\r\n    state.personsMap.set(newPerson._id, newPerson);\r\n    const newNode = new NodeEntity(newPerson._id, 0);\r\n    state.nodeMap.set(newNode._id, newNode);\r\n    return newNode;\r\n};\r\nexport const createTestator = (\r\n    personID: string,\r\n    state: any,\r\n    actionProvider: ActionProvider,\r\n) => {\r\n    const newPerson = new Person(\r\n        personID,\r\n        actionProvider.generateNextID(state.id),\r\n    );\r\n    newPerson._deceased = true;\r\n    state.personsMap.set(newPerson._id, newPerson);\r\n    const newNode = new NodeEntity(newPerson._id, 0);\r\n    newNode._path.push([ParentChildSelector.testator, newPerson._id]);\r\n    state.nodeMap.set(newNode._id, newNode);\r\n    return newNode;\r\n};\r\n\r\nexport const getPerson = (id: number, personMap: Map<number, Person>) => {\r\n    const person: Person | undefined = personMap.get(id);\r\n    if (person == undefined) {\r\n        throw new Error('Person not found with given id:' + id);\r\n    }\r\n    return person;\r\n};\r\n\r\nexport const getNode = (id: number, nodeMap: Map<number, NodeEntity>) => {\r\n    const node: NodeEntity | undefined = nodeMap.get(id);\r\n    if (node == undefined) {\r\n        throw new Error('Node not found with given id:' + id);\r\n    }\r\n    return node;\r\n};\r\nexport const add_parent = (\r\n    parent: NodeEntity,\r\n    state: any,\r\n    add_for_both = true,\r\n    grandParent = false,\r\n): void => {\r\n    // const parents_array = this._parents;\r\n    const parent_id = parent._id;\r\n    let isParentPresent = false;\r\n    const person = state.temp_person;\r\n    for (const p of person._parents) {\r\n        if (p === parent_id) {\r\n            isParentPresent = true;\r\n            break;\r\n        }\r\n    }\r\n\r\n    // const t = this._parents.find((obj) => obj === parent_id);\r\n    if (!isParentPresent) {\r\n        person._parents.push(parent_id);\r\n    }\r\n    parent._path = [...person._path];\r\n\r\n    parent._path.push([ParentChildSelector.parent, parent_id]);\r\n    parent._level = person.getLevel(parent._path);\r\n    if (parent._level === 2) {\r\n        parent._path[parent._path.length - 1][0] =\r\n            ParentChildSelector.grandParent;\r\n    }\r\n    if (add_for_both) {\r\n        if (!parent._children.find((obj) => obj === person._id)) {\r\n            parent._children.push(person._id);\r\n        }\r\n    }\r\n    return state;\r\n};\r\nexport const add_child = (\r\n    child: NodeEntity,\r\n    state: any,\r\n    add_for_both = true,\r\n    isPartner = false,\r\n): void => {\r\n    const partnerNode = state.temp_person._partnerNode;\r\n    const children_array = partnerNode._children;\r\n    const child_id = child._id;\r\n    if (!children_array.find((obj: any) => obj === child_id)) {\r\n        partnerNode._children.push(child_id);\r\n    }\r\n    if (!isPartner) {\r\n        child._path = [...partnerNode._path];\r\n        child._path.push([ParentChildSelector.child, child_id]);\r\n        child._level = partnerNode.getLevel(child._path);\r\n    } else {\r\n        child._partnerPath = [...partnerNode._path];\r\n        child._partnerPath.push([ParentChildSelector.child, child_id]);\r\n        // child._level = this.getLevel(child._path);\r\n    }\r\n    if (add_for_both) {\r\n        if (!child._parents.find((obj) => obj === partnerNode._id)) {\r\n            child._parents.push(partnerNode._id);\r\n        }\r\n    }\r\n};\r\n\r\nexport const askFinalQuestion = (\r\n    state: any,\r\n    actionProvider: ActionProvider,\r\n) => {\r\n    state = {\r\n        ...state,\r\n        stepID: ChatStepTypes.finalStep,\r\n    };\r\n    state = handleFinalQuestion(state, actionProvider);\r\n    return state;\r\n};\r\n\r\nexport const getParentChildrenIDStrings = (\r\n    collection: Array<number>,\r\n    state: any,\r\n): ReactElement => {\r\n    return (\r\n        <strong>{`{{ ${collection\r\n            .map(\r\n                (child_id) =>\r\n                    Person.getPerson(child_id, state.personsMap)._personName,\r\n            )\r\n            .filter((name) => name !== '')\r\n            .join(', ')} }}`}</strong>\r\n    );\r\n};\r\n\r\nexport const revertState = (actionProvider: ActionProvider) => {\r\n    const revertCount = localStorage.getItem('revertCount');\r\n    let lastState: any;\r\n    if (revertCount) {\r\n        lastState = messageService.getPreviousState(parseInt(revertCount));\r\n    } else {\r\n        lastState = messageService.getPreviousState(0);\r\n    }\r\n\r\n    if (lastState) {\r\n        if (revertCount) {\r\n            localStorage.setItem(\r\n                'revertCount',\r\n                (parseInt(revertCount) + 1).toString(),\r\n            );\r\n        } else {\r\n            localStorage.setItem('revertCount', '1');\r\n        }\r\n        actionProvider.setState((state: any) => {\r\n            state = lastState;\r\n            return actionProvider.returnState(state);\r\n        });\r\n    }\r\n};\r\n\r\nexport const clearBooleanOptions = () => {\r\n    const chatAreaElement = document.getElementsByClassName(\r\n        'react-chatbot-kit-chat-message-container',\r\n    )[0] as HTMLDivElement;\r\n    const buttonElementArray = chatAreaElement.querySelectorAll(\r\n        'div.option-selector-button-container',\r\n    );\r\n    const lastButtonDiv = buttonElementArray[buttonElementArray.length - 1];\r\n    if (\r\n        lastButtonDiv?.nextElementSibling?.nextElementSibling\r\n            ?.nextElementSibling ===\r\n        document.querySelector('div[style=\"padding-bottom: 15px;\"]')\r\n    ) {\r\n        for (const btn of lastButtonDiv.children) {\r\n            btn.removeAttribute('disabled');\r\n            btn.removeAttribute('style');\r\n            btn.setAttribute('style', 'background-color:#2dabf9');\r\n        }\r\n    }\r\n};\r\n\r\nexport const blockInputAtFinalStep = (step: string) => {\r\n    if (step === ChatStepTypes.finalStep) {\r\n        const inputField = document.getElementsByClassName(\r\n            'react-chatbot-kit-chat-input',\r\n        )[0] as HTMLInputElement;\r\n        const sendInputBtn = document.getElementsByClassName(\r\n            'react-chatbot-kit-chat-btn-send',\r\n        )[0] as HTMLButtonElement;\r\n        inputField.setAttribute('disabled', 'true');\r\n        sendInputBtn.setAttribute('disabled', 'true');\r\n        const undoButton = document.getElementById('chatbot-undo-button');\r\n        if (undoButton) undoButton.style.display = 'none';\r\n    }\r\n};\r\n\r\nexport const clearDisabledInput = (prevStep: string) => {\r\n    if (prevStep !== ChatStepTypes.finalStep) {\r\n        const inputField = document.getElementsByClassName(\r\n            'react-chatbot-kit-chat-input',\r\n        )[0] as HTMLInputElement;\r\n        const sendInputBtn = document.getElementsByClassName(\r\n            'react-chatbot-kit-chat-btn-send',\r\n        )[0] as HTMLButtonElement;\r\n        inputField.removeAttribute('disabled');\r\n        sendInputBtn.removeAttribute('disabled');\r\n    }\r\n};\r\n","import ActionProvider from '../ActionProvider';\r\nimport { ChatStepTypes } from '../Helper/Enums/ChatStepTypes';\r\nimport {\r\n    CurrencyOutput,\r\n    ParseCurrencyStringForOutput,\r\n} from '../Helper/Methods/HandleCurrency';\r\nimport QuestionConstants from '../Helper/Methods/QuestionConstants';\r\nimport {\r\n    askFinalQuestion,\r\n    createTestator,\r\n    getPerson,\r\n} from './OtherChatbotMethods';\r\n\r\nexport const handleTestator = (\r\n    res: string,\r\n    state: any,\r\n    actionProvider: ActionProvider,\r\n) => {\r\n    /**\r\n     *  * function for handling personID replies.\r\n     *  * stepID is updated to 2 and then proceed to wealth question.\r\n     *  * open reply, no conditions for now.\r\n     */\r\n\r\n    const undividedEstateQuestion = actionProvider.createChatBotMessage(\r\n        QuestionConstants.UndividedEstateQuestion,\r\n        QuestionConstants.YesNoWidgetOptions,\r\n    );\r\n    state = {\r\n        ...state,\r\n        stepID: ChatStepTypes.testatorStep,\r\n        testator: createTestator(res, state, actionProvider),\r\n    };\r\n    state = {\r\n        ...state,\r\n    };\r\n    state = actionProvider.addMessageToBotState(undividedEstateQuestion, state);\r\n    return state;\r\n};\r\n\r\nexport const handleNetWealth = (\r\n    res: string,\r\n    state: any,\r\n    actionProvider: ActionProvider,\r\n) => {\r\n    const netWealthQuestion = actionProvider.createChatBotMessage(\r\n        QuestionConstants.NetWealthQuestion,\r\n        { withAvatar: true },\r\n    );\r\n    const currencyIntResponse = CurrencyOutput(res);\r\n    const currencyStringResponse = ParseCurrencyStringForOutput(\r\n        currencyIntResponse[1],\r\n    );\r\n    const currencyJSX = <div>{currencyStringResponse}</div>;\r\n    if (currencyIntResponse[0] === 5) {\r\n        const underAgeQuestion = actionProvider.createChatBotMessage(\r\n            QuestionConstants.UnderAgeQuestion,\r\n            QuestionConstants.YesNoWidgetOptions,\r\n        );\r\n        state.messages.pop();\r\n        const currencyCustom = actionProvider.createClientMessage(currencyJSX);\r\n        state = actionProvider.addMessageToBotState(currencyCustom, state);\r\n\r\n        state = {\r\n            ...state,\r\n            stepID: ChatStepTypes.underAgeStep,\r\n            netWealth: parseInt(currencyIntResponse[1]),\r\n        };\r\n        if (state.netWealth <= 0) {\r\n            state = askFinalQuestion(state, actionProvider);\r\n        }\r\n        state = actionProvider.addMessageToBotState(underAgeQuestion, state);\r\n    } else {\r\n        const netWealthWarning = actionProvider.createChatBotMessage(\r\n            QuestionConstants.NetWealthWarning,\r\n        );\r\n\r\n        state = actionProvider.addMessageToBotState(netWealthWarning, state);\r\n        state = actionProvider.addMessageToBotState(netWealthQuestion, state);\r\n    }\r\n\r\n    return state;\r\n};\r\n\r\nexport const handleUnderAge = (\r\n    res: boolean,\r\n    state: any,\r\n    actionProvider: ActionProvider,\r\n) => {\r\n    state.person = state.testator;\r\n    state.temp_person = state.testator;\r\n    getPerson(state.person._id, state.personsMap)._underAge = res;\r\n    if (res) {\r\n        const cohabitantChoiceQuestion = actionProvider.createChatBotMessage(\r\n            QuestionConstants.CohabitantChoiceQuestion,\r\n            QuestionConstants.YesNoWidgetOptions,\r\n        );\r\n        state = {\r\n            ...state,\r\n            stepID: ChatStepTypes.cohabitantChoice,\r\n        };\r\n        state = actionProvider.addMessageToBotState(\r\n            cohabitantChoiceQuestion,\r\n            state,\r\n        );\r\n\r\n        return state;\r\n    }\r\n\r\n    const spouseChoiceQuestion = actionProvider.createChatBotMessage(\r\n        QuestionConstants.SpouseChoiceQuestion,\r\n        QuestionConstants.YesNoWidgetOptions,\r\n    );\r\n    state = {\r\n        ...state,\r\n        stepID: ChatStepTypes.spouseChoice,\r\n    };\r\n    state = actionProvider.addMessageToBotState(spouseChoiceQuestion, state);\r\n\r\n    return state;\r\n};\r\n\r\nexport const handleAskUnderAgeQuestion = (\r\n    state: any,\r\n    actionProvider: ActionProvider,\r\n) => {\r\n    state = {\r\n        ...state,\r\n        stepID: ChatStepTypes.underAgeStep,\r\n    };\r\n    const underAgeQuestion = actionProvider.createChatBotMessage(\r\n        QuestionConstants.UnderAgeQuestion,\r\n        QuestionConstants.YesNoWidgetOptions,\r\n    );\r\n    state = actionProvider.addMessageToBotState(underAgeQuestion, state);\r\n    return state;\r\n};\r\n","import ActionProvider from '../ActionProvider';\r\nimport { ChatbotInterface } from '../Generics';\r\nimport Person from '../Helper/Classes/Person';\r\nimport { ChatStepTypes, QuestionType } from '../Helper/Enums/ChatStepTypes';\r\nimport { ParentChildSelector } from '../Helper/Enums/ParentChildSelector';\r\nimport InheritanceConstants from '../Helper/Methods/InheritanceConstants';\r\nimport QuestionConstants from '../Helper/Methods/QuestionConstants';\r\nimport { askFinalQuestion, createNewPerson } from './OtherChatbotMethods';\r\n\r\nexport const handleSpouseOption = (\r\n    res: boolean,\r\n    state: any,\r\n    actionProvider: ActionProvider,\r\n) => {\r\n    // Spouse present\r\n    if (res) {\r\n        state = {\r\n            ...state,\r\n            stepID: ChatStepTypes.spouseStep,\r\n        };\r\n        const spouseQuestion = actionProvider.createChatBotMessage(\r\n            QuestionConstants.SpouseQuestion,\r\n        );\r\n        state = actionProvider.addMessageToBotState(spouseQuestion, state);\r\n    }\r\n    // No spouse\r\n    else {\r\n        const testator = Person.getPerson(state.person._id, state.personsMap);\r\n        // is Adult, then ask for cohabitant\r\n        if (!testator._underAge && testator.spouse === undefined) {\r\n            state = {\r\n                ...state,\r\n                stepID: ChatStepTypes.cohabitantChoice,\r\n            };\r\n            const cohabitantChoiceQuestion =\r\n                actionProvider.createChatBotMessage(\r\n                    QuestionConstants.CohabitantChoiceQuestion,\r\n                    QuestionConstants.YesNoWidgetOptions,\r\n                );\r\n            state = actionProvider.addMessageToBotState(\r\n                cohabitantChoiceQuestion,\r\n                state,\r\n            );\r\n        } else {\r\n            state = {\r\n                ...state,\r\n                stepID: ChatStepTypes.successorStep,\r\n                successor_flag: QuestionType.part3,\r\n            };\r\n            const newSuccessorQuestion = actionProvider.createChatBotMessage(\r\n                QuestionConstants.addSuccessorCount(testator._personName),\r\n            );\r\n            state = actionProvider.addMessageToBotState(\r\n                newSuccessorQuestion,\r\n                state,\r\n            );\r\n        }\r\n    }\r\n    return state;\r\n};\r\n\r\nexport const handleSpouseInput = (\r\n    res: string,\r\n    state: any,\r\n    actionProvider: ActionProvider,\r\n) => {\r\n    /**\r\n     *  * function for handling spouseID replies.\r\n     *  * stepID is updated to 6 and then further conditions are evaluated next.\r\n     *  * open reply, no conditions for now.\r\n     */\r\n    const testator = Person.getPerson(state.person._id, state.personsMap);\r\n    const newSpouse = createNewPerson(res, state, actionProvider);\r\n    state.person = Object.assign(state.person, { _spouse: newSpouse._id });\r\n    // state.person._spouse = newSpouse._id;\r\n    state.person.setPathforPartner(ParentChildSelector.spouse, newSpouse);\r\n    if (\r\n        state.netWealth <=\r\n        InheritanceConstants.MINIMUM_INHERITANCE_SPOUSE_VS_CHILDREN\r\n    ) {\r\n        state = {\r\n            ...state,\r\n            stepID: ChatStepTypes.rearChildrenStep,\r\n        };\r\n        state = askFinalQuestion(state, actionProvider);\r\n        return state;\r\n    }\r\n\r\n    state = {\r\n        ...state,\r\n        stepID: ChatStepTypes.successorStep,\r\n        successor_flag: QuestionType.part3,\r\n    };\r\n    state.testator = Object.assign(state.testator, {\r\n        _partnerNode: newSpouse._id,\r\n    });\r\n    // state.testator._partnerNode = newSpouse._id;\r\n    const newSuccessorQuestion = actionProvider.createChatBotMessage(\r\n        QuestionConstants.addSuccessorCount(testator._personName),\r\n    );\r\n    state = actionProvider.addMessageToBotState(newSuccessorQuestion, state);\r\n    return state;\r\n};\r\n\r\nexport const handleCohabitantChoice = (\r\n    res: boolean,\r\n    state: any,\r\n    actionProvider: ActionProvider,\r\n) => {\r\n    // if cohabitant choice is yes\r\n    if (res) {\r\n        state = {\r\n            ...state,\r\n            stepID: ChatStepTypes.cohabitantStep,\r\n        };\r\n        const cohabitantQuestion = actionProvider.createChatBotMessage(\r\n            QuestionConstants.CohabitantQuestion,\r\n        );\r\n        state = actionProvider.addMessageToBotState(cohabitantQuestion, state);\r\n    }\r\n    // if cohabitant choice is no\r\n    else {\r\n        state = {\r\n            ...state,\r\n            stepID: ChatStepTypes.successorStep,\r\n            successor_flag: QuestionType.part3,\r\n        };\r\n        const testator = Person.getPerson(state.person._id, state.personsMap);\r\n        const newSuccessorQuestion = actionProvider.createChatBotMessage(\r\n            QuestionConstants.addSuccessorCount(testator._personName),\r\n        );\r\n        state = actionProvider.addMessageToBotState(\r\n            newSuccessorQuestion,\r\n            state,\r\n        );\r\n    }\r\n    return state;\r\n};\r\n\r\nexport const handleCohabitantInput = (\r\n    res: string,\r\n    state: any,\r\n    actionProvider: ActionProvider,\r\n) => {\r\n    /**\r\n     *  * function for handling cohabitant replies.\r\n     *  * stepID is updated to 7 and then further conditions are evaluated next.\r\n     *  * open reply, no conditions for now.\r\n     */\r\n    const testator = Person.getPerson(state.person._id, state.personsMap);\r\n    const newCohabitant = createNewPerson(res, state, actionProvider);\r\n    state.person = Object.assign(state.person, {\r\n        _cohabitant: newCohabitant._id,\r\n    });\r\n    // state.person._cohabitant = newCohabitant._id;\r\n    state.person.setPathforPartner(\r\n        ParentChildSelector.cohabitant,\r\n        newCohabitant,\r\n    );\r\n\r\n    if (\r\n        state.netWealth <=\r\n        InheritanceConstants.MINIMUM_INHERITANCE_SPOUSE_VS_CHILDREN\r\n    ) {\r\n        state = {\r\n            ...state,\r\n            stepID: ChatStepTypes.rearChildrenStep,\r\n        };\r\n        state = askFinalQuestion(state, actionProvider);\r\n        return state;\r\n    }\r\n    state = {\r\n        ...state,\r\n        stepID: ChatStepTypes.successorStep,\r\n        successor_flag: QuestionType.part3,\r\n    };\r\n    const newSuccessorQuestion = actionProvider.createChatBotMessage(\r\n        QuestionConstants.addSuccessorCount(testator._personName),\r\n    );\r\n    state = actionProvider.addMessageToBotState(newSuccessorQuestion, state);\r\n    return state;\r\n};\r\n","import ActionProvider from '../../ActionProvider';\r\nimport { ChatbotInterface } from '../../Generics';\r\nimport { messageService } from '../../services/ChatbotCommunicator';\r\nimport {\r\n    BinaryAnswerTypeYes,\r\n    BinaryAnswerTypeNo,\r\n} from '../Enums/BinaryAnswerTypes';\r\nimport { ChatStepTypes, QuestionType } from '../Enums/ChatStepTypes';\r\nimport { ValidationType } from '../Enums/ValidationType';\r\nimport { ChatbotValidation } from './ChatbotValidation';\r\nimport { returnKeyFromEnteredNumberText } from './NumberInput';\r\nimport {\r\n    getReturnValueFromBooleanWidget,\r\n    getReturnValueFromUndividedWidget,\r\n} from './OtherMethods';\r\nimport _ from 'lodash';\r\nimport {\r\n    handleNetWealth,\r\n    handleTestator,\r\n    handleUnderAge,\r\n} from '../../ActionProviderMethods/TestatorInformationMethods';\r\nimport {\r\n    delvisFirstResponse,\r\n    delvisFulltResponse,\r\n    delvisSecondResponse,\r\n    totalEstateValue,\r\n    undividedEstateChoice,\r\n    undividedEstateSpouse,\r\n    undividedOwnershipResponse,\r\n} from '../../ActionProviderMethods/UndividedEstateMethods';\r\nimport {\r\n    handleChildAliveOption,\r\n    handleMarriedParents,\r\n    handleParentAliveOption,\r\n    handleParentsInput,\r\n    handleSecondParentExists,\r\n    handleSuccessorCnt,\r\n    handleSuccessorInput,\r\n} from '../../ActionProviderMethods/RelativeMethods';\r\nimport {\r\n    handleCohabitantChoice,\r\n    handleCohabitantInput,\r\n    handleSpouseInput,\r\n    handleSpouseOption,\r\n} from '../../ActionProviderMethods/PartnerMethods';\r\nimport { handleFinalQuestion } from '../../ActionProviderMethods/OtherChatbotMethods';\r\n\r\nexport const commonMethods = (\r\n    message: string,\r\n    curState: any,\r\n    actionProvider: ActionProvider,\r\n) => {\r\n    const chatbotValidator = new ChatbotValidation(actionProvider, curState);\r\n    // initialStep\r\n    if (curState.stepID === ChatStepTypes.initalStep) {\r\n        if (chatbotValidator.validate(message, [ValidationType.emptyValue])) {\r\n            return handleTestator(message, curState, actionProvider);\r\n        }\r\n    }\r\n\r\n    //testatorStep\r\n    else if (curState.stepID === ChatStepTypes.testatorStep) {\r\n        message = message.toLowerCase();\r\n        if (\r\n            chatbotValidator.validate(message, [\r\n                ValidationType.incorrectValueForBoolean,\r\n            ])\r\n        ) {\r\n            return evaluateBooleanMessage(\r\n                message,\r\n                curState,\r\n                actionProvider,\r\n                undividedEstateChoice,\r\n            );\r\n        }\r\n    }\r\n\r\n    // undividedEstateStep\r\n    else if (curState.stepID === ChatStepTypes.undividedEstateStep) {\r\n        if (curState.undividedEstate.undivided_flag === QuestionType.part1) {\r\n            if (\r\n                chatbotValidator.validate(message, [\r\n                    ValidationType.invalidAmount,\r\n                ])\r\n            )\r\n                return totalEstateValue(message, curState, actionProvider);\r\n        }\r\n        if (curState.undividedEstate.undivided_flag === QuestionType.part2) {\r\n            if (\r\n                chatbotValidator.validate(message, [\r\n                    ValidationType.incorrectValueForUndividedOptions,\r\n                ])\r\n            )\r\n                return undividedOwnershipResponse(\r\n                    message,\r\n                    curState,\r\n                    actionProvider,\r\n                );\r\n        }\r\n        if (curState.undividedEstate.undivided_flag === QuestionType.part3)\r\n            if (\r\n                chatbotValidator.validate(message, [\r\n                    ValidationType.invalidAmount,\r\n                ])\r\n            )\r\n                return delvisFirstResponse(message, curState, actionProvider);\r\n        if (curState.undividedEstate.undivided_flag === QuestionType.part4)\r\n            if (\r\n                chatbotValidator.validate(message, [\r\n                    ValidationType.invalidAmount,\r\n                ])\r\n            )\r\n                return delvisSecondResponse(message, curState, actionProvider);\r\n        if (curState.undividedEstate.undivided_flag === QuestionType.part5)\r\n            if (\r\n                chatbotValidator.validate(message, [\r\n                    ValidationType.invalidAmount,\r\n                ])\r\n            )\r\n                return delvisFulltResponse(message, curState, actionProvider);\r\n        if (\r\n            curState.undividedEstate.undivided_flag === QuestionType.part6 ||\r\n            curState.undividedEstate.undivided_flag === QuestionType.part7\r\n        )\r\n            return handleSuccessor(\r\n                message,\r\n                curState,\r\n                actionProvider,\r\n                chatbotValidator,\r\n            );\r\n        if (curState.undividedEstate.undivided_flag === QuestionType.part8) {\r\n            if (curState.parent_flag === QuestionType.part1)\r\n                if (\r\n                    chatbotValidator.validate(message, [\r\n                        ValidationType.emptyValue,\r\n                    ])\r\n                )\r\n                    return handleParentsInput(\r\n                        message,\r\n                        curState,\r\n                        actionProvider,\r\n                    );\r\n                else if (curState.parent_flag == QuestionType.part2) {\r\n                    message = message.toLowerCase();\r\n                    if (\r\n                        chatbotValidator.validate(message, [\r\n                            ValidationType.incorrectValueForBoolean,\r\n                        ])\r\n                    )\r\n                        return evaluateBooleanMessage(\r\n                            message,\r\n                            curState,\r\n                            actionProvider,\r\n                            handleParentAliveOption,\r\n                        );\r\n                } else if (curState.parent_flag === QuestionType.part3) {\r\n                    if (\r\n                        chatbotValidator.validate(message, [\r\n                            ValidationType.incorrectValueForBoolean,\r\n                        ])\r\n                    )\r\n                        return evaluateBooleanMessage(\r\n                            message,\r\n                            curState,\r\n                            actionProvider,\r\n                            handleSecondParentExists,\r\n                        );\r\n                }\r\n        }\r\n    } else if (curState.stepID === ChatStepTypes.testatorOtherChildStep)\r\n        return handleSuccessor(\r\n            message,\r\n            curState,\r\n            actionProvider,\r\n            chatbotValidator,\r\n        );\r\n    // netWealthStep\r\n    else if (curState.stepID === ChatStepTypes.netWealthStep) {\r\n        if (\r\n            chatbotValidator.validate(message, [\r\n                ValidationType.emptyValue,\r\n                ValidationType.invalidAmount,\r\n            ])\r\n        )\r\n            return handleNetWealth(message, curState, actionProvider);\r\n    }\r\n\r\n    // underAgeStep\r\n    else if (curState.stepID === ChatStepTypes.underAgeStep) {\r\n        message = message.toLowerCase();\r\n        if (\r\n            chatbotValidator.validate(message, [\r\n                ValidationType.incorrectValueForBoolean,\r\n            ])\r\n        )\r\n            return evaluateBooleanMessage(\r\n                message,\r\n                curState,\r\n                actionProvider,\r\n                handleUnderAge,\r\n            );\r\n    }\r\n\r\n    // spouse start\r\n    else if (curState.stepID === ChatStepTypes.spouseChoice) {\r\n        message = message.toLowerCase();\r\n        if (\r\n            chatbotValidator.validate(message, [\r\n                ValidationType.incorrectValueForBoolean,\r\n            ])\r\n        )\r\n            return evaluateBooleanMessage(\r\n                message,\r\n                curState,\r\n                actionProvider,\r\n                handleSpouseOption,\r\n            );\r\n    } else if (curState.stepID === ChatStepTypes.spouseStep) {\r\n        if (chatbotValidator.validate(message, [ValidationType.emptyValue]))\r\n            return handleSpouseInput(message, curState, actionProvider);\r\n    }\r\n    // spouse end\r\n\r\n    // cohabitant start\r\n    else if (curState.stepID === ChatStepTypes.cohabitantChoice) {\r\n        message = message.toLowerCase();\r\n        if (\r\n            chatbotValidator.validate(message, [\r\n                ValidationType.incorrectValueForBoolean,\r\n            ])\r\n        )\r\n            return evaluateBooleanMessage(\r\n                message,\r\n                curState,\r\n                actionProvider,\r\n                handleCohabitantChoice,\r\n            );\r\n    } else if (curState.stepID === ChatStepTypes.cohabitantStep) {\r\n        if (chatbotValidator.validate(message, [ValidationType.emptyValue]))\r\n            return handleCohabitantInput(message, curState, actionProvider);\r\n    }\r\n\r\n    //  cohabitant end\r\n    // successorStep\r\n    else if (curState.stepID === ChatStepTypes.successorStep) {\r\n        if (curState.successor_flag === QuestionType.part1) {\r\n            if (chatbotValidator.validate(message, [ValidationType.emptyValue]))\r\n                return handleSuccessorInput(message, curState, actionProvider);\r\n        } else if (curState.successor_flag === QuestionType.part2) {\r\n            message = message.toLowerCase();\r\n            if (\r\n                chatbotValidator.validate(message, [\r\n                    ValidationType.incorrectValueForBoolean,\r\n                ])\r\n            )\r\n                return evaluateBooleanMessage(\r\n                    message,\r\n                    curState,\r\n                    actionProvider,\r\n                    handleChildAliveOption,\r\n                );\r\n        } else if (curState.successor_flag === QuestionType.part3) {\r\n            const convertedMessage = returnKeyFromEnteredNumberText(message);\r\n            if (\r\n                chatbotValidator.validate(convertedMessage, [\r\n                    ValidationType.emptyValue,\r\n                    ValidationType.onlyDigit,\r\n                ])\r\n            )\r\n                return handleSuccessorCnt(\r\n                    convertedMessage,\r\n                    curState,\r\n                    actionProvider,\r\n                );\r\n        }\r\n    }\r\n\r\n    //  parentsStep\r\n    else if (curState.stepID === ChatStepTypes.parentsStep) {\r\n        if (curState.successor_flag === QuestionType.part1) {\r\n            if (chatbotValidator.validate(message, [ValidationType.emptyValue]))\r\n                return handleSuccessorInput(message, curState, actionProvider);\r\n        } else if (curState.successor_flag === QuestionType.part2) {\r\n            message = message.toLowerCase();\r\n            if (\r\n                chatbotValidator.validate(message, [\r\n                    ValidationType.incorrectValueForBoolean,\r\n                ])\r\n            )\r\n                return evaluateBooleanMessage(\r\n                    message,\r\n                    curState,\r\n                    actionProvider,\r\n                    handleChildAliveOption,\r\n                );\r\n        } else if (curState.successor_flag === QuestionType.part3) {\r\n            if (\r\n                chatbotValidator.validate(message, [\r\n                    ValidationType.emptyValue,\r\n                    ValidationType.onlyDigit,\r\n                ])\r\n            )\r\n                return handleSuccessorCnt(message, curState, actionProvider);\r\n        }\r\n        if (curState.parent_flag === QuestionType.part1) {\r\n            if (chatbotValidator.validate(message, [ValidationType.emptyValue]))\r\n                return handleParentsInput(message, curState, actionProvider);\r\n        } else if (curState.parent_flag == QuestionType.part2) {\r\n            message = message.toLowerCase();\r\n            if (\r\n                chatbotValidator.validate(message, [\r\n                    ValidationType.incorrectValueForBoolean,\r\n                ])\r\n            )\r\n                return evaluateBooleanMessage(\r\n                    message,\r\n                    curState,\r\n                    actionProvider,\r\n                    handleParentAliveOption,\r\n                );\r\n        } else if (curState.parent_flag === QuestionType.part3) {\r\n            if (\r\n                chatbotValidator.validate(message, [\r\n                    ValidationType.incorrectValueForBoolean,\r\n                ])\r\n            )\r\n                return evaluateBooleanMessage(\r\n                    message,\r\n                    curState,\r\n                    actionProvider,\r\n                    handleSecondParentExists,\r\n                );\r\n        }\r\n    }\r\n\r\n    // marriedParentsStep\r\n    else if (curState.stepID === ChatStepTypes.marriedParentsStep) {\r\n        message = message.toLowerCase();\r\n        if (\r\n            chatbotValidator.validate(message, [\r\n                ValidationType.incorrectValueForBoolean,\r\n            ])\r\n        )\r\n            return evaluateBooleanMessage(\r\n                message,\r\n                curState,\r\n                actionProvider,\r\n                handleMarriedParents,\r\n            );\r\n    }\r\n\r\n    // grandParentStep\r\n    else if (curState.stepID === ChatStepTypes.grandParentStep) {\r\n        if (curState.successor_flag === QuestionType.part1) {\r\n            if (chatbotValidator.validate(message, [ValidationType.emptyValue]))\r\n                return handleSuccessorInput(message, curState, actionProvider);\r\n        } else if (curState.successor_flag === QuestionType.part2) {\r\n            message = message.toLowerCase();\r\n            if (\r\n                chatbotValidator.validate(message, [\r\n                    ValidationType.incorrectValueForBoolean,\r\n                ])\r\n            )\r\n                return evaluateBooleanMessage(\r\n                    message,\r\n                    curState,\r\n                    actionProvider,\r\n                    handleChildAliveOption,\r\n                );\r\n        } else if (curState.successor_flag === QuestionType.part3) {\r\n            if (\r\n                chatbotValidator.validate(message, [\r\n                    ValidationType.emptyValue,\r\n                    ValidationType.onlyDigit,\r\n                ])\r\n            )\r\n                return handleSuccessorCnt(message, curState, actionProvider);\r\n        } else if (curState.parent_flag === QuestionType.part1)\r\n            if (chatbotValidator.validate(message, [ValidationType.emptyValue]))\r\n                return handleParentsInput(message, curState, actionProvider);\r\n            else if (curState.parent_flag == QuestionType.part2) {\r\n                message = message.toLowerCase();\r\n                if (\r\n                    chatbotValidator.validate(message, [\r\n                        ValidationType.incorrectValueForBoolean,\r\n                    ])\r\n                )\r\n                    return evaluateBooleanMessage(\r\n                        message,\r\n                        curState,\r\n                        actionProvider,\r\n                        handleParentAliveOption,\r\n                    );\r\n            } else if (curState.parent_flag === QuestionType.part3) {\r\n                if (\r\n                    chatbotValidator.validate(message, [\r\n                        ValidationType.incorrectValueForBoolean,\r\n                    ])\r\n                )\r\n                    return evaluateBooleanMessage(\r\n                        message,\r\n                        curState,\r\n                        actionProvider,\r\n                        handleSecondParentExists,\r\n                    );\r\n            }\r\n    }\r\n\r\n    // finalStep\r\n    // else if (curState.stepID === ChatStepTypes.finalStep) {\r\n    //     message = message.toLowerCase();\r\n    //     if (\r\n    //         chatbotValidator.validate(message, [\r\n    //             ValidationType.incorrectValueForBoolean,\r\n    //         ])\r\n    //     )\r\n    //         return evaluateBooleanMessage(\r\n    //             message,\r\n    //             curState,\r\n    //             actionProvider,\r\n    //             handleFinalQuestion,\r\n    //         );\r\n    // }\r\n    return { ...curState, messages: curState.messages.slice(0, -1) };\r\n};\r\n\r\nconst disableButtons = () => {\r\n    const buttonElements: any = document.getElementsByClassName(\r\n        'option-selector-button',\r\n    );\r\n    // const lastBtnEl = buttonElements[buttonElements.length-1]\r\n    // if (!lastBtnEl.disabled) lastBtnEl.disabled = true;\r\n    //     lastBtnEl.style.pointerEvents = 'none';\r\n    for (let i = 0; i < buttonElements.length; i++) {\r\n        const currentElement = buttonElements[i];\r\n        if (!currentElement.disabled) currentElement.disabled = true;\r\n        currentElement.style.pointerEvents = 'none';\r\n    }\r\n};\r\n\r\nconst handleSuccessor = (\r\n    message: string,\r\n    curState: ChatbotInterface,\r\n    actionProvider: ActionProvider,\r\n    chatbotValidator: ChatbotValidation,\r\n) => {\r\n    if (curState.successor_flag === QuestionType.part1) {\r\n        if (chatbotValidator.validate(message, [ValidationType.emptyValue]))\r\n            return handleSuccessorInput(message, curState, actionProvider);\r\n    } else if (curState.successor_flag === QuestionType.part2) {\r\n        message = message.toLowerCase();\r\n        if (\r\n            chatbotValidator.validate(message, [\r\n                ValidationType.incorrectValueForBoolean,\r\n            ])\r\n        ) {\r\n            return evaluateBooleanMessage(\r\n                message,\r\n                curState,\r\n                actionProvider,\r\n                handleChildAliveOption,\r\n            );\r\n        }\r\n    } else if (curState.successor_flag === QuestionType.part3) {\r\n        if (\r\n            chatbotValidator.validate(message, [\r\n                ValidationType.emptyValue,\r\n                ValidationType.onlyDigit,\r\n            ])\r\n        ) {\r\n            return handleSuccessorCnt(message, curState, actionProvider);\r\n        }\r\n    }\r\n    return undividedEstateSpouse(message, curState, actionProvider);\r\n};\r\n\r\nexport const handleWidgetFunctions = (\r\n    message: string,\r\n    actionProvider: ActionProvider,\r\n    state: any,\r\n    isClicked: boolean,\r\n    isClickedUndiv: boolean,\r\n) => {\r\n    const widgetFunctions = [\r\n        { widget: isClicked, func: getReturnValueFromBooleanWidget },\r\n        { widget: isClickedUndiv, func: getReturnValueFromUndividedWidget },\r\n    ];\r\n\r\n    widgetFunctions.forEach(({ widget, func }) => {\r\n        if (widget) {\r\n            const returnValue = func(message, state);\r\n            const clientMessage =\r\n                actionProvider.createClientMessage(returnValue);\r\n            state = actionProvider.addMessageToBotState(clientMessage, state);\r\n        }\r\n    });\r\n    return state;\r\n};\r\n\r\nexport const focusWritingArea = () => {\r\n    const inputBoxElement = document.getElementsByClassName(\r\n        'react-chatbot-kit-chat-input',\r\n    )[0] as HTMLInputElement;\r\n    if (inputBoxElement) {\r\n        inputBoxElement.focus();\r\n    }\r\n};\r\n\r\nexport const handleMessage = (\r\n    actionProvider: ActionProvider,\r\n    message: string,\r\n    isClicked = false,\r\n    isClickedUndiv = false,\r\n) => {\r\n    actionProvider.setState((state: any) => {\r\n        handleWidgetFunctions(\r\n            message,\r\n            actionProvider,\r\n            state,\r\n            isClicked,\r\n            isClickedUndiv,\r\n        );\r\n        let finalState: any;\r\n        if (messageService.getRevert()) {\r\n            finalState = messageService.removePreviousStates(\r\n                messageService.getRevertCnt(),\r\n            );\r\n            messageService.resetRevertCnt();\r\n            messageService.resetRevert();\r\n\r\n            if (\r\n                finalState.messages[finalState.messages.length - 1] !==\r\n                state.messages[state.messages.length - 1]\r\n            )\r\n                finalState.messages.push(\r\n                    state.messages[state.messages.length - 1],\r\n                );\r\n            state = finalState;\r\n        }\r\n        const prevState = _.cloneDeep(state);\r\n        prevState.messages.pop();\r\n        messageService.addPreviousState(prevState);\r\n        message = message.trim();\r\n        state = commonMethods(message, state, actionProvider);\r\n        focusWritingArea();\r\n        return actionProvider.returnState(state);\r\n    });\r\n};\r\n\r\nconst evaluateBooleanMessage = (\r\n    message: string,\r\n    curState: any,\r\n    actionProvider: any,\r\n    func: any,\r\n) => {\r\n    disableButtons();\r\n    return message in BinaryAnswerTypeYes\r\n        ? typeof func === 'function'\r\n            ? func(true, curState, actionProvider)\r\n            : alert('func is not a function')\r\n        : message in BinaryAnswerTypeNo\r\n        ? typeof func === 'function'\r\n            ? func(false, curState, actionProvider)\r\n            : alert('func is not a function')\r\n        : alert('check for error');\r\n};\r\n","import './OptionSelector.scss';\r\nimport { FormattedMessage } from 'react-intl';\r\nimport { ReactElement } from 'react';\r\nimport ActionProvider from '../../../ActionProvider';\r\nimport { handleMessage } from '../../../Helper/Methods/CommonMethods';\r\n\r\nconst OptionSelector = ({ actionProvider, ...rest }: any): ReactElement => {\r\n    return (\r\n        <div className=\"option-selector-button-container\">\r\n            <button\r\n                className=\"option-selector-button\"\r\n                onClick={(e) => {\r\n                    onClickHandler(e);\r\n                    handleOptions(true, actionProvider);\r\n                }}\r\n            >\r\n                <FormattedMessage id=\"Chatbot.Yes\" />\r\n            </button>\r\n            <button\r\n                className=\"option-selector-button\"\r\n                onClick={(e) => {\r\n                    onClickHandler(e);\r\n                    handleOptions(false, actionProvider);\r\n                }}\r\n            >\r\n                <FormattedMessage id=\"Chatbot.No\" />\r\n            </button>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst onClickHandler = (e: any): void => {\r\n    const thisButton = e.target as HTMLButtonElement;\r\n    const nextButton = thisButton.nextElementSibling as HTMLButtonElement;\r\n    const prevButton = thisButton.previousElementSibling as HTMLButtonElement;\r\n    const otherButton = nextButton ? nextButton : prevButton;\r\n    thisButton.style.pointerEvents = 'none';\r\n    thisButton.style.background = 'darkolivegreen';\r\n    thisButton.disabled = true;\r\n    otherButton.style.pointerEvents = 'none';\r\n    otherButton.disabled = true;\r\n};\r\n\r\nconst handleOptions = (option: boolean, actionProvider: ActionProvider) => {\r\n    hideWarning();\r\n    const optionSelected = option ? 'yes' : 'no';\r\n    handleMessage(actionProvider, optionSelected, true, false);\r\n};\r\n\r\nconst hideWarning = () => {\r\n    const warningDiv = document.getElementById('chatbot-warning-div');\r\n    if (warningDiv) {\r\n        warningDiv.style.display = 'none';\r\n        return;\r\n    }\r\n};\r\nexport default OptionSelector;\r\n","import { Box } from '@mui/material';\r\nimport PropTypes, { InferProps } from 'prop-types';\r\nimport './InfoMessagesWidget.scss';\r\nimport { ReactElement } from 'react';\r\nimport ReactPDF from '@react-pdf/renderer';\r\n\r\n// const InfoMessageTypes = {\r\n//     label: ReactElement,\r\n// };\r\n// type InfoMessageTypes = InferProps<typeof InfoMessageTypes>;\r\n\r\nconst InfoMessagesWidget = (label: typeof ReactPDF.PDFDownloadLink) => {\r\n    return (\r\n        <Box\r\n            display=\"flex\"\r\n            justifyContent=\"center\"\r\n            alignItems=\"center\"\r\n            component=\"span\"\r\n            className=\"InfoMessage\"\r\n            sx={{ backgroundColor: '#FFCBA4' }}\r\n        >\r\n            {label}\r\n        </Box>\r\n    );\r\n};\r\n// color: #FFCBA4\r\n\r\nexport default InfoMessagesWidget;\r\n","import './UndividedEstateWidget.scss';\r\nimport { FormattedMessage } from 'react-intl';\r\nimport { ReactElement } from 'react';\r\nimport ActionProvider from '../../../ActionProvider';\r\nimport { undividedOwnershipType } from '../../../Helper/Enums/ChatStepTypes';\r\nimport { handleMessage } from '../../../Helper/Methods/CommonMethods';\r\n\r\nconst UndividedEstateWidget = ({\r\n    actionProvider,\r\n    ...rest\r\n}: any): ReactElement => {\r\n    // const setOption = (option: string) => {\r\n    //     let state = actionProvider.stateRef;\r\n    //     state = actionProvider.handleMessage(option, state);\r\n    //     state = actionProvider.handleOwnershipResponse(option);\r\n    //     return state;\r\n    // };\r\n\r\n    return (\r\n        <div className=\"option-selector-button-container\">\r\n            <button\r\n                className=\"option-selector-button\"\r\n                onClick={(e) => {\r\n                    onClickHandler(e);\r\n                    handleOptions(\r\n                        undividedOwnershipType.felleseie,\r\n                        actionProvider,\r\n                    );\r\n                }}\r\n            >\r\n                <FormattedMessage id=\"Chatbot.OWNERSHIP_TYPE1\" />\r\n            </button>\r\n            <button\r\n                className=\"option-selector-button\"\r\n                onClick={(e) => {\r\n                    onClickHandler(e);\r\n                    handleOptions(\r\n                        undividedOwnershipType.delvis,\r\n                        actionProvider,\r\n                    );\r\n                }}\r\n            >\r\n                <FormattedMessage id=\"Chatbot.OWNERSHIP_TYPE2\" />\r\n            </button>\r\n            <button\r\n                className=\"option-selector-button\"\r\n                onClick={(e) => {\r\n                    onClickHandler(e);\r\n                    handleOptions(undividedOwnershipType.fullt, actionProvider);\r\n                }}\r\n            >\r\n                <FormattedMessage id=\"Chatbot.OWNERSHIP_TYPE3\" />\r\n            </button>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst handleOptions = (option: string, actionProvider: ActionProvider) => {\r\n    hideWarning();\r\n    handleMessage(actionProvider, option, false, true);\r\n};\r\n\r\nconst onClickHandler = (e: any): void => {\r\n    // store previous state\r\n    const thisButton = e.target as HTMLButtonElement;\r\n    const currentParent = thisButton.parentElement;\r\n    if (currentParent?.hasChildNodes) {\r\n        const allCurrentButtons = Object.values(\r\n            currentParent.childNodes,\r\n        ) as HTMLButtonElement[];\r\n        for (const childEl of allCurrentButtons) {\r\n            childEl.style.pointerEvents = 'none';\r\n            childEl.disabled = true;\r\n        }\r\n        thisButton.style.background = 'darkolivegreen';\r\n    }\r\n};\r\n\r\nconst hideWarning = () => {\r\n    const warningDiv = document.getElementById('chatbot-warning-div');\r\n    if (warningDiv) {\r\n        warningDiv.style.display = 'none';\r\n        return;\r\n    }\r\n};\r\n\r\nexport default UndividedEstateWidget;\r\n","import { useState } from 'react';\r\nimport AppBar from '@mui/material/AppBar';\r\nimport Box from '@mui/material/Box';\r\nimport Toolbar from '@mui/material/Toolbar';\r\nimport { RestartAlt } from '@mui/icons-material';\r\nimport UndoIcon from '@mui/icons-material/Undo';\r\nimport { Button, Tooltip, Typography } from '@mui/material';\r\nimport Dialog from '@mui/material/Dialog';\r\nimport DialogActions from '@mui/material/DialogActions';\r\nimport DialogContent from '@mui/material/DialogContent';\r\nimport DialogContentText from '@mui/material/DialogContentText';\r\nimport DialogTitle from '@mui/material/DialogTitle';\r\nimport { focusWritingArea } from '../../ChatbotComponent/Helper/Methods/CommonMethods';\r\n\r\nexport default function ChatHeader(props: any) {\r\n    const [open, setOpen] = useState(false);\r\n\r\n    const handleClickOpen = () => {\r\n        setOpen(true);\r\n    };\r\n    const handleRevert = () => {\r\n        props.actionProvider.revertLastState();\r\n    };\r\n    const handleCloseNo = () => {\r\n        setOpen(false);\r\n    };\r\n\r\n    const handleCloseYes = () => {\r\n        restartBot();\r\n        setOpen(false);\r\n    };\r\n\r\n    const restartBot = () => {\r\n        props.actionProvider.resetChatbot();\r\n    };\r\n\r\n    return (\r\n        <Box sx={{ flexGrow: 1 }}>\r\n            <AppBar position=\"static\">\r\n                <Toolbar>\r\n                    <Typography\r\n                        variant=\"h6\"\r\n                        component=\"div\"\r\n                        sx={{ flexGrow: 1 }}\r\n                    >\r\n                        Conversation with ArveBot\r\n                    </Typography>\r\n                    <Box\r\n                        sx={{\r\n                            display: 'flex',\r\n                            justifyContent: 'space-between',\r\n                        }}\r\n                    >\r\n                        <Tooltip title=\"Undo\">\r\n                            <Button\r\n                                id=\"chatbot-undo-button\"\r\n                                onClick={() => {\r\n                                    handleRevert();\r\n                                    focusWritingArea();\r\n                                }}\r\n                                style={{ backgroundColor: 'rgb(92, 204, 157)' }}\r\n                            >\r\n                                <UndoIcon fontSize=\"small\" />\r\n                            </Button>\r\n                        </Tooltip>\r\n                        <Box sx={{ width: '8px' }} />\r\n                        <Tooltip title=\"Restart\">\r\n                            <Button\r\n                                id=\"chatbot-restart-button\"\r\n                                onClick={handleClickOpen}\r\n                                style={{ backgroundColor: 'rgb(92, 204, 157)' }}\r\n                            >\r\n                                <RestartAlt fontSize=\"small\" />\r\n                            </Button>\r\n                        </Tooltip>\r\n                    </Box>\r\n                    <Dialog\r\n                        open={open}\r\n                        onClose={handleCloseNo}\r\n                        aria-labelledby=\"alert-dialog-title\"\r\n                        aria-describedby=\"alert-dialog-description\"\r\n                    >\r\n                        <DialogTitle id=\"alert-dialog-title\">\r\n                            Restart ChatBot?\r\n                        </DialogTitle>\r\n                        <DialogContent>\r\n                            <DialogContentText id=\"alert-dialog-description\">\r\n                                Do you really want to finish current session and\r\n                                start over?\r\n                            </DialogContentText>\r\n                        </DialogContent>\r\n                        <DialogActions>\r\n                            <Button onClick={handleCloseNo}>No</Button>\r\n                            <Button onClick={handleCloseYes} autoFocus>\r\n                                Yes\r\n                            </Button>\r\n                        </DialogActions>\r\n                    </Dialog>\r\n                </Toolbar>\r\n            </AppBar>\r\n        </Box>\r\n    );\r\n}\r\n","import { Box, Tooltip } from '@mui/material';\r\nimport FileDownloadOutlinedIcon from '@mui/icons-material/FileDownloadOutlined';\r\nimport './CustomFinalMessage.scss';\r\n\r\nconst CustomFinalMessage = (props: any) => {\r\n    return (\r\n        <Tooltip title=\"Click to Download Report\">\r\n            <Box className=\"react-chatbot-kit-custom-chat-message-container\">\r\n                <div className=\"react-chatbot-kit-custom-chat-text-message-container\">\r\n                    {props.payload}\r\n                </div>\r\n                <div className=\"react-chatbot-kit-custom-chat-image-message-container\">\r\n                    <FileDownloadOutlinedIcon />\r\n                </div>\r\n            </Box>\r\n        </Tooltip>\r\n    );\r\n};\r\nexport default CustomFinalMessage;\r\n","import { createChatBotMessage } from 'react-chatbot-kit';\r\nimport OptionSelector from './Custom/Widgets/OptionSelector/OptionSelector';\r\nimport InfoMessageWidget from './Custom/Widgets/InfoMessagesWidget/InfoMessagesWidget';\r\nimport UndividedEstateWidget from './Custom/Widgets/UndividedEstateWidget/UndividedEstateWidget';\r\nimport 'react-chatbot-kit/build/main.css';\r\nimport '../chatbot.scss';\r\nimport ChatHeader from '../OtherComponent/ChatHeader/ChatHeader';\r\nimport { ChatbotState } from './Generics';\r\nimport Norsk from '../../../languages/translationNO.json';\r\nimport { createIntl, createIntlCache } from 'react-intl';\r\nimport CustomFinalMessage from './Custom/Messages/CustomFinalMessage';\r\nconst cache = createIntlCache();\r\nconst intl = createIntl({ locale: 'nb-NO', messages: Norsk }, cache);\r\n\r\nconst botName = 'Arvebot';\r\nconst value = intl.formatMessage({ id: 'Chatbot.TESTATOR_QUESTION' });\r\n\r\nconst config = {\r\n    botName: botName,\r\n    lang: 'no',\r\n    customStyles: {\r\n        botMessageBox: {\r\n            backgroundColor: '#376B7E',\r\n        },\r\n        chatButton: {\r\n            backgroundColor: '#5ccc9d',\r\n        },\r\n    },\r\n    state: ChatbotState,\r\n    initialMessages: [createChatBotMessage(value, {})],\r\n    customComponents: {\r\n        header: (actionProvider) => (\r\n            <ChatHeader actionProvider={actionProvider} />\r\n        ),\r\n    },\r\n    customMessages: {\r\n        custom: (props) => <CustomFinalMessage {...props} />,\r\n    },\r\n    widgets: [\r\n        {\r\n            widgetName: 'optionSelectorWidget',\r\n            widgetFunc: (props) => <OptionSelector {...props} />,\r\n        },\r\n        {\r\n            widgetName: 'InfoMessage',\r\n            widgetFunc: (props) => <InfoMessageWidget {...props} />,\r\n        },\r\n        {\r\n            widgetName: 'undividedEstateWidget',\r\n            widgetFunc: (props) => <UndividedEstateWidget {...props} />,\r\n        },\r\n    ],\r\n};\r\nexport default config;\r\n","import ActionProvider from './ActionProvider';\r\nimport { handleMessage } from './Helper/Methods/CommonMethods';\r\n\r\nclass MessageParser {\r\n    actionProvider: ActionProvider;\r\n    state: any;\r\n    constructor(actionProvider: ActionProvider, state: any) {\r\n        this.actionProvider = actionProvider;\r\n        this.state = state;\r\n    }\r\n\r\n    parse(message: string): ReturnType<() => void> {\r\n        // store previous state\r\n        this.state.yesNoClickedFlag = false;\r\n        handleMessage(this.actionProvider, message, false, false);\r\n    }\r\n}\r\n\r\nexport default MessageParser;\r\n","import { ChatbotInterface, InitialChatbotState } from './Generics';\r\nimport { ReactElement } from 'react';\r\nimport { NodeEntity } from './Helper/Classes/NodeEntity';\r\nimport chartSelector from '../../../store/chartSelector';\r\nimport { messageService } from './services/ChatbotCommunicator';\r\nimport QuestionConstants from './Helper/Methods/QuestionConstants';\r\nimport _ from 'lodash';\r\nimport {\r\n    clearBooleanOptions,\r\n    clearDisabledInput,\r\n    revertState,\r\n} from './ActionProviderMethods/OtherChatbotMethods';\r\n\r\nclass ActionProvider {\r\n    createChatBotMessage: (\r\n        questionElement: ReactElement,\r\n        widget?: Record<string, unknown>,\r\n    ) => ReactElement;\r\n    setState: (state: unknown) => ChatbotInterface;\r\n    createClientMessage: (messageElement: ReactElement) => ReactElement;\r\n    stateRef: any;\r\n    checkstate: any = null;\r\n    isStarted = true;\r\n    glb_state: any = null;\r\n    GRANDCHILDREN_PATH_LIMIT = 4;\r\n    constructor(\r\n        createChatBotMessage: (\r\n            questionElement: ReactElement,\r\n            widget?: Record<string, unknown>,\r\n        ) => ReactElement,\r\n        setStateFunc: (state: any) => any,\r\n        createClientMessage: (messageElement: ReactElement) => ReactElement,\r\n        stateRef: any,\r\n    ) {\r\n        this.createChatBotMessage = createChatBotMessage;\r\n        this.setState = setStateFunc;\r\n        this.createClientMessage = createClientMessage;\r\n        this.stateRef = stateRef;\r\n    }\r\n\r\n    setRevertListeners() {\r\n        messageService.clearAllInternalSubscription();\r\n        /* eslint-disable @typescript-eslint/no-unused-vars */\r\n        const subscription = messageService\r\n            .getMessageInChatbot()\r\n            .subscribe((message: any) => {\r\n                revertState(this);\r\n            });\r\n        messageService.addInternalSubscription(subscription);\r\n    }\r\n\r\n    // TODO check options\r\n\r\n    // eslint-disable-next-line\r\n\r\n    // Generic functions\r\n    addMessageToBotState = (messages: any, curState: any): any => {\r\n        if (Array.isArray(messages)) {\r\n            curState.messages = [...curState.messages, ...messages];\r\n        } else {\r\n            curState.messages = [...curState.messages, messages];\r\n        }\r\n        return curState;\r\n    };\r\n\r\n    generateNextID = (id: number) => {\r\n        this.setState((state: any) => {\r\n            state.id = state.id + 1;\r\n            return this.returnState(state);\r\n        });\r\n        return id;\r\n    };\r\n\r\n    set_spouse = (\r\n        firstSpouse_id: number,\r\n        secondSpouse_id: number,\r\n        add_for_both: boolean,\r\n        state: any,\r\n    ) => {\r\n        NodeEntity.getNode(firstSpouse_id, state.nodeMap)._spouse =\r\n            secondSpouse_id;\r\n        if (add_for_both) {\r\n            NodeEntity.getNode(secondSpouse_id, state.nodeMap)._spouse =\r\n                firstSpouse_id;\r\n        }\r\n        return state;\r\n    };\r\n\r\n    check = (delay: number) => {\r\n        const self = this;\r\n        if (this.isStarted) {\r\n            this.checkstate = setInterval(() => {\r\n                if (self.glb_state !== null) {\r\n                    self.isStarted = false;\r\n                    messageService.sendMessageFromChatbot({\r\n                        detail: self.glb_state,\r\n                    });\r\n                    // close the interval\r\n                    self.glb_state = null;\r\n                    clearInterval(this.checkstate);\r\n                }\r\n            }, delay);\r\n        }\r\n    };\r\n    returnState = (state: any, delay = 200) => {\r\n        setTimeout(() => {\r\n            this.check(delay);\r\n            this.glb_state = chartSelector(state);\r\n        }, delay);\r\n        return state;\r\n    };\r\n\r\n    resetChatbot = () => {\r\n        this.setState((state: any) => {\r\n            state = InitialChatbotState;\r\n            state.messages = [];\r\n            state.personMap = new Map();\r\n            state.nodeMap = new Map();\r\n            state.testator = new NodeEntity(0, 0);\r\n            const initialQuestion = this.createChatBotMessage(\r\n                QuestionConstants.TestatorQuestion,\r\n            );\r\n            state = this.addMessageToBotState(initialQuestion, state);\r\n            clearDisabledInput(state.stepID);\r\n            messageService.resetChatbotState();\r\n            const undoButton = document.getElementById('chatbot-undo-button');\r\n            if (undoButton) undoButton.style.display = 'block';\r\n            return this.returnState(state);\r\n        });\r\n    };\r\n    revertLastState = () => {\r\n        messageService.setRevert();\r\n        this.setState((state: any) => {\r\n            const prevState = messageService.getPreviousState(\r\n                messageService.getRevertCnt(),\r\n            );\r\n            messageService.addRevertCnt();\r\n            if (prevState == null) {\r\n                this.resetChatbot();\r\n                return this.returnState(state);\r\n            }\r\n            state = prevState;\r\n            clearBooleanOptions();\r\n            clearDisabledInput(state.stepID);\r\n            return this.returnState(state);\r\n        });\r\n    };\r\n    delay = (n: number) => {\r\n        return new Promise(function (resolve) {\r\n            setTimeout(resolve, n * 1000);\r\n        });\r\n    };\r\n\r\n    handleValidation = (tempMessages: any, state: any) => {\r\n        if (tempMessages && tempMessages.length !== 0) {\r\n            state.messages = tempMessages;\r\n            return state;\r\n        }\r\n        return state;\r\n    };\r\n}\r\n\r\nexport default ActionProvider;\r\n","import ChartNode, { NodeData } from './Classes/ChartNode';\r\nimport Person from '../../ChatbotComponent/Helper/Classes/Person';\r\nimport { ParentChildSelector } from '../../ChatbotComponent/Helper/Enums/ParentChildSelector';\r\nimport { NodeEntity } from '../../ChatbotComponent/Helper/Classes/NodeEntity';\r\nimport ChartConnector from './Classes/ChartConnector';\r\nimport { Bubble } from './Classes/Bubble';\r\n\r\nlet maxLevel = -999999,\r\n    minLevel = 999999;\r\nconst xLevelArray = [[1], [-1, 1], [-1, 0, 1], [-2, -1, 1, 2]];\r\nlet chartNodeMap = new Map<number, ChartNode>();\r\nlet connectorArray = new Array<ChartConnector>();\r\nlet xDiff: number;\r\nlet yDiff: number;\r\nconst nodeSize = 123;\r\nlet partnerBubbleLevelMap: Map<number, Array<number>>;\r\nexport const processData = (data: any): any => {\r\n    (maxLevel = -999999), (minLevel = 999999);\r\n    chartNodeMap = new Map<number, ChartNode>();\r\n    connectorArray = new Array<ChartConnector>();\r\n    partnerBubbleLevelMap = new Map<number, Array<number>>();\r\n    xDiff = 180;\r\n    yDiff = 100;\r\n\r\n    // // divide nodeMap into levels\r\n    const levelMap = getLevelMap(data);\r\n    const maxLevelData = levelMap.get(maxLevel);\r\n    if (data.nodeMap.length === 0 || maxLevelData === undefined) {\r\n        return [];\r\n    }\r\n    setxLevelForMaxLevel(maxLevelData);\r\n    setxLevel(levelMap, data.nodeMap);\r\n    setNodePosition(levelMap, data.nodeMap);\r\n    return getChartNodeConnectorArray(data.nodeMap);\r\n    // const node1 = new ChartNode(\"1\", 'specialNode', new NodeData(\"a\", { right: \"right\" }), { x: 0, y: 0 }, 0)\r\n    // const node2 = new ChartNode(\"2\", 'specialNode', new NodeData(\"afasfasfas\", { left: \"left\" }), { x: 200, y: 0 }, 0)\r\n    // const connector = new ChartConnector(`1-2`, 'straight', \"1\", \"2\", '', 's_right', \"t_left\")\r\n    // return [node1, node2, connector]\r\n};\r\n\r\nconst setxLevel = (\r\n    levelMap: Map<number, Array<ChartNode>>,\r\n    nodeMap: Map<number, NodeEntity>,\r\n) => {\r\n    const processedNodes = new Array<string>();\r\n\r\n    for (let i = maxLevel; i >= minLevel; i--) {\r\n        const currentLevelChartNodes = levelMap.get(i);\r\n\r\n        if (currentLevelChartNodes !== undefined) {\r\n            for (const node of currentLevelChartNodes) {\r\n                if (!processedNodes.includes(node.id)) {\r\n                    processedNodes.push(node.id);\r\n                }\r\n                const currentNode = NodeEntity.getNode(\r\n                    parseInt(node.id),\r\n                    nodeMap,\r\n                );\r\n\r\n                if (i !== maxLevel) {\r\n                    let avgXlevel = 0;\r\n                    const parentsCurrentNode = currentNode._parents;\r\n                    parentsCurrentNode.map((parent_id) => {\r\n                        const n = chartNodeMap.get(parent_id);\r\n                        if (n !== undefined) {\r\n                            avgXlevel += n.xLevel;\r\n                        }\r\n                    });\r\n                    if (parentsCurrentNode.length !== 0)\r\n                        node.xLevel = avgXlevel / parentsCurrentNode.length;\r\n                }\r\n                const partnerNodeId = currentNode._spouse\r\n                    ? currentNode._spouse\r\n                    : currentNode._cohabitant\r\n                    ? currentNode._cohabitant\r\n                    : currentNode._undividedEstateSpouse\r\n                    ? currentNode._undividedEstateSpouse\r\n                    : null;\r\n                if (partnerNodeId !== null) {\r\n                    if (!processedNodes.includes(`${partnerNodeId}`)) {\r\n                        processedNodes.push(`${partnerNodeId}`);\r\n                    }\r\n\r\n                    const partnerChartNode = getChartNode(`${partnerNodeId}`);\r\n                    if (!partnerChartNode.data.pos) {\r\n                        partnerChartNode.data.pos = {};\r\n                    }\r\n                    if (!node.data.pos) {\r\n                        node.data.pos = {};\r\n                    }\r\n                    if (!partnerBubbleLevelMap.has(i)) {\r\n                        partnerBubbleLevelMap.set(i, new Array<number>());\r\n                    }\r\n                    const partnerBubbleArray = partnerBubbleLevelMap.get(i);\r\n\r\n                    if (currentNode._undividedEstateSpouse) {\r\n                        if (partnerBubbleArray) {\r\n                            if (!partnerBubbleArray.includes(partnerNodeId)) {\r\n                                partnerBubbleArray.push(\r\n                                    partnerNodeId,\r\n                                    currentNode._id,\r\n                                );\r\n                            }\r\n                        }\r\n                        partnerChartNode.xLevel = node.xLevel - 0.01;\r\n                        partnerChartNode.data.pos.right = 'right';\r\n                        node.data.pos.left = 'left';\r\n                        if (\r\n                            connectorArray.filter((connector) => {\r\n                                return (\r\n                                    connector.id ===\r\n                                    `e${partnerNodeId}-${currentNode._id}`\r\n                                );\r\n                            }).length === 0\r\n                        ) {\r\n                            const newConnector = new ChartConnector(\r\n                                `e${partnerNodeId}-${currentNode._id}`,\r\n                                'straight',\r\n                                `${partnerNodeId}`,\r\n                                `${currentNode._id}`,\r\n                                '',\r\n                                's_right',\r\n                                't_left',\r\n                            );\r\n                            connectorArray.push(newConnector);\r\n                        }\r\n                    } else {\r\n                        if (partnerBubbleArray) {\r\n                            if (!partnerBubbleArray.includes(partnerNodeId)) {\r\n                                partnerBubbleArray.push(\r\n                                    currentNode._id,\r\n                                    partnerNodeId,\r\n                                );\r\n                            }\r\n                        }\r\n                        partnerChartNode.xLevel = node.xLevel + 0.01;\r\n                        partnerChartNode.data.pos.left = 'left';\r\n                        node.data.pos.right = 'right';\r\n                        if (\r\n                            connectorArray.filter((connector) => {\r\n                                return (\r\n                                    connector.id ===\r\n                                    `e${currentNode._id}-${partnerNodeId}`\r\n                                );\r\n                            }).length === 0\r\n                        ) {\r\n                            const newConnector = new ChartConnector(\r\n                                `e${currentNode._id}-${partnerNodeId}`,\r\n                                'straight',\r\n                                `${currentNode._id}`,\r\n                                `${partnerNodeId}`,\r\n                                '',\r\n                                's_right',\r\n                                't_left',\r\n                            );\r\n                            connectorArray.push(newConnector);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                if (currentNode._undividedEstateSpouse !== null) {\r\n                    if (\r\n                        !processedNodes.includes(\r\n                            `${currentNode._undividedEstateSpouse}`,\r\n                        )\r\n                    ) {\r\n                        processedNodes.push(\r\n                            `${currentNode._undividedEstateSpouse}`,\r\n                        );\r\n                    }\r\n                    const partnerChartNode = getChartNode(\r\n                        `${currentNode._undividedEstateSpouse}`,\r\n                    );\r\n                    if (!partnerChartNode.data.pos) {\r\n                        partnerChartNode.data.pos = {};\r\n                    }\r\n                    if (!node.data.pos) {\r\n                        node.data.pos = {};\r\n                    }\r\n                    if (!partnerBubbleLevelMap.has(i)) {\r\n                        partnerBubbleLevelMap.set(i, new Array<number>());\r\n                    }\r\n                    const partnerBubbleArray = partnerBubbleLevelMap.get(i);\r\n                    if (partnerBubbleArray) {\r\n                        if (\r\n                            !partnerBubbleArray.includes(\r\n                                currentNode._undividedEstateSpouse,\r\n                            )\r\n                        ) {\r\n                            if (!partnerBubbleArray.includes(currentNode._id)) {\r\n                                partnerBubbleArray.push(currentNode._id);\r\n                            }\r\n                            partnerBubbleArray.push(\r\n                                currentNode._undividedEstateSpouse,\r\n                            );\r\n                        }\r\n                    }\r\n                    partnerChartNode.xLevel = node.xLevel + 0.01;\r\n                    partnerChartNode.data.pos.left = 'left';\r\n                    node.data.pos.right = 'right';\r\n                    if (\r\n                        connectorArray.filter((connector) => {\r\n                            return (\r\n                                connector.id ===\r\n                                `e${currentNode._id}-${currentNode._undividedEstateSpouse}`\r\n                            );\r\n                        }).length === 0\r\n                    ) {\r\n                        const newConnector = new ChartConnector(\r\n                            `e${currentNode._id}-${currentNode._undividedEstateSpouse}`,\r\n                            'straight',\r\n                            `${currentNode._id}`,\r\n                            `${currentNode._undividedEstateSpouse}`,\r\n                            '',\r\n                            's_right',\r\n                            't_left',\r\n                        );\r\n                        connectorArray.push(newConnector);\r\n                    }\r\n                }\r\n\r\n                createNodesInPath(currentNode._path, processedNodes);\r\n                if (currentNode._partnerPath) {\r\n                    createNodesInPath(currentNode._partnerPath, processedNodes);\r\n                }\r\n            }\r\n        }\r\n    }\r\n};\r\n\r\nconst getLevelMap = (data: any) => {\r\n    const levelMap = new Map<number, Array<ChartNode>>();\r\n    // eslint-disable-next-line\r\n    data.nodeMap.forEach(function (node: NodeEntity, key: number) {\r\n        const nodeDetails = Person.getPerson(node._id, data.personsMap);\r\n\r\n        if (node._level > maxLevel) {\r\n            maxLevel = node._level;\r\n        }\r\n        if (node._level < minLevel) {\r\n            minLevel = node._level;\r\n        }\r\n        if (!levelMap.has(node._level)) {\r\n            levelMap.set(node._level, new Array<ChartNode>());\r\n        }\r\n        const nodeLabel = nodeDetails._deceased\r\n            ? `\\u2020 ${nodeDetails._personName}`\r\n            : nodeDetails._personName;\r\n        const newNode = new ChartNode(\r\n            node._id.toString(),\r\n            'specialNode',\r\n            new NodeData(nodeLabel),\r\n            { x: 0, y: 0 },\r\n            0,\r\n        );\r\n        levelMap.get(node._level)?.push(newNode);\r\n        chartNodeMap.set(node._id, newNode);\r\n    });\r\n\r\n    return levelMap;\r\n};\r\n\r\nconst setNodePosition = (\r\n    levelMap: Map<number, Array<ChartNode>>,\r\n    nodeMap: any,\r\n) => {\r\n    let ypos = 0;\r\n    for (let i = maxLevel; i >= minLevel; i--) {\r\n        const currentLevelChartNodes = levelMap.get(i);\r\n        // let xpos = 0;\r\n        if (currentLevelChartNodes !== undefined) {\r\n            const sortedLevelChartNode = currentLevelChartNodes.sort((a, b) =>\r\n                a.xLevel >= b.xLevel ? 1 : -1,\r\n            );\r\n            // create bubbles\r\n            const bubbles = createLevelBubble(\r\n                sortedLevelChartNode,\r\n                partnerBubbleLevelMap.get(i),\r\n                nodeMap,\r\n            );\r\n\r\n            processBubbles(bubbles, ypos);\r\n        }\r\n        ypos += yDiff;\r\n    }\r\n};\r\nconst processBubbles = (bubbles: Array<Bubble>, ypos: number) => {\r\n    let xleft = 0;\r\n    const xgap = xDiff - nodeSize;\r\n    let previousXRight = -10000000;\r\n\r\n    for (const bubble of bubbles) {\r\n        //\r\n        const n = bubble.elements.length;\r\n        if (bubble.parent) {\r\n            // find relative pos with parent\r\n\r\n            const parentChartNode = getChartNode(bubble.parent.toString());\r\n            let relativeXleft =\r\n                parentChartNode.position.x +\r\n                nodeSize / 2 -\r\n                (n * nodeSize + (n - 1) * xgap) / 2;\r\n            const relativeXRight =\r\n                parentChartNode.position.x +\r\n                nodeSize / 2 +\r\n                (n * nodeSize + (n - 1) * xgap) / 2;\r\n\r\n            if (previousXRight > relativeXleft) {\r\n                relativeXleft = previousXRight;\r\n            }\r\n            previousXRight = relativeXRight + xgap;\r\n            for (const eleID of bubble.elements) {\r\n                const element = getChartNode(eleID.toString());\r\n                element.position = { x: relativeXleft, y: ypos };\r\n                relativeXleft += xDiff;\r\n                xleft = relativeXleft;\r\n            }\r\n        } else {\r\n            // x will start from xleft\r\n            const relativeXRight = xleft + n * xDiff;\r\n            previousXRight = relativeXRight;\r\n            for (const eleID of bubble.elements) {\r\n                const element = getChartNode(eleID.toString());\r\n                element.position = { x: xleft, y: ypos };\r\n                xleft += xDiff;\r\n            }\r\n        }\r\n    }\r\n};\r\nconst createLevelBubble = (\r\n    chartNodes: Array<ChartNode>,\r\n    partnerBubble: Array<number> | undefined,\r\n    nodeMap: any,\r\n) => {\r\n    const bubbles = new Array<Bubble>();\r\n    let isPartnerProcessed = false;\r\n    for (const chartNode of chartNodes) {\r\n        const node = NodeEntity.getNode(parseInt(chartNode.id), nodeMap);\r\n        // check in partnerMap\r\n\r\n        if (partnerBubble && partnerBubble.includes(node._id)) {\r\n            if (isPartnerProcessed) {\r\n                continue;\r\n            }\r\n            isPartnerProcessed = true;\r\n            let partnerParent: number | undefined;\r\n            let isExistingBubble = false;\r\n            for (const partner of partnerBubble) {\r\n                const partnerNode = NodeEntity.getNode(partner, nodeMap);\r\n                const existingBubbles = bubbles.filter((bubble) => {\r\n                    if (bubble.parent) {\r\n                        return partnerNode._parents.includes(bubble.parent);\r\n                    }\r\n                    return false;\r\n                });\r\n                if (existingBubbles.length !== 0) {\r\n                    // return that there is an existing bubble which will include bubble\r\n                    existingBubbles[0].elements =\r\n                        existingBubbles[0].elements.concat(partnerBubble);\r\n                    isExistingBubble = true;\r\n                    break;\r\n                } else {\r\n                    if (partnerNode._parents.length !== 0)\r\n                        partnerParent = partnerNode._parents[0];\r\n                }\r\n            }\r\n            if (!isExistingBubble)\r\n                bubbles.push(new Bubble(partnerBubble, partnerParent));\r\n        } else {\r\n            const existingBubble = bubbles.filter((bubble) => {\r\n                if (bubble.parent) {\r\n                    return node._parents.includes(bubble.parent);\r\n                }\r\n                return false;\r\n            });\r\n            let bubble: Bubble;\r\n            if (existingBubble.length !== 0) {\r\n                bubble = existingBubble[0];\r\n                bubble.elements.push(node._id);\r\n            } else {\r\n                if (node._parents.length !== 0)\r\n                    bubble = new Bubble([node._id], node._parents[0]);\r\n                else bubble = new Bubble([node._id]);\r\n                bubbles.push(bubble);\r\n            }\r\n        }\r\n    }\r\n    return bubbles;\r\n};\r\nconst getChartNodeConnectorArray = (\r\n    nodeMap: Map<number, NodeEntity>,\r\n): Array<ChartNode | ChartConnector> => {\r\n    const finalArray = new Array<ChartNode | ChartConnector>();\r\n    // eslint-disable-next-line\r\n    chartNodeMap.forEach((value, key) => {\r\n        if (NodeEntity.getNode(parseInt(value.id), nodeMap)._path.length !== 0)\r\n            finalArray.push(value);\r\n    });\r\n    return finalArray.concat(connectorArray);\r\n};\r\n\r\nconst setxLevelForMaxLevel = (nodeArray: Array<ChartNode>) => {\r\n    const xlevelDefault = xLevelArray[nodeArray.length - 1];\r\n    for (let i = 0; i < nodeArray.length; i++) {\r\n        nodeArray[i].xLevel = xlevelDefault[i];\r\n    }\r\n};\r\nconst getChartNode = (id: string) => {\r\n    const chartNode: ChartNode | undefined = chartNodeMap.get(parseInt(id));\r\n    if (chartNode == undefined) {\r\n        throw new Error('Person not found with given id:' + id);\r\n    }\r\n    return chartNode;\r\n};\r\nfunction createNodesInPath(\r\n    currentNodePath: [number, number][],\r\n    processedNodes: string[],\r\n) {\r\n    for (let j = currentNodePath.length - 2; j >= 0; j--) {\r\n        if (\r\n            currentNodePath[j][0] === ParentChildSelector.testator &&\r\n            (currentNodePath[j + 1][0] === ParentChildSelector.spouse ||\r\n                currentNodePath[j + 1][0] === ParentChildSelector.cohabitant ||\r\n                currentNodePath[j + 1][0] ===\r\n                    ParentChildSelector.undividedSpouse)\r\n        ) {\r\n            break;\r\n        }\r\n        processedNodes.push(currentNodePath[j][1].toString());\r\n        let source = '',\r\n            target = '';\r\n        if (\r\n            currentNodePath[j + 1][0] <= currentNodePath[j][0] ||\r\n            (currentNodePath[j + 1][0] === ParentChildSelector.child &&\r\n                currentNodePath[j][0] === ParentChildSelector.testator)\r\n        ) {\r\n            source = currentNodePath[j][1].toString();\r\n            target = currentNodePath[j + 1][1].toString();\r\n        } else {\r\n            source = currentNodePath[j + 1][1].toString();\r\n            target = currentNodePath[j][1].toString();\r\n        }\r\n        const sourceNode = getChartNode(source);\r\n        if (!sourceNode.data.pos) {\r\n            sourceNode.data.pos = {};\r\n        }\r\n        sourceNode.data.pos.bottom = 'bottom';\r\n        const targetNode = getChartNode(target);\r\n        if (!targetNode.data.pos) {\r\n            targetNode.data.pos = {};\r\n        }\r\n        targetNode.data.pos.top = 'top';\r\n\r\n        if (\r\n            connectorArray.filter((connector) => {\r\n                return connector.id === `e${source}-${target}`;\r\n            }).length === 0\r\n        ) {\r\n            const newConnector = new ChartConnector(\r\n                `e${source}-${target}`,\r\n                'straight',\r\n                source,\r\n                target,\r\n                '',\r\n                's_bottom',\r\n                't_top',\r\n            );\r\n            connectorArray.push(newConnector);\r\n        }\r\n    }\r\n}\r\n","export default function chartSelector(state) {\r\n  return {\r\n    nodeMap: state.nodeMap,\r\n    personsMap: state.personsMap,\r\n    testator: state.testator,\r\n  };\r\n}\r\n\r\nexport function messageSelector(state) {\r\n  return {\r\n    messages: state.messages,\r\n  };\r\n}\r\n","class ChartNode {\r\n  id: string;\r\n  type: string;\r\n  data: NodeData;\r\n  position: { x: number; y: number };\r\n  xLevel: number;\r\n  draggable = false;\r\n  connectable = false;\r\n  constructor(\r\n    id: string,\r\n    type: string,\r\n    data: NodeData,\r\n    position: { x: number; y: number },\r\n    xLevel: number\r\n  ) {\r\n    this.id = id;\r\n    this.type = type;\r\n    this.data = data;\r\n    this.position = position;\r\n    this.xLevel = xLevel;\r\n  }\r\n}\r\nexport class NodeData {\r\n  label = \"\";\r\n  showDialog: boolean;\r\n  pos: {\r\n    left?: null | string;\r\n    right?: null | string;\r\n    top?: null | string;\r\n    bottom?: null | string;\r\n  };\r\n\r\n  constructor(label: string, data?: any) {\r\n    this.label = label;\r\n    this.pos = data;\r\n    this.showDialog = false;\r\n  }\r\n}\r\nexport default ChartNode;\r\n","class ChartConnector {\r\n  id: string;\r\n  type = \"smoothstep\";\r\n  source: string;\r\n  target: string;\r\n  label: string;\r\n  animated = false;\r\n  // arrowHeadType = \"arrowclosed\";\r\n  sourceHandle: string;\r\n  targetHandle: string;\r\n\r\n  constructor(\r\n    id: string,\r\n    type: string,\r\n    source: string,\r\n    target: string,\r\n    label: string,\r\n    sourceHandle = \"\",\r\n    targetHandle = \"\"\r\n  ) {\r\n    this.id = id;\r\n    this.type = type;\r\n    this.source = source;\r\n    this.target = target;\r\n    this.label = label;\r\n    this.sourceHandle = sourceHandle;\r\n    this.targetHandle = targetHandle;\r\n  }\r\n}\r\n\r\nexport default ChartConnector;\r\n","export class Bubble {\r\n  parent: number | undefined;\r\n  elements: Array<number>;\r\n  constructor(elements: Array<number>, parent?: number) {\r\n    this.elements = elements;\r\n    this.parent = parent;\r\n  }\r\n}\r\n","import { Handle, Position } from 'react-flow-renderer';\r\nimport { Textfit } from 'react-textfit';\r\n\r\nenum HandleType {\r\n    source = 'source',\r\n    target = 'target',\r\n}\r\n\r\nconst customHandleData = [\r\n    {\r\n        type: 'source',\r\n        position: Position.Right,\r\n        id: 's_right',\r\n        style: { top: '50%', background: '#555' },\r\n    },\r\n    {\r\n        type: 'source',\r\n        position: Position.Bottom,\r\n        id: 's_bottom',\r\n        style: { left: '50%', background: '#555' },\r\n    },\r\n    {\r\n        type: 'target',\r\n        position: Position.Left,\r\n        id: 't_left',\r\n        style: { top: '50%', background: '#555' },\r\n    },\r\n    {\r\n        type: 'target',\r\n        position: Position.Top,\r\n        id: 't_top',\r\n        style: { left: '50%', background: '#555' },\r\n    },\r\n];\r\n\r\nconst condition = false;\r\nconst inheritanceDisplay = condition ? 'block' : 'none';\r\n\r\nconst partnerNodeStyles = {\r\n    OuterDiv: {\r\n        background: '#fff',\r\n        color: '#000',\r\n        width: '7rem',\r\n        // height: \"1.8rem\",\r\n        borderRadius: '3px',\r\n        borderColor: 'midnightblue',\r\n        borderStyle: 'solid',\r\n        borderWidth: '1px',\r\n        letterSpacing: '0.5px',\r\n    },\r\n    innerDiv1: {\r\n        width: '6.8rem',\r\n        display: 'contents',\r\n        height: `${condition ? '100%' : '2 / 3'}%`,\r\n        padding: '5%',\r\n    },\r\n    innerDiv2: {\r\n        display: inheritanceDisplay,\r\n        borderTop: 'black solid 1px',\r\n        padding: '0 2px',\r\n        letterSpacing: 0,\r\n    },\r\n    textFitStyle: {\r\n        margin: 'auto',\r\n        textAlign: 'center',\r\n        fontSize: '90%',\r\n        paddingBottom: '0.2rem',\r\n    },\r\n    subtitle: {\r\n        fontSize: '0.5rem',\r\n        margin: 0,\r\n        whiteSpace: 'nowrap' as const,\r\n    },\r\n};\r\n\r\nconst CustomNode = (totalData: any) => {\r\n    const data = totalData.data;\r\n\r\n    const isConnectable = data.isConnectable;\r\n    // eslint-disable-next-line\r\n    const handles = customHandleData.map((v, k) => {\r\n        if (check(data.pos, v.position)) {\r\n            return (\r\n                <Handle\r\n                    key={v.id}\r\n                    type={\r\n                        v.type === 'source'\r\n                            ? HandleType.source\r\n                            : HandleType.target\r\n                    }\r\n                    position={v.position}\r\n                    id={v.id}\r\n                    style={v.style}\r\n                    isConnectable={isConnectable}\r\n                />\r\n            );\r\n        }\r\n    });\r\n    const labelString = deceasedFormatter(data.label);\r\n    return (\r\n        <div>\r\n            <div\r\n                id={`detail_${totalData.id}`}\r\n                style={partnerNodeStyles.OuterDiv}\r\n            >\r\n                <div style={partnerNodeStyles.innerDiv1}>\r\n                    <Textfit\r\n                        style={partnerNodeStyles.textFitStyle}\r\n                        max={20}\r\n                        mode=\"single\"\r\n                        forceSingleModeWidth={false}\r\n                    >\r\n                        {labelString}\r\n                    </Textfit>\r\n                </div>\r\n                <div style={partnerNodeStyles.innerDiv2}>\r\n                    <p style={partnerNodeStyles.subtitle}>Amount: NOK </p>\r\n                </div>\r\n                {/* <Typography align=\"center\" variant=\"subtitle2\" style={{ textTransform: \"uppercase\", fontFamily: \"Helvetica\", padding: \"0 5px\" }}></Typography> */}\r\n                {handles}\r\n            </div>\r\n            {/* <Popper style={{ position: \"absolute\", display: data.showDialog ? \"block\" : \"none\" }}\r\n        open={data.showDialog}\r\n        anchorEl={document.getElementById(`detail_${totalData.id}`)}\r\n      >{`Hi popover ${data.label}`}</Popper> */}\r\n        </div>\r\n    );\r\n};\r\nconst check = (data: any, pos: string): boolean => {\r\n    if (\r\n        data &&\r\n        (data.left === pos ||\r\n            data.right === pos ||\r\n            data.top === pos ||\r\n            data.bottom === pos)\r\n    )\r\n        return true;\r\n\r\n    return false;\r\n};\r\n\r\nconst deceasedFormatter = (personString: string) => {\r\n    // const tempArray = personString.split(\"\");\r\n\r\n    // if (tempArray.length === 2) {\r\n    //   const spanElement = document.createElement(\"span\");\r\n    //   spanElement.innerHTML = `tempArray[0] <p style=\"color: red\">tempArray[1]</p>`\r\n    //   return spanElement\r\n    // }\r\n    return personString;\r\n};\r\n\r\nexport default CustomNode;\r\n","import { Subject, Subscription } from 'rxjs';\r\n\r\nconst chatBotDataSubject = new Subject();\r\nconst chatbotMessageSubscriptionList = new Array<Subscription>()\r\nexport const componentCommunicatorService = {\r\n\r\n    sendChatbotMessage: (message: any) => chatBotDataSubject.next(message),\r\n\r\n\r\n    getChatbotMessage: () => chatBotDataSubject.asObservable(),\r\n\r\n    addSubscription: (subscription: Subscription) => chatbotMessageSubscriptionList.push(subscription),\r\n\r\n\r\n    clearAllSubscription: () => {\r\n        chatbotMessageSubscriptionList.forEach((subscription: Subscription) => {\r\n            subscription.unsubscribe();\r\n        })\r\n    },\r\n\r\n\r\n};","import ReactFlow, {\r\n    Background,\r\n    BackgroundVariant,\r\n    Controls,\r\n} from 'react-flow-renderer';\r\nimport { processData } from './ProcessDataForChart';\r\nimport { useEffect, useRef, useState } from 'react';\r\nimport { useZoomPanHelper, useUpdateNodeInternals } from 'react-flow-renderer';\r\nimport CustomNode from './CustomNode';\r\nimport ChartNode from './Classes/ChartNode';\r\nimport ChartConnector from './Classes/ChartConnector';\r\nimport { componentCommunicatorService } from '../../ChatbotComponent/services/ComponentCommunicatorService';\r\n\r\n// import { CustomDetailDialog } from \"./Classes/CustomDetailDialog\";\r\n\r\nconst flowStyles = { height: '80vh', width: '60%' };\r\nlet isHandleChange = true;\r\nconst OrgChartTree = () => {\r\n    // const result = useSelector(chartSelector);\r\n    const [result, setResult] = useState({\r\n        nodeMap: new Map(),\r\n        personMap: new Map(),\r\n        testator: null,\r\n    });\r\n    const [chartContent, setChartContent] = useState([]);\r\n    const componentWillUnmount = useRef(false);\r\n    const updateNodeInternals = useUpdateNodeInternals();\r\n\r\n    const getNodeData = () =>\r\n        chartContent.forEach((chartData: ChartNode | ChartConnector) => {\r\n            //\r\n            if (chartData instanceof ChartNode) {\r\n                updateNodeInternals(chartData.id);\r\n            }\r\n        });\r\n    useEffect(() => {\r\n        return () => {\r\n            componentWillUnmount.current = true;\r\n        };\r\n    }, []);\r\n    useEffect(() => {\r\n        componentCommunicatorService.clearAllSubscription();\r\n        const subscription = componentCommunicatorService\r\n            .getChatbotMessage()\r\n            .subscribe((data: any) => setResult(data));\r\n        componentCommunicatorService.addSubscription(subscription);\r\n        if (componentWillUnmount.current) {\r\n            componentCommunicatorService.clearAllSubscription();\r\n        }\r\n    }, [1]);\r\n    useEffect(() => {\r\n        setTimeout(() => {\r\n            getNodeData();\r\n        }, 500);\r\n    }, [chartContent]);\r\n    useEffect(() => {\r\n        setChartContent(processData(result));\r\n        isHandleChange = true;\r\n    }, [result]);\r\n    const { fitView } = useZoomPanHelper();\r\n    const nodeTypes = {\r\n        specialNode: CustomNode,\r\n    };\r\n\r\n    useEffect(() => {\r\n        if (isHandleChange) {\r\n            fitView();\r\n        }\r\n    });\r\n\r\n    return (\r\n        <div id=\"ChartContainer\" style={{ height: '100%', paddingTop: '3rem' }}>\r\n            <ReactFlow\r\n                elements={chartContent}\r\n                style={flowStyles}\r\n                nodeTypes={nodeTypes}\r\n                nodesConnectable={false}\r\n                paneMoveable={false}\r\n                selectNodesOnDrag={false}\r\n                elementsSelectable={false}\r\n                nodesDraggable={false}\r\n            >\r\n                <Background\r\n                    variant={BackgroundVariant.Lines}\r\n                    gap={1}\r\n                    size={2}\r\n                />\r\n                <Controls />\r\n            </ReactFlow>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default OrgChartTree;\r\n","export default __webpack_public_path__ + \"static/media/chat_button_logo.6fc97b77.svg\";","import { useEffect, useRef } from 'react';\r\nimport { Typography } from '@mui/material';\r\nimport { Chatbot } from 'react-chatbot-kit';\r\nimport Config from '../Components/InheritanceCalculatorComponents/ChatbotComponent/Config.js';\r\nimport MessageParser from '../Components/InheritanceCalculatorComponents/ChatbotComponent/MessageParser';\r\nimport ActionProvider from '../Components/InheritanceCalculatorComponents/ChatbotComponent/ActionProvider';\r\nimport OrgChartTree from '../Components/InheritanceCalculatorComponents/OtherComponent/FamilyChart/ChartComponent';\r\nimport '../Components/InheritanceCalculatorComponents/OtherComponent/ChatbotToggleButton/ChatbotToggleButton.scss';\r\nimport botIcon from '../assets/images/chat_button_logo.svg';\r\nimport { ReactFlowProvider } from 'react-flow-renderer';\r\nimport { messageService } from '../Components/InheritanceCalculatorComponents/ChatbotComponent/services/ChatbotCommunicator.tsx';\r\nimport { componentCommunicatorService } from '../Components/InheritanceCalculatorComponents/ChatbotComponent/services/ComponentCommunicatorService.tsx';\r\n\r\nconst InheritanceCalculatorPage = () => {\r\n    let prev = 'block';\r\n    useEffect(() => {\r\n        messageService.clearAllExternalSubscription();\r\n        const subscription = messageService\r\n            .getMessageOutChatbot()\r\n            .subscribe(({ detail }) => {\r\n                componentCommunicatorService.sendChatbotMessage(detail);\r\n            });\r\n        messageService.addExternalSubscription(subscription);\r\n        setWarningDiv();\r\n        addListenerToChatInputField();\r\n    }, [1]);\r\n    const toggleBot = () => {\r\n        const divChatBot = document.getElementsByClassName(\r\n            'react-chatbot-kit-chat-container',\r\n        )[0];\r\n        if (prev === 'block') {\r\n            divChatBot.style.display = 'none';\r\n            prev = 'none';\r\n        } else {\r\n            divChatBot.style.display = 'block';\r\n            prev = 'block';\r\n        }\r\n    };\r\n    return (\r\n        <div id=\"InheritanceCalculatorMain\" style={{ height: '100%' }}>\r\n            <Typography variant=\"h2\" align=\"center\">\r\n                Inheritance Calculator\r\n            </Typography>\r\n            <ReactFlowProvider>\r\n                <OrgChartTree />\r\n            </ReactFlowProvider>\r\n            {\r\n                <div className=\"chatbotContainer\">\r\n                    <Chatbot\r\n                        config={Config}\r\n                        actionProvider={ActionProvider}\r\n                        messageParser={MessageParser}\r\n                    />\r\n                </div>\r\n            }\r\n            <button className=\"ChatbotToggleButton\" onClick={toggleBot}>\r\n                <img src={botIcon} />\r\n            </button>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst setWarningDiv = () => {\r\n    const newDiv = document.createElement('div');\r\n    newDiv.id = 'chatbot-warning-div';\r\n    newDiv.innerHTML = 'warning';\r\n    newDiv.style.cssText =\r\n        'background-color: red; position: absolute; bottom: 2.5rem; width: 100%; display: none;';\r\n\r\n    document\r\n        .getElementsByClassName('react-chatbot-kit-chat-input-form')[0]\r\n        .prepend(newDiv);\r\n\r\n    const container = document.querySelector(\r\n        '.react-chatbot-kit-chat-message-container',\r\n    );\r\n    const lastChild = container.lastChild;\r\n    lastChild.style.paddingBottom = '2.5rem';\r\n};\r\n\r\nconst addListenerToChatInputField = () => {\r\n    const chatInputField = document.getElementsByClassName(\r\n        'react-chatbot-kit-chat-input',\r\n    )[0];\r\n    chatInputField.addEventListener('input', () => {\r\n        const warningDiv = document.getElementById('chatbot-warning-div');\r\n        if (warningDiv) {\r\n            if (warningDiv.style.display === 'block') {\r\n                warningDiv.style.display = 'none';\r\n            }\r\n        }\r\n    });\r\n};\r\nexport default InheritanceCalculatorPage;\r\n","import { ReactElement } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport makeStyles from \"@mui/styles/makeStyles\";\r\nimport Paper from \"@mui/material/Paper\";\r\nimport Typography from \"@mui/material/Typography\";\r\nimport Link from \"@mui/material/Link\";\r\nimport { useTheme } from \"@mui/material/styles\";\r\n// import LangButton from \"./LangButton/LangButton\";\r\n\r\ninterface propsTypes {\r\n  description: string;\r\n  title: string;\r\n}\r\n\r\nconst Copyright = (): ReactElement => {\r\n  return (\r\n    <Typography variant=\"body2\" color=\"textSecondary\" align=\"center\">\r\n      {\"Copyright  \"}\r\n      <Link color=\"inherit\" href=\"https://material-ui.com/\">\r\n        Arvebot\r\n      </Link>{\" \"}\r\n      {new Date().getFullYear()}\r\n      {\".\"}\r\n    </Typography>\r\n  );\r\n};\r\n\r\nconst useStyles = makeStyles(() => ({\r\n  footer: {\r\n    // backgroundColor: theme.palette.background.paper,\r\n    padding: useTheme().spacing(6),\r\n    backgroundColor: \"silver\",\r\n  },\r\n}));\r\n\r\nconst Footer = (props: propsTypes): ReactElement => {\r\n  const classes = useStyles();\r\n  const { description, title } = props;\r\n\r\n  return (\r\n    <Paper className={classes.footer}>\r\n      <Typography variant=\"h6\" align=\"center\" gutterBottom>\r\n        {title}\r\n      </Typography>\r\n      <Typography\r\n        variant=\"subtitle1\"\r\n        align=\"center\"\r\n        color=\"textSecondary\"\r\n        component=\"p\"\r\n      >\r\n        {description}\r\n      </Typography>\r\n      <Copyright />\r\n\r\n      {/* {Object.keys(props.langValue).map((lang) => (\r\n        <LangButton\r\n          key={lang}\r\n          langButtonValue={props.langValue[lang]}\r\n          sendDataToParent={props.sendDataToParent}\r\n        />\r\n      ))} */}\r\n    </Paper>\r\n  );\r\n};\r\n\r\nFooter.propTypes = {\r\n  description: PropTypes.string,\r\n  title: PropTypes.string,\r\n};\r\n\r\nexport default Footer;\r\n","import { ReactElement } from \"react\";\r\nimport { Typography } from \"@mui/material\";\r\n\r\nconst ResourcesPage = (): ReactElement => {\r\n  return (\r\n    <Typography variant=\"h2\" align=\"center\">\r\n      ResourcesPage\r\n    </Typography>\r\n  );\r\n};\r\n\r\nexport default ResourcesPage;\r\n","import { ChatbotState } from \"../Components/InheritanceCalculatorComponents/ChatbotComponent/Generics\";\r\n\r\nconst initialState = ChatbotState;\r\n\r\nconst genericReducer = (state = initialState, action) => {\r\n  switch (action.type) {\r\n    case \"UPDATE_GENERIC\":\r\n      return action.payload;\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default genericReducer;\r\n","import { createStore } from \"redux\";\r\nimport genericReducer from \"./genericReducer\";\r\n\r\nconst store = createStore(genericReducer);\r\nexport default store;\r\n","// React\r\nimport { ReactElement } from 'react';\r\n// material-ui\r\nimport { Paper } from '@mui/material';\r\nimport {\r\n    createTheme,\r\n    ThemeProvider,\r\n    StyledEngineProvider,\r\n} from '@mui/material/styles';\r\nimport makeStyles from '@mui/styles/makeStyles';\r\n// react-router\r\nimport { Route, Switch } from 'react-router-dom';\r\nimport { IntlProvider } from 'react-intl';\r\n// local - check in newer chrome version and remove. added polyfill because nb locale not supported in chromium>92\r\n// https://github.com/formatjs/formatjs/issues/3066\r\nimport '@formatjs/intl-datetimeformat/polyfill-force';\r\nimport '@formatjs/intl-datetimeformat/locale-data/nb';\r\nimport '@formatjs/intl-numberformat/polyfill-force';\r\nimport '@formatjs/intl-numberformat/locale-data/nb';\r\nimport '@formatjs/intl-numberformat/locale-data/en';\r\n//\r\n// import theme from \"./theme\";\r\nimport Header from './Components/Generic/Header/Header';\r\nimport HomePage from './Pages/HomePage';\r\nimport AboutPage from './Pages/AboutPage';\r\nimport InheritanceCalculatorPage from './Pages/InheritanceCalculatorPage.js';\r\nimport Footer from './Components/Generic/Footer/Footer';\r\n// import HomePageImage from \"./assets/images/homepage-image.jpg\";\r\nimport ResourcesPage from './Pages/ResourcesPage';\r\n\r\nimport Norsk from './languages/translationNO.json';\r\n// import English from \"./languages/translationEN.json\";\r\nimport store from './store/store';\r\nimport { Provider } from 'react-redux';\r\n\r\nconst theme = createTheme();\r\nconst useStyles = makeStyles({\r\n    root: {\r\n        // backgroundImage: `url(${HomePageImage})`,\r\n        // backgroundPosition: \"center\",\r\n        // backgroundSize: \"cover\",\r\n        // backgroundRepeat: \"no-repeat\",\r\n        height: '100vh',\r\n    },\r\n    rootPaper: {\r\n        marginTop: '5rem',\r\n        minHeight: '100vh',\r\n        background:\r\n            'radial-gradient( circle farthest-corner at 10% 20%,  #FCCABD 0%, #4151C9 45.5% )',\r\n        opacity: '1',\r\n    },\r\n});\r\n\r\nconst menuItems = (\r\n    <Switch>\r\n        <Route exact path=\"/\" component={HomePage} />\r\n        <Route path=\"/about\" component={AboutPage} />\r\n        <Route path=\"/calculator\" component={InheritanceCalculatorPage} />\r\n        <Route path=\"/resources\" component={ResourcesPage} />\r\n    </Switch>\r\n);\r\n\r\nconst App = (): ReactElement => {\r\n    const classes = useStyles();\r\n    const lang = 'nb-NO';\r\n    const langMessages = Norsk;\r\n    // const [lang, setLang] = useState(\"nb-NO\");\r\n    // const [langMessages, setLangMessages] = useState(Norsk);\r\n    // const sendDataToParent = (index) => {\r\n    //   setLang(index.code);\r\n    //   if (index.code === \"nb-NO\") {\r\n    //     setLangMessages(Norsk);\r\n    //   } else {\r\n    //     setLangMessages(English);\r\n    //   }\r\n    // };\r\n\r\n    // const LangValue = {\r\n    //   no: {\r\n    //     code: \"nb-NO\",\r\n    //     name: \"Norsk\",\r\n    //   },\r\n    //   en: {\r\n    //     code: \"en-US\",\r\n    //     name: \"English\",\r\n    //   },\r\n    // };\r\n    return (\r\n        <StyledEngineProvider injectFirst>\r\n            <ThemeProvider theme={theme}>\r\n                <IntlProvider locale={lang} messages={langMessages}>\r\n                    <Paper\r\n                        role=\"img\"\r\n                        // className={classes.root}\r\n                        aria-label=\"Image by Free-Photos from Pixabay\"\r\n                    >\r\n                        <Header />\r\n                        <Provider store={store}>\r\n                            <Paper className={classes.rootPaper}>\r\n                                {menuItems}\r\n                            </Paper>\r\n                        </Provider>\r\n                    </Paper>\r\n                    {/* <Footer langValue={LangValue} sendDataToParent={sendDataToParent} /> */}\r\n                    <Footer description=\"Arvebot\" title=\"Arvebot\" />\r\n\r\n                    {/* Route components are rendered if the path prop matches the current URL */}\r\n                </IntlProvider>\r\n            </ThemeProvider>\r\n        </StyledEngineProvider>\r\n    );\r\n};\r\n\r\nexport default App;\r\n\r\n// react-spring -> animations\r\n// nivo for visualisation\r\n// primary - 003049   , 264653 , 031d44\r\n// secondary - EAE2B7   ,e76f51 , d5896f\r\n","// import { StrictMode } from \"react\";\r\nimport { HashRouter as Router } from 'react-router-dom';\r\nimport './index.scss';\r\n// import * as Sentry from \"@sentry/react\";\r\n// import { BrowserTracing } from \"@sentry/tracing\";\r\nimport App from './App';\r\nimport { render } from 'react-dom';\r\n\r\n/***\r\n** Uncomment for sentry logging\r\nSentry.init({\r\n  dsn: \"https://4ee9eb855a3d475eba0981e5e96f4090@o1245495.ingest.sentry.io/6402725\",\r\n  integrations: [new BrowserTracing()],\r\n\r\n  tracesSampleRate: 1.0,\r\n});\r\n*/\r\nrender(\r\n    // <StrictMode>\r\n    <Router>\r\n        <App />\r\n    </Router>,\r\n    // </StrictMode>,\r\n    document.getElementById('app'),\r\n);\r\n"],"sourceRoot":""}